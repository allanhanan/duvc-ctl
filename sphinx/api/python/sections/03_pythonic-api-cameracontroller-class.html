<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../../../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>3. Pythonic API - CameraController Class - duvc-ctl v2.0.0 Documentation</title><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="4. Result-Based API - Explicit Error Handling" href="04_result-based-api-explicit-error-handling.html" /><link rel="prev" title="2. Architecture &amp; Design Overview" href="02_architecture-design-overview.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=43bd62f4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/shibuya.css?v=14737038" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../../../_static/print.css?v=20ff2c19" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="3. Pythonic API - CameraController Class"/>
    <meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../../../index.html">
      
      
      <strong>duvc-ctl</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials">
  <a href="https://github.com/allanhanan/duvc-ctl" aria-label="GitHub">
    <iconify-icon icon="simple-icons:github"></iconify-icon>
  </a></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user-guide/quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user-guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user-guide/migration.html">Migration</a></li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../c/index.html">duvc-ctl C API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/index.html">duvc-ctl C++ API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/01_overview-getting-started.html">1. Overview &amp; Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/02_core-api-public-headers.html">2. Core API - Public Headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/03_utility-functions-helpers.html">3. Utility Functions &amp; Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/04_platform-abstraction-layer.html">4. Platform Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/05_vendor-specific-extensions.html">5. Vendor-Specific Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/06_internal-implementation-details.html">6. Internal Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/07_property-reference-details.html">7. Property Reference &amp; Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/08_usage-patterns-best-practices.html">8. Usage Patterns &amp; Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/09_build-system-integration.html">9. Build System &amp; Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/10_platform-specific-information.html">10. Platform-Specific Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/11_device-support-compatibility.html">11. Device Support &amp; Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/12_troubleshooting-debugging.html">12. Troubleshooting &amp; Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/13_examples-tutorials.html">13. Examples &amp; Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/14_contributing-extending.html">14. Contributing &amp; Extending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/15_faq.html">15. FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/16_appendices.html">16. Appendices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">duvc-ctl CLI Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">duvc-ctl Python Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_quick-start-installation.html">1. Quick Start &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_architecture-design-overview.html">2. Architecture &amp; Design Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Pythonic API - CameraController Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_result-based-api-explicit-error-handling.html">4. Result-Based API - Explicit Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_comprehensive-type-reference.html">5. Comprehensive Type Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_enumeration-constant-reference.html">6. Enumeration &amp; Constant Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_exception-hierarchy-handling.html">7. Exception Hierarchy &amp; Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_convenience-functions-helpers.html">8. Convenience Functions &amp; Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_logging-diagnostics-callbacks.html">9. Logging, Diagnostics &amp; Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_vendor-specific-extensions.html">10. Vendor-Specific Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_building-contributing-pybind11-integration.html">11. Building, Contributing &amp; pybind11 Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_complete-property-reference-details.html">12. Complete Property Reference &amp; Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_common-patterns-recipes.html">13. Common Patterns &amp; Recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_troubleshooting-faqs.html">14. Troubleshooting &amp; FAQs</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_advanced-architecture-special-methods.html">15. Advanced Architecture &amp; Special Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_architecture-decision-records.html">16. Architecture Decision Records</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_tutorials-getting-started.html">17. Tutorials &amp; Getting Started</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/cpp-examples.html">C++ Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/python-examples.html">Python Examples</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3></div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../../index.html"><span itemprop="name">duvc-ctl</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">duvc-ctl Python Documentation</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">3. Pythonic API - CameraController Class</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <section id="pythonic-api-cameracontroller-class">
<h1>3. Pythonic API - CameraController Class<a class="headerlink" href="#pythonic-api-cameracontroller-class" title="Link to this heading">¶</a></h1>
<section id="initialization-device-connection">
<h2>3.1 Initialization &amp; Device Connection<a class="headerlink" href="#initialization-device-connection" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">CameraController</span></code> constructor automatically discovers and connects to a camera device. Three initialization modes are supported: automatic (first device), selection by index, or selection by name pattern.</p>
<section id="constructor-signatures-and-modes">
<h3>Constructor signatures and modes<a class="headerlink" href="#constructor-signatures-and-modes" title="Link to this heading">¶</a></h3>
<p><strong>Auto-detect first camera:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span>
</span></pre></div>
</div>
<p><strong>Select by index:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Second camera</span>
</span></pre></div>
</div>
<p><strong>Select by name (substring match, case-insensitive):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;Logitech&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Constructor exceptions (all raised immediately):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DeviceNotFoundError</span></code>: No cameras found or specified device not found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SystemError</span></code>: Connection failed (device in use, permissions, hardware issue)</p></li>
</ul>
</section>
<section id="device-selection-strategy">
<h3>Device selection strategy<a class="headerlink" href="#device-selection-strategy" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">_connect()</span></code> method implements priority-based device selection:</p>
<ol class="arabic simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">device_index</span></code> provided: Use device at that index (0-based). Raises <code class="docutils literal notranslate"><span class="pre">DeviceNotFoundError</span></code> with enumerated list if out of range.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">device_name</span></code> provided: Search for substring match (case-insensitive). Returns first match.</p></li>
<li><p>Default: Use first device in list (index 0).</p></li>
</ol>
<p>Only one parameter should be specified; if both are provided, <code class="docutils literal notranslate"><span class="pre">device_index</span></code> takes precedence.</p>
</section>
<section id="name-matching-algorithm">
<h3>Name matching algorithm<a class="headerlink" href="#name-matching-algorithm" title="Link to this heading">¶</a></h3>
<p>Device name matching uses <strong>case-insensitive substring search</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Matches: &quot;Logitech C920&quot;, &quot;LOGITECH Webcam&quot;, &quot;logitech hd pro&quot;</span>
</span><span data-line="2"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;Logitech&quot;</span><span class="p">)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Matches: &quot;USB 2.0 Camera&quot;, &quot;USB 3.0 HD Webcam&quot;, &quot;USB Video Device&quot;</span>
</span><span data-line="5"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;USB&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>When multiple devices match, the <strong>first match is selected</strong>. Use <code class="docutils literal notranslate"><span class="pre">device_index</span></code> if you need specific control over multiple matching devices.</p>
</section>
<section id="error-messages-with-device-enumeration">
<h3>Error messages with device enumeration<a class="headerlink" href="#error-messages-with-device-enumeration" title="Link to this heading">¶</a></h3>
<p><strong>No cameras detected:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span>
</span><span data-line="3"><span class="k">except</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">DeviceNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="5">    <span class="c1"># Output:</span>
</span><span data-line="6">    <span class="c1"># No cameras detected. Please check:</span>
</span><span data-line="7">    <span class="c1"># • Camera is connected and powered on</span>
</span><span data-line="8">    <span class="c1"># • Camera drivers are installed</span>
</span></pre></div>
</div>
<p><strong>Device index out of range (with full enumeration):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_index</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span data-line="3"><span class="k">except</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">DeviceNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="5">    <span class="c1"># Output:</span>
</span><span data-line="6">    <span class="c1"># Device index 5 not found.</span>
</span><span data-line="7">    <span class="c1"># Available cameras:</span>
</span><span data-line="8">    <span class="c1"># 0: Logitech C920</span>
</span><span data-line="9">    <span class="c1"># 1: USB 2.0 Camera</span>
</span><span data-line="10">    <span class="c1"># 2: Integrated Webcam</span>
</span></pre></div>
</div>
<p><strong>Device name not found (with available names listed):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;Sony&quot;</span><span class="p">)</span>
</span><span data-line="3"><span class="k">except</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">DeviceNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="5">    <span class="c1"># Output:</span>
</span><span data-line="6">    <span class="c1"># No camera matching &#39;Sony&#39; found.</span>
</span><span data-line="7">    <span class="c1"># Available: Logitech C920, USB 2.0 Camera, Integrated Webcam</span>
</span></pre></div>
</div>
<p><strong>Connection failed (with diagnostics):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="3"><span class="k">except</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">SystemError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="5">    <span class="c1"># Output:</span>
</span><span data-line="6">    <span class="c1"># Failed to connect to &#39;Logitech C920&#39;: Access denied</span>
</span><span data-line="7">    <span class="c1"># This might be because:</span>
</span><span data-line="8">    <span class="c1"># • Camera is in use by another application</span>
</span><span data-line="9">    <span class="c1"># • Insufficient permissions</span>
</span><span data-line="10">    <span class="c1"># • Hardware issue</span>
</span></pre></div>
</div>
</section>
<section id="internal-connect-implementation">
<h3>Internal <code class="docutils literal notranslate"><span class="pre">_connect()</span></code> implementation<a class="headerlink" href="#internal-connect-implementation" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">_connect()</span></code> method orchestrates device discovery and connection:</p>
<ol class="arabic simple">
<li><p>Calls <code class="docutils literal notranslate"><span class="pre">list_devices()</span></code> to enumerate all connected cameras (uses core C++ API).</p></li>
<li><p>Applies device selection logic (index, name match, or first device).</p></li>
<li><p>Calls <code class="docutils literal notranslate"><span class="pre">open_camera(device)</span></code> using the Result-based API.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">open_camera()</span></code> returns error, wraps it with helpful context.</p></li>
<li><p>Stores connection handle (<code class="docutils literal notranslate"><span class="pre">_core_camera</span></code>) and device metadata (<code class="docutils literal notranslate"><span class="pre">_device</span></code>).</p></li>
<li><p>Initializes internal state variables.</p></li>
</ol>
<p>All parameter validation and error messaging are implemented in Python; the C++ layer provides only core enumeration and connection operations.</p>
</section>
<section id="internal-state-initialization">
<h3>Internal state initialization<a class="headerlink" href="#internal-state-initialization" title="Link to this heading">¶</a></h3>
<p>After successful <code class="docutils literal notranslate"><span class="pre">_connect()</span></code>, the constructor initializes:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_lock</span></code></strong>: <code class="docutils literal notranslate"><span class="pre">threading.Lock()</span></code> for thread-safe access to shared state.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_core_camera</span></code></strong>: Reference to underlying C++ <code class="docutils literal notranslate"><span class="pre">Camera</span></code> object (Result API).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_device</span></code></strong>: Reference to <code class="docutils literal notranslate"><span class="pre">Device</span></code> object that was connected.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_is_closed</span></code></strong>: Boolean flag initialized to <code class="docutils literal notranslate"><span class="pre">False</span></code> (tracks close state).</p></li>
</ul>
<p>These variables are used by all subsequent operations (property access, validation, cleanup). The lock protects against concurrent access from multiple threads.</p>
</section>
<section id="device-metadata-access-after-connection">
<h3>Device metadata access after connection<a class="headerlink" href="#device-metadata-access-after-connection" title="Link to this heading">¶</a></h3>
<p>Once construction succeeds, device information is immediately available:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc_ctl</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span>
</span><span data-line="2">
</span><span data-line="3"><span class="nb">print</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">device_name</span><span class="p">)</span>   <span class="c1"># e.g., &quot;Logitech C920&quot;</span>
</span><span data-line="4"><span class="nb">print</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">device_path</span><span class="p">)</span>   <span class="c1"># e.g., &quot;\\\\?\\USB#VID_046D&amp;PID_082D...&quot;</span>
</span><span data-line="5"><span class="nb">print</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">is_connected</span><span class="p">)</span>  <span class="c1"># Always True after successful construction</span>
</span></pre></div>
</div>
<p>These are read-only properties; <code class="docutils literal notranslate"><span class="pre">device_path</span></code> is a stable identifier suitable for reconnection attempts.</p>
</section>
<section id="connection-validation">
<h3>Connection validation<a class="headerlink" href="#connection-validation" title="Link to this heading">¶</a></h3>
<p>The constructor validates the connection by:</p>
<ol class="arabic simple">
<li><p>Checking <code class="docutils literal notranslate"><span class="pre">is_device_connected(device)</span></code> returns True.</p></li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">open_camera()</span></code> and verifying success.</p></li>
<li><p>Storing the Camera object for future operations.</p></li>
</ol>
<p>If any step fails, a <code class="docutils literal notranslate"><span class="pre">DeviceNotFoundError</span></code> or <code class="docutils literal notranslate"><span class="pre">SystemError</span></code> is raised with diagnostic context. <strong>Once construction completes successfully, the camera is guaranteed to be connected and ready.</strong> No additional checks are needed before property operations.</p>
</section>
</section>
<section id="context-manager-lifecycle">
<h2>3.2 Context Manager &amp; Lifecycle<a class="headerlink" href="#context-manager-lifecycle" title="Link to this heading">¶</a></h2>
<p>The CameraController implements Python’s context manager protocol for automatic resource cleanup. This ensures the camera connection is always properly released, even if exceptions occur.</p>
<section id="using-the-with-statement">
<h3>Using the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement<a class="headerlink" href="#using-the-with-statement" title="Link to this heading">¶</a></h3>
<p>The recommended pattern for CameraController usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="4">    <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">80</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">brightness</span><span class="p">)</span>
</span><span data-line="6"><span class="c1"># Camera automatically closed here</span>
</span></pre></div>
</div>
<p>The context manager guarantees cleanup even if exceptions occur:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">999</span>  <span class="c1"># Raises InvalidValueError</span>
</span><span data-line="3">    <span class="c1"># __exit__ still called; camera cleaned up before exception propagates</span>
</span></pre></div>
</div>
</section>
<section id="enter-and-exit-protocol">
<h3><code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> and <code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> protocol<a class="headerlink" href="#enter-and-exit-protocol" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> returns <code class="docutils literal notranslate"><span class="pre">self</span></code> (the CameraController instance) when entering the <code class="docutils literal notranslate"><span class="pre">with</span></code> block. <code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> calls <code class="docutils literal notranslate"><span class="pre">close()</span></code> and always returns <code class="docutils literal notranslate"><span class="pre">False</span></code>, allowing exceptions to propagate normally.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">class</span><span class="w"> </span><span class="nc">CameraController</span><span class="p">:</span>
</span><span data-line="2">    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;CameraController&#39;</span><span class="p">:</span>
</span><span data-line="3">        <span class="k">return</span> <span class="bp">self</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="6">        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="7">        <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Exceptions propagate</span>
</span></pre></div>
</div>
</section>
<section id="manual-open-and-close-operations">
<h3>Manual <code class="docutils literal notranslate"><span class="pre">open()</span></code> and <code class="docutils literal notranslate"><span class="pre">close()</span></code> operations<a class="headerlink" href="#manual-open-and-close-operations" title="Link to this heading">¶</a></h3>
<p>For cases where <code class="docutils literal notranslate"><span class="pre">with</span></code> is unsuitable, use manual lifecycle management:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">try</span><span class="p">:</span>
</span><span data-line="4">    <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">80</span>
</span><span data-line="5"><span class="k">finally</span><span class="p">:</span>
</span><span data-line="6">    <span class="n">cam</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Always called, even on exception</span>
</span></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">close()</span></code> method is idempotent—calling it multiple times is safe. It sets <code class="docutils literal notranslate"><span class="pre">_is_closed</span> <span class="pre">=</span> <span class="pre">True</span></code> and clears the <code class="docutils literal notranslate"><span class="pre">_core_camera</span></code> reference.</p>
</section>
<section id="connection-validation-methods">
<h3>Connection validation methods<a class="headerlink" href="#connection-validation-methods" title="Link to this heading">¶</a></h3>
<p><strong><code class="docutils literal notranslate"><span class="pre">is_connected</span></code> property:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">if</span> <span class="n">cam</span><span class="o">.</span><span class="n">is_connected</span><span class="p">:</span>
</span><span data-line="2">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera is responsive&quot;</span><span class="p">)</span>
</span><span data-line="3"><span class="k">else</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera disconnected or lost&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Performs multiple checks:</p>
<ul class="simple">
<li><p>Verifies <code class="docutils literal notranslate"><span class="pre">_is_closed</span></code> is False and <code class="docutils literal notranslate"><span class="pre">_core_camera</span></code> is not None.</p></li>
<li><p>Tests camera responsiveness with a simple property read.</p></li>
<li><p>Returns True only if camera actively responds.</p></li>
</ul>
<p><strong><code class="docutils literal notranslate"><span class="pre">test_connection_health()</span></code> method:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">health_ok</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">test_connection_health</span><span class="p">()</span>
</span></pre></div>
</div>
<p>More thorough than <code class="docutils literal notranslate"><span class="pre">is_connected</span></code>. Tests multiple operations to confirm the camera is fully functional. Useful before performing critical operations.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">get_connection_info()</span></code> method:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">info</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_connection_info</span><span class="p">()</span>
</span><span data-line="2"><span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;health_status&#39;</span><span class="p">])</span>
</span></pre></div>
</div>
<p>Returns a detailed dict with device name, path, connection status, health status, and last error (if any).</p>
</section>
<section id="reconnection-handling-via-reconnect">
<h3>Reconnection handling via <code class="docutils literal notranslate"><span class="pre">reconnect()</span></code><a class="headerlink" href="#reconnection-handling-via-reconnect" title="Link to this heading">¶</a></h3>
<p>If a camera disconnects unexpectedly, attempt reconnection:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">if</span> <span class="ow">not</span> <span class="n">cam</span><span class="o">.</span><span class="n">is_connected</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">success</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">reconnect</span><span class="p">()</span>
</span><span data-line="3">    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
</span><span data-line="4">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reconnected successfully&quot;</span><span class="p">)</span>
</span><span data-line="5">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="6">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reconnection failed&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">reconnect()</span></code> method:</p>
<ol class="arabic simple">
<li><p>Stores the device reference in <code class="docutils literal notranslate"><span class="pre">_device</span></code> during initial <code class="docutils literal notranslate"><span class="pre">_connect()</span></code>.</p></li>
<li><p>Closes the current connection.</p></li>
<li><p>Calls <code class="docutils literal notranslate"><span class="pre">_connect()</span></code> using the stored device name.</p></li>
<li><p>Returns True if reconnection succeeds, False otherwise.</p></li>
</ol>
</section>
<section id="close-with-validation-for-verified-cleanup">
<h3><code class="docutils literal notranslate"><span class="pre">close_with_validation()</span></code> for verified cleanup<a class="headerlink" href="#close-with-validation-for-verified-cleanup" title="Link to this heading">¶</a></h3>
<p>For applications requiring detailed cleanup verification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cleanup_report</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">close_with_validation</span><span class="p">()</span>
</span><span data-line="2"><span class="nb">print</span><span class="p">(</span><span class="n">cleanup_report</span><span class="p">[</span><span class="s1">&#39;cleanup_successful&#39;</span><span class="p">])</span>
</span><span data-line="3"><span class="nb">print</span><span class="p">(</span><span class="n">cleanup_report</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">])</span>
</span></pre></div>
</div>
<p>Returns a dict with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">was_connected</span></code>: Boolean indicating if camera was connected before closing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cleanup_successful</span></code>: Whether cleanup completed without exceptions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pre_close_health</span></code>: Health status before closing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">post_close_connected</span></code>: Verify camera is actually closed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">errors</span></code>: List of any errors encountered during cleanup.</p></li>
</ul>
</section>
<section id="state-flags-and-cleanup">
<h3>State flags and cleanup<a class="headerlink" href="#state-flags-and-cleanup" title="Link to this heading">¶</a></h3>
<p>Internal state management during lifecycle:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_is_closed</span></code></strong>: Boolean flag set to True when <code class="docutils literal notranslate"><span class="pre">close()</span></code> is called. Checked by <code class="docutils literal notranslate"><span class="pre">_ensure_connected()</span></code> before every operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_core_camera</span></code></strong>: Reference to the underlying C++ Camera object. Set to None during close; prevents access to disconnected cameras.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">_lock</span></code></strong>: Threading lock acquired during close to prevent concurrent access during cleanup.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="internal-state-management-thread-safety">
<h2>3.3 Internal State Management &amp; Thread Safety<a class="headerlink" href="#internal-state-management-thread-safety" title="Link to this heading">¶</a></h2>
<p>The CameraController uses careful state management to support concurrent access from multiple threads while protecting the camera connection.</p>
<section id="internal-state-variables">
<h3>Internal state variables<a class="headerlink" href="#internal-state-variables" title="Link to this heading">¶</a></h3>
<p><strong><code class="docutils literal notranslate"><span class="pre">_lock</span></code> (threading.Lock):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span data-line="2"><span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span></pre></div>
</div>
<p>Protects access to connection state. Acquired during:</p>
<ul class="simple">
<li><p>Connection establishment (<code class="docutils literal notranslate"><span class="pre">_connect()</span></code>)</p></li>
<li><p>State checks (<code class="docutils literal notranslate"><span class="pre">_ensure_connected()</span></code>)</p></li>
<li><p>Cleanup (<code class="docutils literal notranslate"><span class="pre">close()</span></code>)</p></li>
</ul>
<p>Acquisition is brief to minimize contention; property operations do not hold the lock for long.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">_core_camera</span></code> (Optional[CoreCamera]):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">CoreCamera</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>
</div>
<p>Reference to the underlying C++ Camera object (from the Result-based API). Initially None; set by <code class="docutils literal notranslate"><span class="pre">_connect()</span></code>. Set back to None by <code class="docutils literal notranslate"><span class="pre">close()</span></code>. Used by all property access methods (<code class="docutils literal notranslate"><span class="pre">_get_video_property()</span></code>, <code class="docutils literal notranslate"><span class="pre">_set_camera_property()</span></code>, etc.).</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">_device</span></code> (Optional[Device]):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>
</div>
<p>Reference to the connected Device. Stored during <code class="docutils literal notranslate"><span class="pre">_connect()</span></code> for use in <code class="docutils literal notranslate"><span class="pre">reconnect()</span></code>. Allows reconnection to the same device by name without requiring user to pass the Device object again.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">_is_closed</span></code> (bool):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="bp">self</span><span class="o">.</span><span class="n">_is_closed</span> <span class="o">=</span> <span class="kc">False</span>
</span></pre></div>
</div>
<p>Flag tracking whether <code class="docutils literal notranslate"><span class="pre">close()</span></code> has been called. Set to True in <code class="docutils literal notranslate"><span class="pre">close()</span></code>. Checked by <code class="docutils literal notranslate"><span class="pre">_ensure_connected()</span></code> before every operation. Prevents operations on closed cameras.</p>
</section>
<section id="ensure-connected-validation-method">
<h3><code class="docutils literal notranslate"><span class="pre">_ensure_connected()</span></code> validation method<a class="headerlink" href="#ensure-connected-validation-method" title="Link to this heading">¶</a></h3>
<p>Called at the start of every property operation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_ensure_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2">    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
</span><span data-line="3">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closed</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="4">            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Camera has been closed&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Raises <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> if the camera has been closed or the connection was lost. This prevents silent failures; any operation on a closed camera immediately fails with a clear error.</p>
</section>
<section id="thread-safe-property-access-patterns">
<h3>Thread-safe property access patterns<a class="headerlink" href="#thread-safe-property-access-patterns" title="Link to this heading">¶</a></h3>
<p><strong>Single camera, multiple threads (NOT recommended without synchronization):</strong></p>
<p>Accessing the same CameraController from multiple threads without a lock is unsafe:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># UNSAFE: Multiple threads accessing same camera</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="5">    <span class="k">def</span><span class="w"> </span><span class="nf">worker</span><span class="p">():</span>
</span><span data-line="6">        <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Race condition!</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span><span data-line="9">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="10">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
<p><strong>Multiple cameras, one per thread (SAFE):</strong></p>
<p>Each thread gets its own camera—no synchronization needed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># SAFE: Each thread has its own camera</span>
</span><span data-line="2"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">def</span><span class="w"> </span><span class="nf">worker</span><span class="p">(</span><span class="n">device_index</span><span class="p">):</span>
</span><span data-line="5">    <span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_index</span><span class="p">)</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="6">        <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># No race condition</span>
</span><span data-line="7">
</span><span data-line="8"><span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">devices</span><span class="p">))]</span>
</span><span data-line="9"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="10"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
<p><strong>Single camera with explicit locking (SAFE):</strong></p>
<p>If multiple threads must share one camera, use an external lock:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># SAFE: Shared camera with external lock</span>
</span><span data-line="2"><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="5">    <span class="k">def</span><span class="w"> </span><span class="nf">worker</span><span class="p">():</span>
</span><span data-line="6">        <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
</span><span data-line="7">            <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Protected by lock</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span><span data-line="10">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="11">    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</section>
<section id="multi-threaded-camera-control-patterns">
<h3>Multi-threaded camera control patterns<a class="headerlink" href="#multi-threaded-camera-control-patterns" title="Link to this heading">¶</a></h3>
<p><strong>Pattern 1: Thread pool with device queues:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">queue</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span data-line="3">
</span><span data-line="4"><span class="n">device_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Populate queue with devices</span>
</span><span data-line="7"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cam</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()):</span>
</span><span data-line="8">    <span class="n">device_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span data-line="9">
</span><span data-line="10"><span class="k">def</span><span class="w"> </span><span class="nf">worker</span><span class="p">():</span>
</span><span data-line="11">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span data-line="12">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="13">            <span class="n">device_idx</span> <span class="o">=</span> <span class="n">device_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
</span><span data-line="14">        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
</span><span data-line="15">            <span class="k">break</span>
</span><span data-line="16">        
</span><span data-line="17">        <span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">(</span><span class="n">device_idx</span><span class="p">)</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="18">            <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">75</span>
</span><span data-line="19">
</span><span data-line="20"><span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span><span data-line="21"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="22"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
<p><strong>Pattern 2: Shared resource with RLock (reentrant lock):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">class</span><span class="w"> </span><span class="nc">SharedCamera</span><span class="p">:</span>
</span><span data-line="4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="5">        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
</span><span data-line="6">        <span class="bp">self</span><span class="o">.</span><span class="n">cam</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CameraController</span><span class="p">()</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="k">def</span><span class="w"> </span><span class="nf">set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span data-line="9">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
</span><span data-line="10">            <span class="bp">self</span><span class="o">.</span><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="k">def</span><span class="w"> </span><span class="nf">get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">):</span>
</span><span data-line="13">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
</span><span data-line="14">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="15">
</span><span data-line="16"><span class="n">shared</span> <span class="o">=</span> <span class="n">SharedCamera</span><span class="p">()</span>
</span><span data-line="17">
</span><span data-line="18"><span class="k">def</span><span class="w"> </span><span class="nf">worker</span><span class="p">():</span>
</span><span data-line="19">    <span class="n">shared</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">worker</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span><span data-line="22"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="23"><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</section>
<section id="gil-management-considerations">
<h3>GIL management considerations<a class="headerlink" href="#gil-management-considerations" title="Link to this heading">¶</a></h3>
<p>Python’s Global Interpreter Lock (GIL) affects multi-threaded code:</p>
<ul class="simple">
<li><p><strong>C++ operations release the GIL</strong>: Property get/set operations call pybind11-bound C++ code. The pybind11 bindings release the GIL while executing C++ code, allowing true concurrency for CPU-bound work (but camera I/O is I/O-bound, so GIL release helps with responsiveness).</p></li>
<li><p><strong>Python-side locking holds the GIL</strong>: The <code class="docutils literal notranslate"><span class="pre">_lock</span></code> in CameraController holds the Python-level GIL, which briefly blocks other Python threads. This is unavoidable but minimized because the lock is held only during state checks, not during property operations.</p></li>
</ul>
<p>For truly high-concurrency scenarios, consider using one CameraController per thread and the thread pool pattern (Pattern 1 above).</p>
</section>
<section id="thread-safety-guarantees-documentation">
<h3>Thread safety guarantees documentation<a class="headerlink" href="#thread-safety-guarantees-documentation" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Operation</p></th>
<th class="head text-left"><p>Thread-Safe</p></th>
<th class="head text-left"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">list_devices()</span></code> (module-level)</p></td>
<td class="text-left"><p>✓ Yes</p></td>
<td class="text-left"><p>Internally synchronized; multiple threads can call simultaneously</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">open_camera()</span></code> (module-level)</p></td>
<td class="text-left"><p>✓ Yes</p></td>
<td class="text-left"><p>Each call opens independent camera; no shared state</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CameraController()</span></code> constructor</p></td>
<td class="text-left"><p>✓ Yes</p></td>
<td class="text-left"><p>Safe to construct from multiple threads; each gets independent object</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.brightness</span></code> (read/write single property)</p></td>
<td class="text-left"><p>✗ No</p></td>
<td class="text-left"><p>Multiple threads accessing same camera can race</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_multiple()</span></code> (multiple properties)</p></td>
<td class="text-left"><p>✗ No</p></td>
<td class="text-left"><p>Not atomic; individual properties racy if other threads access</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.set_multiple()</span></code> (multiple properties)</p></td>
<td class="text-left"><p>✗ No</p></td>
<td class="text-left"><p>Not atomic; individual properties racy if other threads access</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.close()</span></code></p></td>
<td class="text-left"><p>✓ Yes</p></td>
<td class="text-left"><p>Idempotent; safe to call from multiple threads</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.is_connected</span></code> (check status)</p></td>
<td class="text-left"><p>✓ Yes</p></td>
<td class="text-left"><p>Check is atomic; but state can change immediately after check</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.reconnect()</span></code></p></td>
<td class="text-left"><p>✓ Yes</p></td>
<td class="text-left"><p>Internally synchronized; safe concurrent calls (though redundant)</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Summary</strong>: The CameraController is thread-safe at the module level. Per-camera operations are thread-safe only if each thread accesses its own camera instance. For shared access, users must provide external synchronization (locks).</p>
</section>
</section>
<section id="class-constants-built-in-configurations">
<h2>3.4 Class Constants &amp; Built-In Configurations<a class="headerlink" href="#class-constants-built-in-configurations" title="Link to this heading">¶</a></h2>
<p>The CameraController defines class-level constants for property ranges, preset configurations, and intelligent defaults. These constants provide documented boundaries for property values and offer ready-made configurations for common use cases.</p>
<section id="brightness-constant-group">
<h3>Brightness constant group<a class="headerlink" href="#brightness-constant-group" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">BRIGHTNESS_MIN</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="2"><span class="n">BRIGHTNESS_MAX</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="3"><span class="n">BRIGHTNESS_DEFAULT</span> <span class="o">=</span> <span class="mi">50</span>
</span></pre></div>
</div>
<p>Brightness controls image luminance. Min represents darkest, max represents brightest. Default (50) is neutral mid-point. Device-reported ranges may differ; use <code class="docutils literal notranslate"><span class="pre">get_property_range('brightness')</span></code> to query actual limits for the connected camera.</p>
</section>
<section id="contrast-constant-group">
<h3>Contrast constant group<a class="headerlink" href="#contrast-constant-group" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">CONTRAST_MIN</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="2"><span class="n">CONTRAST_MAX</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="3"><span class="n">CONTRAST_DEFAULT</span> <span class="o">=</span> <span class="mi">50</span>
</span></pre></div>
</div>
<p>Contrast defines the tonal range of the image. Min produces flat, low-contrast output; max produces high-contrast output. Default (50) is neutral.</p>
</section>
<section id="saturation-constant-group">
<h3>Saturation constant group<a class="headerlink" href="#saturation-constant-group" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">SATURATION_MIN</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="2"><span class="n">SATURATION_MAX</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="3"><span class="n">SATURATION_DEFAULT</span> <span class="o">=</span> <span class="mi">50</span>
</span></pre></div>
</div>
<p>Saturation controls color intensity. Min produces grayscale (0% saturation); max produces vivid color. Default (50) is neutral baseline saturation.</p>
</section>
<section id="hue-constant-group">
<h3>Hue constant group<a class="headerlink" href="#hue-constant-group" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">HUE_MIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span>
</span><span data-line="2"><span class="n">HUE_MAX</span> <span class="o">=</span> <span class="mi">180</span>
</span><span data-line="3"><span class="n">HUE_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>
</div>
<p>Hue shifts colors around the color wheel. Range is ±180 degrees. Negative values rotate towards magenta/red; positive values rotate towards cyan/green. Default (0) is no color shift.</p>
</section>
<section id="pan-tilt-zoom-ptz-constant-group">
<h3>Pan/Tilt/Zoom (PTZ) constant group<a class="headerlink" href="#pan-tilt-zoom-ptz-constant-group" title="Link to this heading">¶</a></h3>
<p>Pan, tilt, and zoom are physical camera movement controls. These constants define center and range references.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Pan (horizontal rotation)</span>
</span><span data-line="2"><span class="n">PAN_MIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span>       <span class="c1"># Full left</span>
</span><span data-line="3"><span class="n">PAN_MAX</span> <span class="o">=</span> <span class="mi">180</span>        <span class="c1"># Full right</span>
</span><span data-line="4"><span class="n">PAN_CENTER</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># Straight ahead</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Tilt (vertical rotation)</span>
</span><span data-line="7"><span class="n">TILT_MIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>       <span class="c1"># Look down</span>
</span><span data-line="8"><span class="n">TILT_MAX</span> <span class="o">=</span> <span class="mi">90</span>        <span class="c1"># Look up</span>
</span><span data-line="9"><span class="n">TILT_CENTER</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c1"># Straight ahead</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Zoom (optical magnification)</span>
</span><span data-line="12"><span class="n">ZOOM_MIN</span> <span class="o">=</span> <span class="mi">100</span>       <span class="c1"># 1x (no zoom)</span>
</span><span data-line="13"><span class="n">ZOOM_MAX</span> <span class="o">=</span> <span class="mi">1000</span>      <span class="c1"># 10x typical</span>
</span><span data-line="14"><span class="n">ZOOM_DEFAULT</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># 1x (no zoom)</span>
</span></pre></div>
</div>
<p>These define nominal ranges. Devices report actual supported ranges dynamically; query with <code class="docutils literal notranslate"><span class="pre">get_property_range('pan')</span></code>, etc.</p>
</section>
<section id="built-in-presets-configuration-set">
<h3><code class="docutils literal notranslate"><span class="pre">BUILT_IN_PRESETS</span></code> configuration set<a class="headerlink" href="#built-in-presets-configuration-set" title="Link to this heading">¶</a></h3>
<p>Four ready-made preset configurations optimized for common shooting scenarios. Apply with <code class="docutils literal notranslate"><span class="pre">cam.apply_preset(preset_name)</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">BUILT_IN_PRESETS</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="s1">&#39;daylight&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="3">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="4">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
</span><span data-line="5">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="6">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
</span><span data-line="7">    <span class="p">},</span>
</span><span data-line="8">    <span class="s1">&#39;indoor&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="9">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
</span><span data-line="10">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="11">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="mi">3200</span><span class="p">,</span>      <span class="c1"># 3200K warm indoor lighting</span>
</span><span data-line="12">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
</span><span data-line="13">    <span class="p">},</span>
</span><span data-line="14">    <span class="s1">&#39;night&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="15">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
</span><span data-line="16">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
</span><span data-line="17">        <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>                 <span class="c1"># Boost sensor gain significantly</span>
</span><span data-line="18">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
</span><span data-line="19">    <span class="p">},</span>
</span><span data-line="20">    <span class="s1">&#39;conference&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="21">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
</span><span data-line="22">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span data-line="23">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="24">        <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                   <span class="c1"># Center camera horizontally</span>
</span><span data-line="25">        <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                  <span class="c1"># Center camera vertically</span>
</span><span data-line="26">        <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span>                 <span class="c1"># 1x (no zoom)</span>
</span><span data-line="27">    <span class="p">}</span>
</span><span data-line="28"><span class="p">}</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;daylight&#39;</span><span class="p">)</span>      <span class="c1"># Outdoor/bright lighting</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;indoor&#39;</span><span class="p">)</span>        <span class="c1"># Indoor artificial lighting</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;night&#39;</span><span class="p">)</span>         <span class="c1"># Low-light conditions</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;conference&#39;</span><span class="p">)</span>    <span class="c1"># Meeting room setup (centered, no zoom)</span>
</span></pre></div>
</div>
<p>Retrieve available presets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">preset_names</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_preset_names</span><span class="p">()</span>  <span class="c1"># [&#39;daylight&#39;, &#39;indoor&#39;, &#39;night&#39;, &#39;conference&#39;, ...]</span>
</span></pre></div>
</div>
</section>
<section id="smart-defaults-intelligent-default-set">
<h3><code class="docutils literal notranslate"><span class="pre">_SMART_DEFAULTS</span></code> intelligent default set<a class="headerlink" href="#smart-defaults-intelligent-default-set" title="Link to this heading">¶</a></h3>
<p>Intelligent default values applied by <code class="docutils literal notranslate"><span class="pre">reset_to_defaults()</span></code> and <code class="docutils literal notranslate"><span class="pre">set_smart_default()</span></code>. These favor automatic/neutral settings where available.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">_SMART_DEFAULTS</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>               <span class="c1"># Neutral brightness</span>
</span><span data-line="3">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>                 <span class="c1"># Neutral contrast</span>
</span><span data-line="4">    <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>               <span class="c1"># Neutral saturation</span>
</span><span data-line="5">    <span class="s1">&#39;sharpness&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>                <span class="c1"># Moderate sharpness</span>
</span><span data-line="6">    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>                   <span class="c1"># Linear gamma (1.0)</span>
</span><span data-line="7">    <span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                       <span class="c1"># No color shift</span>
</span><span data-line="8">    <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                       <span class="c1"># Center horizontally</span>
</span><span data-line="9">    <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                      <span class="c1"># Center vertically</span>
</span><span data-line="10">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>                    <span class="c1"># 1x (no zoom)</span>
</span><span data-line="11">    <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>        <span class="c1"># Automatic white balance</span>
</span><span data-line="12">    <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>             <span class="c1"># Automatic exposure</span>
</span><span data-line="13">    <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>                 <span class="c1"># Continuous autofocus</span>
</span><span data-line="14"><span class="p">}</span>
</span></pre></div>
</div>
<p>Set all properties to smart defaults:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">reset_to_defaults</span><span class="p">()</span>             <span class="c1"># Resets all to _SMART_DEFAULTS</span>
</span></pre></div>
</div>
<p>Set individual property to smart default:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set_smart_default</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_smart_default</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="fallback-mechanism-documentation">
<h3>Fallback mechanism documentation<a class="headerlink" href="#fallback-mechanism-documentation" title="Link to this heading">¶</a></h3>
<p>When device range queries fail or return unsupported, these constants serve as fallback boundaries:</p>
<ol class="arabic simple">
<li><p><strong>Query device</strong>: Call <code class="docutils literal notranslate"><span class="pre">_get_dynamic_range(property_name)</span></code> against the camera’s DirectShow interface.</p></li>
<li><p><strong>Success</strong>: Return device-reported <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">step</span></code>, and <code class="docutils literal notranslate"><span class="pre">default</span></code> values.</p></li>
<li><p><strong>Failure/Unsupported</strong>: Fall back to class constant (e.g., <code class="docutils literal notranslate"><span class="pre">BRIGHTNESS_MIN</span></code>/<code class="docutils literal notranslate"><span class="pre">MAX</span></code>).</p></li>
<li><p><strong>Invalid range</strong>: Use safe default from <code class="docutils literal notranslate"><span class="pre">_SMART_DEFAULTS</span></code>.</p></li>
</ol>
<p>This graceful degradation ensures operations work even with older or non-standard cameras.</p>
</section>
</section>
<hr class="docutils" />
<section id="internal-property-mappings">
<h2>3.5 Internal Property Mappings<a class="headerlink" href="#internal-property-mappings" title="Link to this heading">¶</a></h2>
<p>Property mappings enable flexible string-based access (<code class="docutils literal notranslate"><span class="pre">cam.set('brightness',</span> <span class="pre">80)</span></code>) while maintaining strong C++ typing internally. All properties map to enums defined in the C++ core.</p>
<section id="video-properties-dictionary-10-core-properties">
<h3><code class="docutils literal notranslate"><span class="pre">_VIDEO_PROPERTIES</span></code> dictionary (10 core properties)<a class="headerlink" href="#video-properties-dictionary-10-core-properties" title="Link to this heading">¶</a></h3>
<p>Maps video property names to <code class="docutils literal notranslate"><span class="pre">VidProp</span></code> C++ enums. Video properties control image appearance (brightness, color, processing).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">_VIDEO_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="c1"># Core properties</span>
</span><span data-line="3">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span>
</span><span data-line="4">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span>
</span><span data-line="5">    <span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Hue</span><span class="p">,</span>
</span><span data-line="6">    <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">,</span>
</span><span data-line="7">    <span class="s1">&#39;sharpness&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Sharpness</span><span class="p">,</span>
</span><span data-line="8">    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Gamma</span><span class="p">,</span>
</span><span data-line="9">    <span class="s1">&#39;color_enable&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">ColorEnable</span><span class="p">,</span>
</span><span data-line="10">    <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">WhiteBalance</span><span class="p">,</span>
</span><span data-line="11">    <span class="s1">&#39;video_backlight_compensation&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">BacklightCompensation</span><span class="p">,</span>
</span><span data-line="12">    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Gain</span><span class="p">,</span>
</span><span data-line="13">    
</span><span data-line="14">    <span class="c1"># Aliases (user-friendly shortcuts)</span>
</span><span data-line="15">    <span class="s1">&#39;wb&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">WhiteBalance</span><span class="p">,</span>
</span><span data-line="16">    <span class="s1">&#39;whitebalance&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">WhiteBalance</span><span class="p">,</span>
</span><span data-line="17">    <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">ColorEnable</span><span class="p">,</span>
</span><span data-line="18">    <span class="s1">&#39;colorenable&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">ColorEnable</span><span class="p">,</span>
</span><span data-line="19">    <span class="s1">&#39;sat&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">,</span>
</span><span data-line="20">    <span class="s1">&#39;bright&#39;</span><span class="p">:</span> <span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span>
</span><span data-line="21"><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>Video properties reference:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Property</p></th>
<th class="head text-left"><p>Type</p></th>
<th class="head text-left"><p>Aliases</p></th>
<th class="head text-left"><p>Purpose</p></th>
<th class="head text-left"><p>Device Range (Typical)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>brightness</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>bright</p></td>
<td class="text-left"><p>Image luminance (dark to bright)</p></td>
<td class="text-left"><p>0–255 (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>contrast</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Tonal range (flat to high)</p></td>
<td class="text-left"><p>0–100 (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>saturation</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>sat</p></td>
<td class="text-left"><p>Color intensity (grayscale to vivid)</p></td>
<td class="text-left"><p>0–100 (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>hue</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Color rotation (degrees)</p></td>
<td class="text-left"><p>-180 to +180 (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>sharpness</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Edge definition (blurry to sharp)</p></td>
<td class="text-left"><p>0–100 (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>gamma</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Tone curve (value ÷ 100 = gamma)</p></td>
<td class="text-left"><p>100–300 (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>color_enable</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>color, colorenable</p></td>
<td class="text-left"><p>Monochrome vs. color mode</p></td>
<td class="text-left"><p>— (boolean)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>white_balance</p></td>
<td class="text-left"><p>int/str</p></td>
<td class="text-left"><p>wb, whitebalance</p></td>
<td class="text-left"><p>Color temperature (Kelvin or ‘auto’)</p></td>
<td class="text-left"><p>2700–6500K or ‘auto’</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>video_backlight_compensation</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Backlighting adjustment</p></td>
<td class="text-left"><p>— (boolean)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>gain</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Sensor amplification (low to high)</p></td>
<td class="text-left"><p>0–100 (device-specific)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="camera-properties-dictionary-11-core-physical-properties">
<h3><code class="docutils literal notranslate"><span class="pre">_CAMERA_PROPERTIES</span></code> dictionary (11 core physical properties)<a class="headerlink" href="#camera-properties-dictionary-11-core-physical-properties" title="Link to this heading">¶</a></h3>
<p>Maps camera/PTZ property names to <code class="docutils literal notranslate"><span class="pre">CamProp</span></code> C++ enums. Camera properties control physical camera mechanics (pan, tilt, zoom, focus, exposure, etc.).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">_CAMERA_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="c1"># Core PTZ and physical control properties</span>
</span><span data-line="3">    <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Pan</span><span class="p">,</span>
</span><span data-line="4">    <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Tilt</span><span class="p">,</span>
</span><span data-line="5">    <span class="s1">&#39;roll&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Roll</span><span class="p">,</span>
</span><span data-line="6">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Zoom</span><span class="p">,</span>
</span><span data-line="7">    <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Exposure</span><span class="p">,</span>
</span><span data-line="8">    <span class="s1">&#39;iris&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Iris</span><span class="p">,</span>
</span><span data-line="9">    <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Focus</span><span class="p">,</span>
</span><span data-line="10">    <span class="s1">&#39;scan_mode&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">ScanMode</span><span class="p">,</span>
</span><span data-line="11">    <span class="s1">&#39;privacy&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Privacy</span><span class="p">,</span>
</span><span data-line="12">    <span class="s1">&#39;digital_zoom&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">DigitalZoom</span><span class="p">,</span>
</span><span data-line="13">    <span class="s1">&#39;backlight_compensation&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">BacklightCompensation</span><span class="p">,</span>
</span><span data-line="14">    
</span><span data-line="15">    <span class="c1"># Aliases (user-friendly shortcuts)</span>
</span><span data-line="16">    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Zoom</span><span class="p">,</span>
</span><span data-line="17">    <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Focus</span><span class="p">,</span>
</span><span data-line="18">    <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Exposure</span><span class="p">,</span>
</span><span data-line="19">    <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Pan</span><span class="p">,</span>
</span><span data-line="20">    <span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="n">CamProp</span><span class="o">.</span><span class="n">Tilt</span><span class="p">,</span>
</span><span data-line="21"><span class="p">}</span>
</span></pre></div>
</div>
<p><strong>Camera properties reference:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Property</p></th>
<th class="head text-left"><p>Type</p></th>
<th class="head text-left"><p>Aliases</p></th>
<th class="head text-left"><p>Purpose</p></th>
<th class="head text-left"><p>Device Range (Typical)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>pan</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>horizontal</p></td>
<td class="text-left"><p>Horizontal head rotation (degrees)</p></td>
<td class="text-left"><p>-180 to +180 (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>tilt</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>vertical</p></td>
<td class="text-left"><p>Vertical head rotation (degrees)</p></td>
<td class="text-left"><p>-90 to +90 (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>roll</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Rotation around optical axis</p></td>
<td class="text-left"><p>-180 to +180 (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>zoom</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>z</p></td>
<td class="text-left"><p>Optical magnification (100=1x)</p></td>
<td class="text-left"><p>100–1000+ (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>exposure</p></td>
<td class="text-left"><p>int/str</p></td>
<td class="text-left"><p>exp</p></td>
<td class="text-left"><p>Exposure value (EV) or automatic</p></td>
<td class="text-left"><p>-13 to +1 or ‘auto’ (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>iris</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Aperture/f-stop (closed to open)</p></td>
<td class="text-left"><p>0–100 (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>focus</p></td>
<td class="text-left"><p>int/str</p></td>
<td class="text-left"><p>f</p></td>
<td class="text-left"><p>Focus distance or continuous autofocus</p></td>
<td class="text-left"><p>0–100 or ‘auto’ (device-specific)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>scan_mode</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Interlaced vs. progressive</p></td>
<td class="text-left"><p>0=interlaced, 1=progressive (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>privacy</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Privacy shutter engagement</p></td>
<td class="text-left"><p>— (boolean)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>digital_zoom</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Post-capture software zoom</p></td>
<td class="text-left"><p>100–400+ (device-specific)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>backlight_compensation</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Camera-level backlighting fix</p></td>
<td class="text-left"><p>— (boolean)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="boolean-properties-set-6-boolean-properties">
<h3><code class="docutils literal notranslate"><span class="pre">_BOOLEAN_PROPERTIES</span></code> set (6 boolean properties)<a class="headerlink" href="#boolean-properties-set-6-boolean-properties" title="Link to this heading">¶</a></h3>
<p>Tracks properties that return boolean values (on/off, true/false). These properties are automatically converted from integer to boolean when read.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">_BOOLEAN_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="s1">&#39;color_enable&#39;</span><span class="p">,</span>                 <span class="c1"># Color vs. monochrome</span>
</span><span data-line="3">    <span class="s1">&#39;colorenable&#39;</span><span class="p">,</span>                  <span class="c1"># Alias</span>
</span><span data-line="4">    <span class="s1">&#39;color&#39;</span><span class="p">,</span>                        <span class="c1"># Alias</span>
</span><span data-line="5">    <span class="s1">&#39;privacy&#39;</span><span class="p">,</span>                      <span class="c1"># Privacy shutter</span>
</span><span data-line="6">    <span class="s1">&#39;video_backlight_compensation&#39;</span><span class="p">,</span> <span class="c1"># Backlight compensation</span>
</span><span data-line="7">    <span class="s1">&#39;backlight_compensation&#39;</span><span class="p">,</span>       <span class="c1"># Alias (camera-level)</span>
</span><span data-line="8"><span class="p">}</span>
</span></pre></div>
</div>
<p>When reading these properties, values are automatically converted from internal int representation to Python bool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">)</span>  <span class="c1"># Returns bool: True (color on) or False (monochrome)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">)</span>       <span class="c1"># Returns bool: True (shutter engaged) or False (open)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Equivalent manual setting (automatically handled):</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>   <span class="c1"># Sets on</span>
</span><span data-line="6"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>       <span class="c1"># Opens shutter</span>
</span></pre></div>
</div>
</section>
<section id="property-mapping-strategy-and-data-flow">
<h3>Property mapping strategy and data flow<a class="headerlink" href="#property-mapping-strategy-and-data-flow" title="Link to this heading">¶</a></h3>
<p>The string-based property access system resolves user-provided names to C++ enums through a consistent pipeline:</p>
<p><strong>Write operation (<code class="docutils literal notranslate"><span class="pre">cam.set('brightness',</span> <span class="pre">80)</span></code>)</strong>:</p>
<ol class="arabic simple">
<li><p>User provides property name string (canonical or alias)</p></li>
<li><p>Lookup in <code class="docutils literal notranslate"><span class="pre">_VIDEO_PROPERTIES</span></code> or <code class="docutils literal notranslate"><span class="pre">_CAMERA_PROPERTIES</span></code> dict</p></li>
<li><p>Resolve alias to canonical <code class="docutils literal notranslate"><span class="pre">VidProp</span></code>/<code class="docutils literal notranslate"><span class="pre">CamProp</span></code> enum</p></li>
<li><p>Check if property in <code class="docutils literal notranslate"><span class="pre">_BOOLEAN_PROPERTIES</span></code> for type handling</p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">PropSetting</span></code> object with value and mode</p></li>
<li><p>Call C++ core: <code class="docutils literal notranslate"><span class="pre">camera.set(enum,</span> <span class="pre">PropSetting)</span></code></p></li>
<li><p>Return success or raise exception on failure</p></li>
</ol>
<p><strong>Read operation (<code class="docutils literal notranslate"><span class="pre">value</span> <span class="pre">=</span> <span class="pre">cam.get('brightness')</span></code>)</strong>:</p>
<ol class="arabic simple">
<li><p>User provides property name string</p></li>
<li><p>Lookup in dictionaries; resolve alias to enum</p></li>
<li><p>Check if property in <code class="docutils literal notranslate"><span class="pre">_BOOLEAN_PROPERTIES</span></code> for type conversion</p></li>
<li><p>Call C++ core: <code class="docutils literal notranslate"><span class="pre">camera.get(enum)</span></code></p></li>
<li><p>Extract value from returned <code class="docutils literal notranslate"><span class="pre">PropSetting</span></code> result</p></li>
<li><p>If property in <code class="docutils literal notranslate"><span class="pre">_BOOLEAN_PROPERTIES</span></code>, convert int to bool (0→False, non-zero→True)</p></li>
<li><p>Return final value to user</p></li>
</ol>
<p><strong>Alias resolution flow example</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">Input: cam.set(&#39;wb&#39;, 5500)
</span><span data-line="2">  ↓
</span><span data-line="3">Lookup: _VIDEO_PROPERTIES[&#39;wb&#39;]
</span><span data-line="4">  ↓
</span><span data-line="5">Resolved to: VidProp.WhiteBalance
</span><span data-line="6">  ↓
</span><span data-line="7">Create: PropSetting(5500, CamMode.Manual)
</span><span data-line="8">  ↓
</span><span data-line="9">Execute C++: camera.set(VidProp.WhiteBalance, PropSetting)
</span><span data-line="10">  ↓
</span><span data-line="11">Result: White balance set to 5500K on device
</span></pre></div>
</div>
<p><strong>Boolean conversion flow example</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">Input: cam.get(&#39;privacy&#39;)
</span><span data-line="2">  ↓
</span><span data-line="3">Lookup: _CAMERA_PROPERTIES[&#39;privacy&#39;]
</span><span data-line="4">  ↓
</span><span data-line="5">Resolved to: CamProp.Privacy
</span><span data-line="6">  ↓
</span><span data-line="7">Check: &#39;privacy&#39; in _BOOLEAN_PROPERTIES? Yes
</span><span data-line="8">  ↓
</span><span data-line="9">Execute C++: int_value = camera.get(CamProp.Privacy).value()
</span><span data-line="10">  ↓
</span><span data-line="11">Convert: int_value (0 or 1) → bool (False or True)
</span><span data-line="12">  ↓
</span><span data-line="13">Return: bool(privacy_status)
</span></pre></div>
</div>
</section>
<section id="direct-property-accessor-methods">
<h3>Direct property accessor methods<a class="headerlink" href="#direct-property-accessor-methods" title="Link to this heading">¶</a></h3>
<p>For convenience, all properties have paired getter/setter methods that call <code class="docutils literal notranslate"><span class="pre">get()</span></code> and <code class="docutils literal notranslate"><span class="pre">set()</span></code> internally:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Direct setters (all internally call cam.set())</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>      <span class="c1"># Same as cam.set(&#39;brightness&#39;, 80)</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set_pan</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>             <span class="c1"># Same as cam.set(&#39;pan&#39;, 45)</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set_focus</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>       <span class="c1"># Same as cam.set(&#39;focus&#39;, &#39;auto&#39;)</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">set_white_balance</span><span class="p">(</span><span class="mi">5500</span><span class="p">)</span> <span class="c1"># Same as cam.set(&#39;white_balance&#39;, 5500)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Direct getters (all internally call cam.get())</span>
</span><span data-line="8"><span class="n">brightness</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_brightness</span><span class="p">()</span>
</span><span data-line="9"><span class="n">pan</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_pan</span><span class="p">()</span>
</span><span data-line="10"><span class="n">focus</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_focus</span><span class="p">()</span>
</span><span data-line="11"><span class="n">white_balance</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_white_balance</span><span class="p">()</span>
</span></pre></div>
</div>
<p>Complete getter/setter pairs are available for all properties in <code class="docutils literal notranslate"><span class="pre">_VIDEO_PROPERTIES</span></code> and <code class="docutils literal notranslate"><span class="pre">_CAMERA_PROPERTIES</span></code>. These provide type-safe, IDE-autocomplete-friendly access when you prefer named methods over string lookups.</p>
</section>
</section>
<section id="video-properties-image-processing-control">
<h2>3.6 Video Properties - Image Processing Control<a class="headerlink" href="#video-properties-image-processing-control" title="Link to this heading">¶</a></h2>
<p>Video properties control image appearance and processing. All video properties query the device’s actual supported range via <code class="docutils literal notranslate"><span class="pre">_get_dynamic_range()</span></code>, with fallback defaults for unsupported cameras. Device-specific ranges are device-reported and may vary significantly across camera models.</p>
<section id="brightness-property">
<h3>Brightness property<a class="headerlink" href="#brightness-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera brightness (uses device range, typically 0-255).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="s2">&quot;brightness&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@brightness</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set brightness using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;brightness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="s2">&quot;brightness&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Gets/sets image luminance (darkness to brightness). Queries device for actual range; falls back to 0-100 if device doesn’t report range. Device-specific ranges vary: typical 0-255, but some cameras report 0-100 or other ranges.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">80</span>
</span><span data-line="2"><span class="n">current</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span>  <span class="c1"># Returns int within device range</span>
</span></pre></div>
</div>
<p>Also accessible via string API: <code class="docutils literal notranslate"><span class="pre">cam.set('brightness',</span> <span class="pre">80)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('bright',</span> <span class="pre">80)</span></code>.</p>
</section>
<section id="contrast-property">
<h3>Contrast property<a class="headerlink" href="#contrast-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">contrast</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera contrast (uses device range, typically 0-100).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span> <span class="s2">&quot;contrast&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@contrast</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">contrast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set contrast using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;contrast&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span> <span class="s2">&quot;contrast&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Controls tonal range definition (flat to high-contrast). Queries device for range; falls back to 0-100. Device-specific ranges typically 0-100 or 0-127.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">contrast</span> <span class="o">=</span> <span class="mi">50</span>
</span><span data-line="2"><span class="n">value</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">contrast</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('contrast',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="hue-property">
<h3>Hue property<a class="headerlink" href="#hue-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">hue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera hue (uses device range, often -180 to +180).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Hue</span><span class="p">,</span> <span class="s2">&quot;hue&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@hue</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">hue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set hue using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;hue&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Hue</span><span class="p">,</span> <span class="s2">&quot;hue&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Rotates colors around color wheel (degrees). Queries device; falls back to -180 to +180. Negative values shift towards magenta/red; positive towards cyan/green.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">hue</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># No shift</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">hue</span> <span class="o">=</span> <span class="mi">45</span>  <span class="c1"># Shift towards cyan</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('hue',</span> <span class="pre">45)</span></code>.</p>
</section>
<section id="saturation-property">
<h3>Saturation property<a class="headerlink" href="#saturation-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">saturation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera saturation (uses device range, typically 0-100).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">,</span> <span class="s2">&quot;saturation&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@saturation</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">saturation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set saturation using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;saturation&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">,</span> <span class="s2">&quot;saturation&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Adjusts color intensity (grayscale to vivid). Queries device; falls back to 0-100. Device-specific ranges typically 0-100 or 0-200.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">saturation</span> <span class="o">=</span> <span class="mi">50</span>   <span class="c1"># Neutral</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">saturation</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Vivid colors</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('saturation',</span> <span class="pre">50)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('sat',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="sharpness-property">
<h3>Sharpness property<a class="headerlink" href="#sharpness-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">sharpness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera sharpness (uses device range).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Sharpness</span><span class="p">,</span> <span class="s2">&quot;sharpness&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@sharpness</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">sharpness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set sharpness using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;sharpness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Sharpness</span><span class="p">,</span> <span class="s2">&quot;sharpness&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Defines edge definition (blurry to sharp). Queries device; falls back to 0-100. Device ranges typically 0-100, 0-7, or manufacturer-specific values.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">sharpness</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Moderate</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">sharpness</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Soft/blurred</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('sharpness',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="gamma-property">
<h3>Gamma property<a class="headerlink" href="#gamma-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera gamma (uses device range).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Gamma</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@gamma</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set gamma using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Gamma</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Adjusts tone curve (non-linear brightness mapping). Value is stored as $int \times 0.01 = gamma$ (e.g., 100 = 1.0 linear, 180 = 1.8). Queries device; falls back to 100-300. Device ranges vary: some 100-300, others 40-400.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Linear (1.0)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="mi">180</span>  <span class="c1"># Gamma 1.8 (brightens midtones)</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('gamma',</span> <span class="pre">100)</span></code>.</p>
</section>
<section id="colorenable-property-boolean">
<h3>ColorEnable property (boolean)<a class="headerlink" href="#colorenable-property-boolean" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">color_enable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Color vs monochrome (True = color, False = mono).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">ColorEnable</span><span class="p">,</span> <span class="s2">&quot;color_enable&quot;</span><span class="p">))</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@color_enable</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">color_enable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set color mode (no range needed for bool).&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">ColorEnable</span><span class="p">,</span> <span class="s2">&quot;color_enable&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
</span></pre></div>
</div>
<p>Toggles monochrome vs. color output. Boolean property; automatically converted to/from int. Not range-queried (bool is always 0 or 1).</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">color_enable</span> <span class="o">=</span> <span class="kc">True</span>   <span class="c1"># Enable color</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">color_enable</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Monochrome</span>
</span><span data-line="3"><span class="n">is_color</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">color_enable</span>  <span class="c1"># Returns bool: True or False</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('color_enable',</span> <span class="pre">True)</span></code> or aliases <code class="docutils literal notranslate"><span class="pre">cam.set('color',</span> <span class="pre">True)</span></code> / <code class="docutils literal notranslate"><span class="pre">cam.set('colorenable',</span> <span class="pre">True)</span></code>.</p>
</section>
<section id="whitebalance-property-kelvin">
<h3>WhiteBalance property (Kelvin)<a class="headerlink" href="#whitebalance-property-kelvin" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">white_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;White balance temperature (uses device range, in Kelvin).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">WhiteBalance</span><span class="p">,</span> <span class="s2">&quot;white_balance&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@white_balance</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">white_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set white balance using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;white_balance&quot;</span><span class="p">,</span> <span class="mi">2700</span><span class="p">,</span> <span class="mi">6500</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">WhiteBalance</span><span class="p">,</span> <span class="s2">&quot;white_balance&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Adjusts color temperature (Kelvin scale). Integer value represents degrees Kelvin. Queries device; falls back to 2700-6500K. Device ranges vary: indoor 3000-4000K, daylight 5000-6500K, auto-balance varies.</p>
<p>Typical color temperatures:</p>
<ul class="simple">
<li><p>2700K: Warm (incandescent)</p></li>
<li><p>3000-4000K: Indoor/warm LED</p></li>
<li><p>5000K: Daylight neutral</p></li>
<li><p>5500-6500K: Cool (daylight)</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">white_balance</span> <span class="o">=</span> <span class="mi">5500</span>  <span class="c1"># Daylight</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">white_balance</span> <span class="o">=</span> <span class="mi">3200</span>  <span class="c1"># Warm indoor</span>
</span><span data-line="3"><span class="n">current</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">white_balance</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('white_balance',</span> <span class="pre">5500)</span></code> or aliases <code class="docutils literal notranslate"><span class="pre">cam.set('wb',</span> <span class="pre">5500)</span></code> / <code class="docutils literal notranslate"><span class="pre">cam.set('whitebalance',</span> <span class="pre">5500)</span></code>. Use <code class="docutils literal notranslate"><span class="pre">cam.set('white_balance',</span> <span class="pre">'auto')</span></code> for automatic white balance.</p>
</section>
<section id="videobacklightcompensation-property">
<h3>VideoBacklightCompensation property<a class="headerlink" href="#videobacklightcompensation-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">video_backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Video backlight compensation (uses device range).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">BacklightCompensation</span><span class="p">,</span> <span class="s2">&quot;video_backlight_compensation&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@video_backlight_compensation</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">video_backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set backlight compensation using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;video_backlight_compensation&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">BacklightCompensation</span><span class="p">,</span> <span class="s2">&quot;video_backlight_compensation&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Adjusts for backlighting conditions (camera image processing level). Queries device; falls back to 0-100. Device ranges typically 0-100 (0=off, 100=maximum).</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">video_backlight_compensation</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Medium</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">video_backlight_compensation</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Off</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('video_backlight_compensation',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="gain-property">
<h3>Gain property<a class="headerlink" href="#gain-property" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">gain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sensor gain/amplification (uses device range).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Gain</span><span class="p">,</span> <span class="s2">&quot;gain&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@gain</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set gain using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;gain&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Gain</span><span class="p">,</span> <span class="s2">&quot;gain&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Amplifies sensor signal (useful in low light). Queries device; falls back to 0-100. Device ranges vary: typical 0-100, 0-255, or 0-16 (dB steps).</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="mi">50</span>   <span class="c1"># Medium amplification</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="mi">80</span>   <span class="c1"># High (for low-light)</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Minimum</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('gain',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="dynamic-range-query-mechanism">
<h3>Dynamic range query mechanism<a class="headerlink" href="#dynamic-range-query-mechanism" title="Link to this heading">¶</a></h3>
<p>All video properties use <code class="docutils literal notranslate"><span class="pre">_get_dynamic_range()</span></code> internally:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_get_dynamic_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fallback_min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fallback_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get actual device range for property, with fallback defaults.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="5">        <span class="k">if</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="6">            <span class="k">return</span> <span class="p">(</span><span class="n">prop_range</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">fallback_min</span><span class="p">),</span> <span class="n">prop_range</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">fallback_max</span><span class="p">))</span>
</span><span data-line="7">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="8">        <span class="k">pass</span>
</span><span data-line="9">    <span class="k">return</span> <span class="p">(</span><span class="n">fallback_min</span><span class="p">,</span> <span class="n">fallback_max</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Query flow:</p>
<ol class="arabic simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">get_property_range(property_name)</span></code> on device via DirectShow</p></li>
<li><p>If successful, return device-reported min/max</p></li>
<li><p>If query fails or returns None, use fallback constants as default</p></li>
<li><p>Set operation validated against retrieved range</p></li>
</ol>
</section>
<section id="device-specific-range-variations">
<h3>Device-specific range variations<a class="headerlink" href="#device-specific-range-variations" title="Link to this heading">¶</a></h3>
<p>Property ranges vary dramatically across camera models:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Property</p></th>
<th class="head text-left"><p>Typical Range</p></th>
<th class="head text-left"><p>Example Variations</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>brightness</p></td>
<td class="text-left"><p>0-255</p></td>
<td class="text-left"><p>Logitech: 0-255; Generic: 0-100; Intel: 0-200</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>contrast</p></td>
<td class="text-left"><p>0-100</p></td>
<td class="text-left"><p>0-100, 0-127, 0-255</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>saturation</p></td>
<td class="text-left"><p>0-100</p></td>
<td class="text-left"><p>0-100, 0-200</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>hue</p></td>
<td class="text-left"><p>-180 to +180</p></td>
<td class="text-left"><p>-180 to +180, -64 to +64 (some devices)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>sharpness</p></td>
<td class="text-left"><p>0-100</p></td>
<td class="text-left"><p>0-100, 0-7, manufacturer-specific</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>gamma</p></td>
<td class="text-left"><p>100-300</p></td>
<td class="text-left"><p>100-300, 40-400, device-specific</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>white_balance</p></td>
<td class="text-left"><p>2700-6500K</p></td>
<td class="text-left"><p>2700-6500K, 3000-7000K, device-specific</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>gain</p></td>
<td class="text-left"><p>0-100</p></td>
<td class="text-left"><p>0-100, 0-255, 0-16 dB (device-specific)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="fallback-constants">
<h3>Fallback constants<a class="headerlink" href="#fallback-constants" title="Link to this heading">¶</a></h3>
<p>When device reports no range, these constants are used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">BRIGHTNESS_MIN</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="2"><span class="n">BRIGHTNESS_MAX</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="3"><span class="n">BRIGHTNESS_DEFAULT</span> <span class="o">=</span> <span class="mi">50</span>
</span><span data-line="4">
</span><span data-line="5"><span class="n">CONTRAST_MIN</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="6"><span class="n">CONTRAST_MAX</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="7"><span class="n">CONTRAST_DEFAULT</span> <span class="o">=</span> <span class="mi">50</span>
</span><span data-line="8">
</span><span data-line="9"><span class="n">SATURATION_MIN</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="10"><span class="n">SATURATION_MAX</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="11"><span class="n">SATURATION_DEFAULT</span> <span class="o">=</span> <span class="mi">50</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">HUE_MIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span>
</span><span data-line="14"><span class="n">HUE_MAX</span> <span class="o">=</span> <span class="mi">180</span>
</span><span data-line="15"><span class="n">HUE_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="16">
</span><span data-line="17"><span class="n">GAMMA_MIN</span> <span class="o">=</span> <span class="mi">100</span>
</span><span data-line="18"><span class="n">GAMMA_MAX</span> <span class="o">=</span> <span class="mi">300</span>
</span><span data-line="19"><span class="n">GAMMA_DEFAULT</span> <span class="o">=</span> <span class="mi">100</span>
</span></pre></div>
</div>
<p>Ensure operations never fail on unsupported cameras; gracefully degrade to safe nominal ranges.</p>
</section>
<section id="property-validation-and-error-handling">
<h3>Property validation and error handling<a class="headerlink" href="#property-validation-and-error-handling" title="Link to this heading">¶</a></h3>
<p>All setters validate values against device range before applying:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Validation example (internal)</span>
</span><span data-line="2"><span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">min_val</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
</span><span data-line="3">    <span class="k">raise</span> <span class="n">InvalidValueError</span><span class="p">(</span>
</span><span data-line="4">        <span class="sa">f</span><span class="s2">&quot;brightness must be between </span><span class="si">{</span><span class="n">min_val</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">max_val</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="5">    <span class="p">)</span>
</span></pre></div>
</div>
<p>Out-of-range values raise <code class="docutils literal notranslate"><span class="pre">InvalidValueError</span></code> with clear min/max guidance. Use <code class="docutils literal notranslate"><span class="pre">get_property_range()</span></code> to inspect actual ranges programmatically.</p>
</section>
</section>
<section id="camera-properties-physical-control">
<h2>3.7 Camera Properties - Physical Control<a class="headerlink" href="#camera-properties-physical-control" title="Link to this heading">¶</a></h2>
<p>Camera properties control physical camera movements and mechanical/electronic functions. All camera properties query device-specific limits via <code class="docutils literal notranslate"><span class="pre">_get_dynamic_range()</span></code>. These properties vary widely across camera models; device-specific behavior notes and quirks are documented below.</p>
<section id="pan-property-horizontal-rotation">
<h3>Pan property (horizontal rotation)<a class="headerlink" href="#pan-property-horizontal-rotation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">pan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pan angle in degrees (uses device range, typically -180 to +180).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Pan</span><span class="p">,</span> <span class="s2">&quot;pan&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@pan</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">pan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set pan angle using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;pan&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Pan</span><span class="p">,</span> <span class="s2">&quot;pan&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Rotates camera horizontally (left/right). Queries device; falls back to -180 to +180 degrees. Negative values pan left; positive pan right; 0 is center.</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>PTZ cameras</strong>: Typically -180 to +180 (full rotation)</p></li>
<li><p><strong>Fixed webcams</strong>: Often unsupported or very limited ranges (-30 to +30)</p></li>
<li><p><strong>Some USB cameras</strong>: Report ranges in different units; library normalizes to degrees</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c1"># Center</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="mi">45</span>     <span class="c1"># Pan 45° right</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>    <span class="c1"># Pan 90° left</span>
</span><span data-line="4"><span class="n">current</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">pan</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('pan',</span> <span class="pre">45)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('horizontal',</span> <span class="pre">45)</span></code>.</p>
</section>
<section id="tilt-property-vertical-rotation">
<h3>Tilt property (vertical rotation)<a class="headerlink" href="#tilt-property-vertical-rotation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">tilt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tilt angle in degrees (uses device range, typically -90 to +90).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Tilt</span><span class="p">,</span> <span class="s2">&quot;tilt&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@tilt</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">tilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set tilt angle using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;tilt&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Tilt</span><span class="p">,</span> <span class="s2">&quot;tilt&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Rotates camera vertically (up/down). Queries device; falls back to -90 to +90 degrees. Negative values tilt down; positive tilt up; 0 is center.</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>PTZ cameras</strong>: Typically -90 to +90</p></li>
<li><p><strong>Fixed webcams</strong>: Often unsupported; may report 0 range</p></li>
<li><p><strong>Mechanical limits</strong>: Some cameras physically limit to -45 to +45; query <code class="docutils literal notranslate"><span class="pre">get_property_range('tilt')</span></code> for actual limits</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c1"># Center</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c1"># Tilt 30° up</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span>   <span class="c1"># Tilt 15° down</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('tilt',</span> <span class="pre">30)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('vertical',</span> <span class="pre">30)</span></code>.</p>
</section>
<section id="roll-property-rotation-around-optical-axis">
<h3>Roll property (rotation around optical axis)<a class="headerlink" href="#roll-property-rotation-around-optical-axis" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll angle in degrees (uses device range, typically -180 to +180).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Roll</span><span class="p">,</span> <span class="s2">&quot;roll&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@roll</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set roll angle using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;roll&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Roll</span><span class="p">,</span> <span class="s2">&quot;roll&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Rotates image around optical axis (tilts left/right edge). Queries device; falls back to -180 to +180 degrees.</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Most cameras</strong>: Roll is <strong>unsupported</strong>; returns error on set</p></li>
<li><p><strong>Advanced PTZ cameras</strong>: May support ±45 to ±180</p></li>
<li><p><strong>Workaround</strong>: If unsupported, roll is typically disabled in firmware; check <code class="docutils literal notranslate"><span class="pre">get_property_range('roll')</span></code> returns valid range before setting</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c1"># Neutral</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="mi">10</span>     <span class="c1"># Roll 10° right</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>    <span class="c1"># Roll 10° left</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('roll',</span> <span class="pre">10)</span></code>.</p>
</section>
<section id="zoom-property-optical-magnification">
<h3>Zoom property (optical magnification)<a class="headerlink" href="#zoom-property-optical-magnification" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optical zoom multiplier × 100 (uses device range, typically 100-1000).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Zoom</span><span class="p">,</span> <span class="s2">&quot;zoom&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@zoom</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set zoom using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;zoom&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Zoom</span><span class="p">,</span> <span class="s2">&quot;zoom&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Sets optical magnification. Queries device; falls back to 100-1000. Value represents multiplier × 100 (e.g., 100 = 1x, 200 = 2x, 500 = 5x).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Logitech cameras</strong>: 100-4x (100-400 range)</p></li>
<li><p><strong>High-end PTZ</strong>: 100-30x or more (100-3000+ range)</p></li>
<li><p><strong>Fixed webcams</strong>: Often unsupported or fixed at 100 (no zoom)</p></li>
<li><p><strong>Note</strong>: Optical zoom may degrade image quality at extreme ranges; test at target zoom before deployment</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># 1x (no zoom)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mi">200</span>   <span class="c1"># 2x zoom</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mi">500</span>   <span class="c1"># 5x zoom</span>
</span><span data-line="4"><span class="n">current</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">zoom</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('zoom',</span> <span class="pre">200)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('z',</span> <span class="pre">200)</span></code>.</p>
</section>
<section id="exposure-property-shutter-speed-exposure-time">
<h3>Exposure property (shutter speed / exposure time)<a class="headerlink" href="#exposure-property-shutter-speed-exposure-time" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exposure value in EV units (uses device range, e.g., -13 to +1).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Exposure</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@exposure</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set exposure using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;exposure&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Exposure</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Controls exposure time / shutter speed. Queries device; falls back to -13 to +1 EV (exposure value units). Negative values darken; positive values brighten. EV adjusts exposure by powers of 2 (each ±1 EV doubles/halves light).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Typical range</strong>: -12 to +12 EV (varies by camera)</p></li>
<li><p><strong>Note</strong>: Some cameras use proprietary units instead of EV; library converts where possible</p></li>
<li><p><strong>Workaround</strong>: If exposure doesn’t respond as expected, device may require manual mode; try setting exposure mode to ‘manual’ first</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">exposure</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Default</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">exposure</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>   <span class="c1"># Darker (1/4 light)</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">exposure</span> <span class="o">=</span> <span class="mi">2</span>    <span class="c1"># Brighter (4x light)</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>  <span class="c1"># Automatic exposure</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('exposure',</span> <span class="pre">-2)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('exp',</span> <span class="pre">-2)</span></code>.</p>
</section>
<section id="iris-property-aperture-f-stop">
<h3>Iris property (aperture / f-stop)<a class="headerlink" href="#iris-property-aperture-f-stop" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">iris</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Iris aperture/f-stop (uses device range, typically 0-100).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Iris</span><span class="p">,</span> <span class="s2">&quot;iris&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@iris</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">iris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set iris using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;iris&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Iris</span><span class="p">,</span> <span class="s2">&quot;iris&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Controls aperture opening (depth of field and light gathering). Queries device; falls back to 0-100. Lower values = wider aperture (more light, shallow focus); higher values = smaller aperture (less light, deep focus).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Most cameras</strong>: Iris is <strong>unsupported</strong> (fixed aperture)</p></li>
<li><p><strong>Supported cameras</strong>: Typically 0-100 mapping to f/1.4 to f/32 (approximate)</p></li>
<li><p><strong>Workaround</strong>: If iris is unsupported, exposure or gain can approximate depth-of-field effects</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">iris</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c1"># Wide open (max light, shallow focus)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">iris</span> <span class="o">=</span> <span class="mi">50</span>    <span class="c1"># Mid aperture</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">iris</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># Small aperture (deep focus)</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('iris',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="focus-property-autofocus-or-manual-focus-distance">
<h3>Focus property (autofocus or manual focus distance)<a class="headerlink" href="#focus-property-autofocus-or-manual-focus-distance" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">focus</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Focus distance 0-100 or &#39;auto&#39; for continuous autofocus.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Focus</span><span class="p">,</span> <span class="s2">&quot;focus&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@focus</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set focus using actual device range or &#39;auto&#39;.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
</span><span data-line="10">        <span class="bp">self</span><span class="o">.</span><span class="n">_set_property_auto</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">)</span>
</span><span data-line="11">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="12">        <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;focus&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="13">        <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Focus</span><span class="p">,</span> <span class="s2">&quot;focus&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Controls focus distance (manual) or enables autofocus. Queries device; falls back to 0-100. Accepts int (manual) or ‘auto’ string.</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Most cameras</strong>: Support autofocus via ‘auto’ mode (highly recommended)</p></li>
<li><p><strong>Manual mode</strong>: 0=closest focus, 100=farthest (hyperfocal)</p></li>
<li><p><strong>Some cameras</strong>: Autofocus very slow; manual focus may be faster for dynamic scenes</p></li>
<li><p><strong>Workaround</strong>: If autofocus hunting occurs (oscillating focus), switch to manual mode with fixed distance</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>   <span class="c1"># Continuous autofocus (recommended)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="mi">50</span>       <span class="c1"># Manual focus at midpoint</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># Manual close-up focus</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>  <span class="c1"># Autofocus via string API</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('focus',</span> <span class="pre">50)</span></code> or alias <code class="docutils literal notranslate"><span class="pre">cam.set('f',</span> <span class="pre">50)</span></code>.</p>
</section>
<section id="scanmode-property-interlaced-vs-progressive">
<h3>ScanMode property (interlaced vs. progressive)<a class="headerlink" href="#scanmode-property-interlaced-vs-progressive" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">scan_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Scan mode (0=interlaced, 1=progressive).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">ScanMode</span><span class="p">,</span> <span class="s2">&quot;scan_mode&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@scan_mode</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">scan_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set scan mode (0 or 1).&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">ScanMode</span><span class="p">,</span> <span class="s2">&quot;scan_mode&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Selects video scanning format. No dynamic range needed (0 or 1 only). 0=interlaced (legacy TV format), 1=progressive (modern, no flickering).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Modern cameras</strong>: Progressive (1) is standard; interlaced rarely used</p></li>
<li><p><strong>Compatibility</strong>: Some older cameras report only interlaced; check support before relying on progressive</p></li>
<li><p><strong>Performance</strong>: Progressive mode may reduce max frame rate on some low-end cameras</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">scan_mode</span> <span class="o">=</span> <span class="mi">1</span>    <span class="c1"># Progressive (recommended)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">scan_mode</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Interlaced (legacy)</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('scan_mode',</span> <span class="pre">1)</span></code>.</p>
</section>
<section id="privacy-property-privacy-shutter">
<h3>Privacy property (privacy shutter)<a class="headerlink" href="#privacy-property-privacy-shutter" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">privacy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Privacy shutter engaged (True=on, False=off).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Privacy</span><span class="p">,</span> <span class="s2">&quot;privacy&quot;</span><span class="p">))</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@privacy</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">privacy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Engage privacy shutter (electronic or mechanical).&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Privacy</span><span class="p">,</span> <span class="s2">&quot;privacy&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
</span></pre></div>
</div>
<p>Engages electronic or mechanical privacy shutter. Boolean property. True=shutter closed (camera disabled); False=shutter open (normal operation).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Some cameras</strong>: Hardware privacy button (LED indicates state); software control works independently</p></li>
<li><p><strong>Others</strong>: Electronic only; no visual feedback beyond API state</p></li>
<li><p><strong>Workaround</strong>: If privacy appears stuck, query status via <code class="docutils literal notranslate"><span class="pre">cam.privacy</span></code> before troubleshooting</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">privacy</span> <span class="o">=</span> <span class="kc">True</span>   <span class="c1"># Close privacy shutter</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">privacy</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Open shutter (normal operation)</span>
</span><span data-line="3"><span class="n">is_privacy_on</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">privacy</span>  <span class="c1"># Check status</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('privacy',</span> <span class="pre">True)</span></code>.</p>
</section>
<section id="digitalzoom-property-software-post-capture-zoom">
<h3>DigitalZoom property (software/post-capture zoom)<a class="headerlink" href="#digitalzoom-property-software-post-capture-zoom" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">digital_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Digital zoom multiplier × 100 (uses device range, typically 100-400).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">DigitalZoom</span><span class="p">,</span> <span class="s2">&quot;digital_zoom&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@digital_zoom</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">digital_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set digital zoom using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;digital_zoom&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">DigitalZoom</span><span class="p">,</span> <span class="s2">&quot;digital_zoom&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Post-capture software zoom (crops and upscales). Queries device; falls back to 100-400. Like optical zoom, value is multiplier × 100 (100=1x, 200=2x).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Quality</strong>: Digital zoom degrades image quality (lossy cropping); prefer optical zoom</p></li>
<li><p><strong>Combined with optical</strong>: May be combined with optical zoom on some cameras (e.g., optical 4x + digital 2x = 8x total, degraded)</p></li>
<li><p><strong>Typical use</strong>: Emergency zoom when optical zoom insufficient; avoid in production if possible</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">digital_zoom</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># 1x (no digital zoom)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">digital_zoom</span> <span class="o">=</span> <span class="mi">200</span>   <span class="c1"># 2x (crops center, upscales)</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('digital_zoom',</span> <span class="pre">200)</span></code>.</p>
</section>
<section id="backlightcompensation-property-camera-level">
<h3>BacklightCompensation property (camera-level)<a class="headerlink" href="#backlightcompensation-property-camera-level" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Backlight compensation engaged (camera-level control).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">BacklightCompensation</span><span class="p">,</span> <span class="s2">&quot;backlight_compensation&quot;</span><span class="p">))</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@backlight_compensation</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Enable camera-level backlight compensation.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">BacklightCompensation</span><span class="p">,</span> <span class="s2">&quot;backlight_compensation&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
</span></pre></div>
</div>
<p>Camera-level backlight adjustment (different from video-level <code class="docutils literal notranslate"><span class="pre">video_backlight_compensation</span></code>). Boolean property. True=enable; False=disable. Works at camera sensor level (more primitive than video processing).</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Note</strong>: Distinct from <code class="docutils literal notranslate"><span class="pre">video_backlight_compensation</span></code> which is image processing level; this is camera-level</p></li>
<li><p><strong>Interaction</strong>: Using both simultaneously may cause unpredictable results; prefer <code class="docutils literal notranslate"><span class="pre">video_backlight_compensation</span></code> for finer control</p></li>
<li><p><strong>Workaround</strong>: If image over/under-exposes with both enabled, disable camera-level version</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">backlight_compensation</span> <span class="o">=</span> <span class="kc">True</span>   <span class="c1"># Enable</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">backlight_compensation</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Disable</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('backlight_compensation',</span> <span class="pre">True)</span></code>.</p>
</section>
<section id="lamp-property-led-control">
<h3>Lamp property (LED control)<a class="headerlink" href="#lamp-property-led-control" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">lamp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;LED lamp intensity (uses device range, typically 0-100).&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Lamp</span><span class="p">,</span> <span class="s2">&quot;lamp&quot;</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@lamp</span><span class="o">.</span><span class="n">setter</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">lamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set LED lamp intensity using actual device range.&quot;&quot;&quot;</span>
</span><span data-line="9">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;lamp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Lamp</span><span class="p">,</span> <span class="s2">&quot;lamp&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Controls built-in LED light (if camera has one). Queries device; falls back to 0-100. 0=off; higher values=brighter.</p>
<p>Device-specific notes:</p>
<ul class="simple">
<li><p><strong>Availability</strong>: Most consumer cameras lack built-in LED; supported primarily on professional/PTZ models</p></li>
<li><p><strong>Unsupported</strong>: Attempting set on camera without LED raises error; query <code class="docutils literal notranslate"><span class="pre">get_property_range('lamp')</span></code> first to check support</p></li>
<li><p><strong>Power draw</strong>: LED significantly increases power consumption; consider USB power limitations</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">if</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="s1">&#39;lamp&#39;</span><span class="p">):</span>  <span class="c1"># Check support</span>
</span><span data-line="2">    <span class="n">cam</span><span class="o">.</span><span class="n">lamp</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Set LED to 50% brightness</span>
</span></pre></div>
</div>
<p>Also: <code class="docutils literal notranslate"><span class="pre">cam.set('lamp',</span> <span class="pre">50)</span></code> (if supported).</p>
</section>
<section id="device-specific-behavior-and-quirks">
<h3>Device-specific behavior and quirks<a class="headerlink" href="#device-specific-behavior-and-quirks" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Behavior</p></th>
<th class="head text-left"><p>Cameras Affected</p></th>
<th class="head text-left"><p>Workaround</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Pan/tilt very slow</p></td>
<td class="text-left"><p>Most USB cameras</p></td>
<td class="text-left"><p>Set smaller increments; use continuous movement instead of steps</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Zoom “snaps” between discrete steps</p></td>
<td class="text-left"><p>Some older cameras</p></td>
<td class="text-left"><p>Smooth zoom unavailable; adjust expectations</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Focus hunting (oscillating)</p></td>
<td class="text-left"><p>Cheap autofocus cameras</p></td>
<td class="text-left"><p>Switch to manual focus with fixed distance</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Exposure changes cause lag</p></td>
<td class="text-left"><p>Cameras with slow sensors</p></td>
<td class="text-left"><p>Pre-set exposure before recording critical frames</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Privacy shutter doesn’t respond</p></td>
<td class="text-left"><p>Hardware-restricted cameras</p></td>
<td class="text-left"><p>Check physical button state; software control may be ignored</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Roll unsupported</p></td>
<td class="text-left"><p>99% of cameras</p></td>
<td class="text-left"><p>Query range before using; expect error on most devices</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id1">
<h3>Device-specific range variations<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Property</p></th>
<th class="head text-left"><p>Typical Range</p></th>
<th class="head text-left"><p>Variations</p></th>
<th class="head text-left"><p>Query Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>pan</p></td>
<td class="text-left"><p>-180 to +180°</p></td>
<td class="text-left"><p>Fixed: 0 range; PTZ: -180 to +180; Limited: -30 to +30</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('pan')</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>tilt</p></td>
<td class="text-left"><p>-90 to +90°</p></td>
<td class="text-left"><p>Fixed: 0; Limited: -45 to +45</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('tilt')</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>zoom</p></td>
<td class="text-left"><p>100–1000</p></td>
<td class="text-left"><p>100–400 (Logitech); 100–3000 (PTZ)</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('zoom')</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>exposure</p></td>
<td class="text-left"><p>-13 to +1 EV</p></td>
<td class="text-left"><p>-12 to +12 (varies); proprietary units on some</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('exposure')</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>focus</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Device-specific; some report 0–255 or different scales</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('focus')</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>digital_zoom</p></td>
<td class="text-left"><p>100–400</p></td>
<td class="text-left"><p>100–300; 100–200 (limited devices)</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('digital_zoom')</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>lamp</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Unsupported on most; 0–255 (professional cameras)</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">cam.get_property_range('lamp')</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="relative-movement-combined-ptz">
<h2>3.8 Relative Movement &amp; Combined PTZ<a class="headerlink" href="#relative-movement-combined-ptz" title="Link to this heading">¶</a></h2>
<p>Relative movement methods adjust camera position/zoom by delta values rather than absolute positions. Combined movement methods execute multiple operations atomically, reducing latency and enabling smoother motion. Some cameras support hardware-level combined commands; others fall back to sequential individual commands.</p>
<section id="pan-relative-movement">
<h3>Pan relative movement<a class="headerlink" href="#pan-relative-movement" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">pan_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pan camera by relative degrees (left/right increment).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_pan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pan</span>
</span><span data-line="5">    <span class="n">target_pan</span> <span class="o">=</span> <span class="n">current_pan</span> <span class="o">+</span> <span class="n">degrees</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="c1"># Clamp to device range</span>
</span><span data-line="8">    <span class="n">min_pan</span><span class="p">,</span> <span class="n">max_pan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;pan&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</span><span data-line="9">    <span class="n">target_pan</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_pan</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_pan</span><span class="p">,</span> <span class="n">target_pan</span><span class="p">))</span>
</span><span data-line="10">    
</span><span data-line="11">    <span class="bp">self</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="n">target_pan</span>
</span></pre></div>
</div>
<p>Adjusts pan angle by delta. Internally calculates target position, clamps to device range, applies absolutely. Positive degrees = pan right; negative = pan left.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">pan_relative</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>   <span class="c1"># Pan 45° right from current position</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">pan_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># Pan 30° left</span>
</span></pre></div>
</div>
</section>
<section id="tilt-relative-movement">
<h3>Tilt relative movement<a class="headerlink" href="#tilt-relative-movement" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">tilt_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tilt camera by relative degrees (up/down increment).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_tilt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span>
</span><span data-line="5">    <span class="n">target_tilt</span> <span class="o">=</span> <span class="n">current_tilt</span> <span class="o">+</span> <span class="n">degrees</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="n">min_tilt</span><span class="p">,</span> <span class="n">max_tilt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;tilt&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
</span><span data-line="8">    <span class="n">target_tilt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_tilt</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_tilt</span><span class="p">,</span> <span class="n">target_tilt</span><span class="p">))</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="n">target_tilt</span>
</span></pre></div>
</div>
<p>Adjusts tilt angle by delta. Positive degrees = tilt up; negative = tilt down.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">tilt_relative</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>   <span class="c1"># Tilt 20° up</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">tilt_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Tilt 10° down</span>
</span></pre></div>
</div>
</section>
<section id="roll-relative-movement">
<h3>Roll relative movement<a class="headerlink" href="#roll-relative-movement" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">roll_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Roll camera by relative degrees (rotate around optical axis).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_roll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roll</span>
</span><span data-line="5">    <span class="n">target_roll</span> <span class="o">=</span> <span class="n">current_roll</span> <span class="o">+</span> <span class="n">degrees</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="n">min_roll</span><span class="p">,</span> <span class="n">max_roll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;roll&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</span><span data-line="8">    <span class="n">target_roll</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_roll</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_roll</span><span class="p">,</span> <span class="n">target_roll</span><span class="p">))</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="n">target_roll</span>
</span></pre></div>
</div>
<p>Adjusts roll by delta. Positive degrees = clockwise; negative = counterclockwise.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">roll_relative</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>   <span class="c1"># Roll 15° clockwise</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">roll_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>   <span class="c1"># Roll 5° counterclockwise</span>
</span></pre></div>
</div>
<p>Note: Roll is unsupported on most cameras; query <code class="docutils literal notranslate"><span class="pre">get_property_range('roll')</span></code> before using.</p>
</section>
<section id="zoom-relative-movement-step-based">
<h3>Zoom relative movement (step-based)<a class="headerlink" href="#zoom-relative-movement-step-based" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">zoom_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Zoom by relative steps (teleconverter-style stepping).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_zoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span>
</span><span data-line="5">    <span class="c1"># Each step = 10% magnification increase (device-dependent)</span>
</span><span data-line="6">    <span class="n">step_increment</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># 0.5x per step (typical)</span>
</span><span data-line="7">    <span class="n">target_zoom</span> <span class="o">=</span> <span class="n">current_zoom</span> <span class="o">+</span> <span class="p">(</span><span class="n">steps</span> <span class="o">*</span> <span class="n">step_increment</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="n">min_zoom</span><span class="p">,</span> <span class="n">max_zoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;zoom&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span data-line="10">    <span class="n">target_zoom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_zoom</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_zoom</span><span class="p">,</span> <span class="n">target_zoom</span><span class="p">))</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">target_zoom</span>
</span></pre></div>
</div>
<p>Adjusts zoom by step increments. Each step typically = 0.5x magnification (device-specific). Positive steps = zoom in; negative = zoom out.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">zoom_relative</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>   <span class="c1"># Zoom in 2 steps (roughly 1x magnification)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">zoom_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Zoom out 1 step</span>
</span></pre></div>
</div>
</section>
<section id="focus-relative-movement-step-based">
<h3>Focus relative movement (step-based)<a class="headerlink" href="#focus-relative-movement-step-based" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">focus_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust focus by relative steps (manual focus increment).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_focus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span>
</span><span data-line="5">    <span class="c1"># Each step = 2% distance change (device-dependent)</span>
</span><span data-line="6">    <span class="n">step_increment</span> <span class="o">=</span> <span class="mi">2</span>
</span><span data-line="7">    <span class="n">target_focus</span> <span class="o">=</span> <span class="n">current_focus</span> <span class="o">+</span> <span class="p">(</span><span class="n">steps</span> <span class="o">*</span> <span class="n">step_increment</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="n">min_focus</span><span class="p">,</span> <span class="n">max_focus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;focus&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="n">target_focus</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_focus</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_focus</span><span class="p">,</span> <span class="n">target_focus</span><span class="p">))</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="n">target_focus</span>
</span></pre></div>
</div>
<p>Adjusts focus by step increments. Each step typically = 2% focus distance change (device-specific). Positive steps = focus farther; negative = focus closer.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">focus_relative</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="c1"># Focus farther (5 steps)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">focus_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Focus closer (3 steps)</span>
</span></pre></div>
</div>
<p>Note: Use <code class="docutils literal notranslate"><span class="pre">focus</span> <span class="pre">=</span> <span class="pre">'auto'</span></code> for continuous autofocus instead of manual stepping.</p>
</section>
<section id="exposure-relative-movement-ev-steps">
<h3>Exposure relative movement (EV steps)<a class="headerlink" href="#exposure-relative-movement-ev-steps" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">exposure_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust exposure by relative EV steps.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_exposure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exposure</span>
</span><span data-line="5">    <span class="c1"># Each step = 1 EV (doubles/halves light)</span>
</span><span data-line="6">    <span class="n">target_exposure</span> <span class="o">=</span> <span class="n">current_exposure</span> <span class="o">+</span> <span class="n">steps</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;exposure&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span data-line="9">    <span class="n">target_exposure</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_exp</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_exp</span><span class="p">,</span> <span class="n">target_exposure</span><span class="p">))</span>
</span><span data-line="10">    
</span><span data-line="11">    <span class="bp">self</span><span class="o">.</span><span class="n">exposure</span> <span class="o">=</span> <span class="n">target_exposure</span>
</span></pre></div>
</div>
<p>Adjusts exposure by EV steps. Each step = 1 EV (doubles/halves light). Positive steps = brighter; negative = darker.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">exposure_relative</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>   <span class="c1"># Brighten by 2 EV (4x light)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">exposure_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Darken by 1 EV (0.5x light)</span>
</span></pre></div>
</div>
</section>
<section id="iris-relative-movement-step-based">
<h3>Iris relative movement (step-based)<a class="headerlink" href="#iris-relative-movement-step-based" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">iris_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust iris/aperture by relative steps.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_iris</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iris</span>
</span><span data-line="5">    <span class="c1"># Each step = 5% aperture adjustment (device-dependent)</span>
</span><span data-line="6">    <span class="n">step_increment</span> <span class="o">=</span> <span class="mi">5</span>
</span><span data-line="7">    <span class="n">target_iris</span> <span class="o">=</span> <span class="n">current_iris</span> <span class="o">+</span> <span class="p">(</span><span class="n">steps</span> <span class="o">*</span> <span class="n">step_increment</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="n">min_iris</span><span class="p">,</span> <span class="n">max_iris</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;iris&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="10">    <span class="n">target_iris</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_iris</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_iris</span><span class="p">,</span> <span class="n">target_iris</span><span class="p">))</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="bp">self</span><span class="o">.</span><span class="n">iris</span> <span class="o">=</span> <span class="n">target_iris</span>
</span></pre></div>
</div>
<p>Adjusts iris (aperture) by steps. Positive steps = smaller aperture (less light); negative = wider aperture (more light).</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">iris_relative</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>   <span class="c1"># Close aperture 2 steps</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">iris_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Open aperture 1 step</span>
</span></pre></div>
</div>
<p>Note: Iris unsupported on most fixed-aperture cameras.</p>
</section>
<section id="digital-zoom-relative-movement">
<h3>Digital zoom relative movement<a class="headerlink" href="#digital-zoom-relative-movement" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">digital_zoom_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust digital zoom by relative steps.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    <span class="n">current_dzoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">digital_zoom</span>
</span><span data-line="5">    <span class="c1"># Each step = 10% magnification (device-dependent)</span>
</span><span data-line="6">    <span class="n">step_increment</span> <span class="o">=</span> <span class="mi">10</span>
</span><span data-line="7">    <span class="n">target_dzoom</span> <span class="o">=</span> <span class="n">current_dzoom</span> <span class="o">+</span> <span class="p">(</span><span class="n">steps</span> <span class="o">*</span> <span class="n">step_increment</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="n">min_dzoom</span><span class="p">,</span> <span class="n">max_dzoom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;digital_zoom&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span><span data-line="10">    <span class="n">target_dzoom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_dzoom</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_dzoom</span><span class="p">,</span> <span class="n">target_dzoom</span><span class="p">))</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="bp">self</span><span class="o">.</span><span class="n">digital_zoom</span> <span class="o">=</span> <span class="n">target_dzoom</span>
</span></pre></div>
</div>
<p>Adjusts digital (software) zoom by steps. Positive steps = zoom in; negative = zoom out.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">digital_zoom_relative</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Zoom in 2 steps (lossy)</span>
</span></pre></div>
</div>
<p>Note: Digital zoom degrades quality; use optical zoom when possible.</p>
</section>
<section id="simultaneous-pan-tilt-movement">
<h3>Simultaneous pan+tilt movement<a class="headerlink" href="#simultaneous-pan-tilt-movement" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set_pan_tilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pan</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">tilt</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set pan and tilt simultaneously (atomic operation).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Validate ranges</span>
</span><span data-line="6">    <span class="n">min_pan</span><span class="p">,</span> <span class="n">max_pan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;pan&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</span><span data-line="7">    <span class="n">min_tilt</span><span class="p">,</span> <span class="n">max_tilt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s2">&quot;tilt&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="n">pan</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_pan</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_pan</span><span class="p">,</span> <span class="n">pan</span><span class="p">))</span>
</span><span data-line="10">    <span class="n">tilt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_tilt</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_tilt</span><span class="p">,</span> <span class="n">tilt</span><span class="p">))</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="13">        <span class="c1"># Attempt hardware-level simultaneous command</span>
</span><span data-line="14">        <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="n">pan</span><span class="p">,</span> <span class="n">tilt</span><span class="p">)</span>
</span><span data-line="15">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="16">        <span class="c1"># Fallback to sequential commands</span>
</span><span data-line="17">        <span class="bp">self</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="n">pan</span>
</span><span data-line="18">        <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="n">tilt</span>
</span></pre></div>
</div>
<p>Sets pan and tilt atomically. Some cameras support hardware-level simultaneous movement (smoother motion); others fall back to sequential pan then tilt commands.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># Pan 45° right, tilt 30° down simultaneously</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1"># Center camera</span>
</span></pre></div>
</div>
</section>
<section id="combined-relative-pan-tilt-movement">
<h3>Combined relative pan+tilt movement<a class="headerlink" href="#combined-relative-pan-tilt-movement" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">pan_tilt_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pan_delta</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">tilt_delta</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust pan and tilt by relative deltas (combined move).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Calculate target positions</span>
</span><span data-line="6">    <span class="n">current_pan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pan</span>
</span><span data-line="7">    <span class="n">current_tilt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span>
</span><span data-line="8">    <span class="n">target_pan</span> <span class="o">=</span> <span class="n">current_pan</span> <span class="o">+</span> <span class="n">pan_delta</span>
</span><span data-line="9">    <span class="n">target_tilt</span> <span class="o">=</span> <span class="n">current_tilt</span> <span class="o">+</span> <span class="n">tilt_delta</span>
</span><span data-line="10">    
</span><span data-line="11">    <span class="c1"># Apply constraints and execute as combined move</span>
</span><span data-line="12">    <span class="bp">self</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="n">target_pan</span><span class="p">,</span> <span class="n">target_tilt</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Adjusts pan and tilt by deltas from current position. Combines relative calculation with atomic simultaneous movement.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">pan_tilt_relative</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">)</span>   <span class="c1"># Pan 30° right, tilt 20° down</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">pan_tilt_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    <span class="c1"># Pan 45° left, hold tilt</span>
</span></pre></div>
</div>
</section>
<section id="hardware-support-and-fallback-strategy">
<h3>Hardware support and fallback strategy<a class="headerlink" href="#hardware-support-and-fallback-strategy" title="Link to this heading">¶</a></h3>
<p>Combined movement support varies by camera:</p>
<p><strong>Hardware-supported combined commands</strong>:</p>
<ul class="simple">
<li><p>Professional PTZ cameras (Sony, Panasonic, etc.)</p></li>
<li><p>Some IP cameras with DirectShow interface</p></li>
<li><p>Result: Smooth, coordinated motion</p></li>
</ul>
<p><strong>Fallback to individual commands</strong>:</p>
<ul class="simple">
<li><p>Most USB webcams</p></li>
<li><p>Budget IP cameras</p></li>
<li><p>Result: Sequential pan then tilt (slightly jerky but functional)</p></li>
</ul>
<p>The library automatically detects support and falls back gracefully:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="c1"># Try hardware combined command</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="n">pan</span><span class="p">,</span> <span class="n">tilt</span><span class="p">)</span>
</span><span data-line="4"><span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span data-line="5">    <span class="c1"># Fallback to individual</span>
</span><span data-line="6">    <span class="bp">self</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="n">pan</span>
</span><span data-line="7">    <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="n">tilt</span>
</span><span data-line="8"><span class="k">except</span> <span class="n">OperationNotSupported</span><span class="p">:</span>
</span><span data-line="9">    <span class="c1"># Fallback to individual</span>
</span><span data-line="10">    <span class="bp">self</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="n">pan</span>
</span><span data-line="11">    <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="n">tilt</span>
</span></pre></div>
</div>
</section>
<section id="relative-vs-absolute-positioning-guide">
<h3>Relative vs. absolute positioning guide<a class="headerlink" href="#relative-vs-absolute-positioning-guide" title="Link to this heading">¶</a></h3>
<p><strong>Use absolute positioning</strong> (<code class="docutils literal notranslate"><span class="pre">cam.pan</span> <span class="pre">=</span> <span class="pre">45</span></code>):</p>
<ul class="simple">
<li><p>Setting specific target (e.g., look at fixed point)</p></li>
<li><p>Resetting to known state (e.g., <code class="docutils literal notranslate"><span class="pre">cam.pan</span> <span class="pre">=</span> <span class="pre">0</span></code> to center)</p></li>
<li><p>API simplicity (single operation)</p></li>
</ul>
<p><strong>Use relative movement</strong> (<code class="docutils literal notranslate"><span class="pre">cam.pan_relative(10)</span></code>):</p>
<ul class="simple">
<li><p>Incremental adjustments (e.g., joystick-style panning)</p></li>
<li><p>Smooth continuous motion (repeatedly call with small steps)</p></li>
<li><p>Bounds-safe (automatically clamps to device limits)</p></li>
</ul>
<p><strong>Use combined movement</strong> (<code class="docutils literal notranslate"><span class="pre">cam.set_pan_tilt(45,</span> <span class="pre">-30)</span></code>):</p>
<ul class="simple">
<li><p>Simultaneous multi-axis motion (faster, smoother)</p></li>
<li><p>Reduces latency (single command vs. two sequential)</p></li>
<li><p>Must know both target values (less convenient than relative)</p></li>
</ul>
<p><strong>Example: Smooth panning (relative)</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Smooth leftward pan using relative increments</span>
</span><span data-line="2"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span data-line="3">    <span class="n">cam</span><span class="o">.</span><span class="n">pan_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Pan 5° left each step</span>
</span><span data-line="4">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>       <span class="c1"># 1 second total pan</span>
</span></pre></div>
</div>
<p><strong>Example: Center and reset (absolute)</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Center both axes atomically</span>
</span></pre></div>
</div>
<p><strong>Example: Joystick control (mixed)</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">handle_joystick</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;x,y are joystick axis values (-1.0 to +1.0).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">pan_delta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">45</span><span class="p">)</span>       <span class="c1"># ±45° range</span>
</span><span data-line="4">    <span class="n">tilt_delta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="o">-</span><span class="mi">30</span><span class="p">)</span>     <span class="c1"># ±30° range (Y inverted)</span>
</span><span data-line="5">    
</span><span data-line="6">    <span class="c1"># Calculate target (relative from current)</span>
</span><span data-line="7">    <span class="n">target_pan</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">pan</span> <span class="o">+</span> <span class="n">pan_delta</span>
</span><span data-line="8">    <span class="n">target_tilt</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">tilt</span> <span class="o">+</span> <span class="n">tilt_delta</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="c1"># Apply as combined move</span>
</span><span data-line="11">    <span class="n">cam</span><span class="o">.</span><span class="n">set_pan_tilt</span><span class="p">(</span><span class="n">target_pan</span><span class="p">,</span> <span class="n">target_tilt</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="performance-considerations">
<h3>Performance considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Method</p></th>
<th class="head text-left"><p>Latency</p></th>
<th class="head text-left"><p>Hardware Support</p></th>
<th class="head text-left"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Absolute <code class="docutils literal notranslate"><span class="pre">pan</span> <span class="pre">=</span> <span class="pre">45</span></code></p></td>
<td class="text-left"><p>~50ms</p></td>
<td class="text-left"><p>All cameras</p></td>
<td class="text-left"><p>Discrete positioning</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Relative <code class="docutils literal notranslate"><span class="pre">pan_relative(5)</span></code></p></td>
<td class="text-left"><p>~50ms</p></td>
<td class="text-left"><p>All cameras</p></td>
<td class="text-left"><p>Incremental motion</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Combined <code class="docutils literal notranslate"><span class="pre">set_pan_tilt()</span></code></p></td>
<td class="text-left"><p>~30ms (hardware) ~80ms (fallback)</p></td>
<td class="text-left"><p>PTZ/Pro cameras</p></td>
<td class="text-left"><p>Smooth simultaneous motion</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Relative combined <code class="docutils literal notranslate"><span class="pre">pan_tilt_relative()</span></code></p></td>
<td class="text-left"><p>~30-80ms</p></td>
<td class="text-left"><p>Varies</p></td>
<td class="text-left"><p>Joystick-style continuous</p></td>
</tr>
</tbody>
</table>
</div>
<p>For <strong>real-time applications</strong> (joystick, tracking), use combined movement methods. For <strong>one-time positioning</strong>, absolute is simpler. These latency measures are just estimates, real values vary.</p>
</section>
</section>
<section id="string-based-universal-property-access">
<h2>3.9 String-Based Universal Property Access<a class="headerlink" href="#string-based-universal-property-access" title="Link to this heading">¶</a></h2>
<p>The universal string-based API allows dynamic property access by name without knowing property types ahead of time. Both <code class="docutils literal notranslate"><span class="pre">set()</span></code> and <code class="docutils literal notranslate"><span class="pre">get()</span></code> perform property name resolution, handle type conversion, and support auto mode strings for properties that require it.</p>
<section id="universal-setter-method-set-property-name-value-mode-manual">
<h3>Universal setter method: <code class="docutils literal notranslate"><span class="pre">set(property_name,</span> <span class="pre">value,</span> <span class="pre">mode='manual')</span></code><a class="headerlink" href="#universal-setter-method-set-property-name-value-mode-manual" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set any property by name (video, camera, or auto mode string).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Resolve property name (handle alias)</span>
</span><span data-line="6">    <span class="n">prop_name</span> <span class="o">=</span> <span class="n">property_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="c1"># Check if auto mode string (special handling)</span>
</span><span data-line="9">    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;continuous&#39;</span><span class="p">]:</span>
</span><span data-line="10">        <span class="bp">self</span><span class="o">.</span><span class="n">_set_property_auto</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="11">        <span class="k">return</span>
</span><span data-line="12">    
</span><span data-line="13">    <span class="c1"># Determine property type (video or camera)</span>
</span><span data-line="14">    <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span data-line="15">        <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="16">    <span class="k">elif</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span data-line="17">        <span class="bp">self</span><span class="o">.</span><span class="n">_set_camera_property</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</span><span data-line="18">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="19">        <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property &#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39; not recognized&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Universal setter accepts any property by string name. Supports three value types:</p>
<ol class="arabic simple">
<li><p><strong>Integer values</strong>: Direct numeric assignment (brightness, pan, zoom, etc.)</p></li>
<li><p><strong>String auto mode</strong>: Special values like <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, <code class="docutils literal notranslate"><span class="pre">'continuous'</span></code> for autofocus/auto white balance</p></li>
<li><p><strong>Boolean values</strong>: For boolean properties (automatically converted to int)</p></li>
</ol>
<p>Mode parameter controls operation mode:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>      <span class="c1"># Manual exposure</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>                 <span class="c1"># Auto exposure (via string value)</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>                    <span class="c1"># Autofocus</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;white_balance&#39;</span><span class="p">,</span> <span class="mi">5500</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>  <span class="c1"># Manual white balance</span>
</span></pre></div>
</div>
</section>
<section id="universal-getter-method-get-property-name">
<h3>Universal getter method: <code class="docutils literal notranslate"><span class="pre">get(property_name)</span></code><a class="headerlink" href="#universal-getter-method-get-property-name" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get any property by name (video or camera), with automatic type conversion.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Resolve property name</span>
</span><span data-line="6">    <span class="n">prop_name</span> <span class="o">=</span> <span class="n">property_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="c1"># Determine property type and fetch</span>
</span><span data-line="9">    <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span data-line="10">        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="11">    <span class="k">elif</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span data-line="12">        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_camera_property</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="13">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="14">        <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property &#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39; not recognized&quot;</span><span class="p">)</span>
</span><span data-line="15">    
</span><span data-line="16">    <span class="c1"># Automatic type conversion for boolean properties</span>
</span><span data-line="17">    <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span><span class="p">:</span>
</span><span data-line="18">        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Convert int to bool</span>
</span><span data-line="19">    
</span><span data-line="20">    <span class="k">return</span> <span class="n">value</span>
</span></pre></div>
</div>
<p>Universal getter returns property value by string name. Automatically converts types:</p>
<ul class="simple">
<li><p><strong>Boolean properties</strong>: Returns <code class="docutils literal notranslate"><span class="pre">bool</span></code> (True/False) instead of int (0/1)</p></li>
<li><p><strong>Integer properties</strong>: Returns <code class="docutils literal notranslate"><span class="pre">int</span></code> as-is</p></li>
<li><p><strong>Mode-dependent properties</strong>: Returns current int value (mode is read from device)</p></li>
</ul>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">brightness</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>     <span class="c1"># Returns int</span>
</span><span data-line="2"><span class="n">pan</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pan&#39;</span><span class="p">)</span>                   <span class="c1"># Returns int</span>
</span><span data-line="3"><span class="n">is_color</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">)</span>     <span class="c1"># Returns bool (auto-converted)</span>
</span><span data-line="4"><span class="n">privacy_on</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">)</span>        <span class="c1"># Returns bool</span>
</span></pre></div>
</div>
</section>
<section id="property-name-resolution-lookup-strategy">
<h3>Property name resolution &amp; lookup strategy<a class="headerlink" href="#property-name-resolution-lookup-strategy" title="Link to this heading">¶</a></h3>
<p>Property names are resolved through multi-step lookup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_resolve_property_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolve property name to (enum, is_video, canonical_name).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">name_lower</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Step 1: Check video properties (canonical + aliases)</span>
</span><span data-line="6">    <span class="k">if</span> <span class="n">name_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">:</span>
</span><span data-line="7">        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">[</span><span class="n">name_lower</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="n">name_lower</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="c1"># Step 2: Check camera properties (canonical + aliases)</span>
</span><span data-line="10">    <span class="k">if</span> <span class="n">name_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">:</span>
</span><span data-line="11">        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">[</span><span class="n">name_lower</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name_lower</span><span class="p">)</span>
</span><span data-line="12">    
</span><span data-line="13">    <span class="c1"># Step 3: Not found</span>
</span><span data-line="14">    <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown property: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Resolution priority:</p>
<ol class="arabic simple">
<li><p><strong>Canonical names</strong>: <code class="docutils literal notranslate"><span class="pre">'brightness'</span></code>, <code class="docutils literal notranslate"><span class="pre">'pan'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zoom'</span></code>, etc.</p></li>
<li><p><strong>Aliases</strong>: <code class="docutils literal notranslate"><span class="pre">'bright'</span></code>, <code class="docutils literal notranslate"><span class="pre">'z'</span></code>, <code class="docutils literal notranslate"><span class="pre">'wb'</span></code>, etc.</p></li>
<li><p><strong>Error</strong>: Raise <code class="docutils literal notranslate"><span class="pre">PropertyNotSupportedError</span></code> if not found</p></li>
</ol>
<p><strong>Resolution examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">Input: &#39;brightness&#39; → Video property
</span><span data-line="2">Input: &#39;bright&#39;     → Alias for &#39;brightness&#39; (video)
</span><span data-line="3">Input: &#39;wb&#39;         → Alias for &#39;white_balance&#39; (video)
</span><span data-line="4">Input: &#39;z&#39;          → Alias for &#39;zoom&#39; (camera)
</span><span data-line="5">Input: &#39;horizontal&#39; → Alias for &#39;pan&#39; (camera)
</span><span data-line="6">Input: &#39;invalid&#39;    → PropertyNotSupportedError
</span></pre></div>
</div>
</section>
<section id="automatic-type-conversion-for-boolean">
<h3>Automatic type conversion for boolean<a class="headerlink" href="#automatic-type-conversion-for-boolean" title="Link to this heading">¶</a></h3>
<p>Boolean properties are automatically converted between int (device representation) and bool (Python representation):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Write: bool → int</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>       <span class="c1"># Python: True, Device: 1</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>           <span class="c1"># Python: False, Device: 0</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Read: int → bool</span>
</span><span data-line="6"><span class="n">is_color</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">)</span>  <span class="c1"># Device: 1, Python: True</span>
</span><span data-line="7"><span class="n">privacy</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">)</span>        <span class="c1"># Device: 0, Python: False</span>
</span></pre></div>
</div>
<p>Conversion logic:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># To device (int):</span>
</span><span data-line="2"><span class="n">device_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">python_bool</span><span class="p">)</span>     <span class="c1"># True → 1, False → 0</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># From device (bool):</span>
</span><span data-line="5"><span class="n">python_bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">device_value</span><span class="p">)</span>    <span class="c1"># 0 → False, non-zero → True</span>
</span></pre></div>
</div>
</section>
<section id="auto-mode-string-support">
<h3>Auto mode string support<a class="headerlink" href="#auto-mode-string-support" title="Link to this heading">¶</a></h3>
<p>Properties supporting automatic modes accept special string values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;white_balance&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>    <span class="c1"># Enable auto white balance</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>             <span class="c1"># Enable continuous autofocus</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>          <span class="c1"># Enable automatic exposure</span>
</span></pre></div>
</div>
<p>Auto mode strings are mode-agnostic (user doesn’t specify <code class="docutils literal notranslate"><span class="pre">CamMode</span></code> enum):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_set_property_auto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set property to automatic/continuous mode.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">mode</span> <span class="o">=</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Auto</span>  <span class="c1"># Or CamMode.Continuous</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Resolve property</span>
</span><span data-line="6">    <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">:</span>
</span><span data-line="7">        <span class="n">enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span>
</span><span data-line="8">        <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">enum</span><span class="p">,</span> <span class="n">PropSetting</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="p">))</span>
</span><span data-line="9">    <span class="k">elif</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">:</span>
</span><span data-line="10">        <span class="n">enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span>
</span><span data-line="11">        <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">enum</span><span class="p">,</span> <span class="n">PropSetting</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="p">))</span>
</span></pre></div>
</div>
<p>Supported auto modes:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Property</p></th>
<th class="head text-left"><p>Auto Values</p></th>
<th class="head text-left"><p>Effect</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>white_balance</p></td>
<td class="text-left"><p>‘auto’</p></td>
<td class="text-left"><p>Automatic color temperature detection</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>focus</p></td>
<td class="text-left"><p>‘auto’, ‘continuous’</p></td>
<td class="text-left"><p>Continuous autofocus</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>exposure</p></td>
<td class="text-left"><p>‘auto’</p></td>
<td class="text-left"><p>Automatic exposure control</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>iris</p></td>
<td class="text-left"><p>‘auto’</p></td>
<td class="text-left"><p>Automatic aperture adjustment</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="mode-string-parsing-parse-mode-string-helper">
<h3>Mode string parsing: <code class="docutils literal notranslate"><span class="pre">_parse_mode_string()</span></code> helper<a class="headerlink" href="#mode-string-parsing-parse-mode-string-helper" title="Link to this heading">¶</a></h3>
<p>Helper method converts user-provided mode strings to C++ <code class="docutils literal notranslate"><span class="pre">CamMode</span></code> enums:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_parse_mode_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CamMode</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse mode string to CamMode enum.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">mode_lower</span> <span class="o">=</span> <span class="n">mode_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="n">mode_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="6">        <span class="s1">&#39;manual&#39;</span><span class="p">:</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">,</span>
</span><span data-line="7">        <span class="s1">&#39;auto&#39;</span><span class="p">:</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Auto</span><span class="p">,</span>
</span><span data-line="8">        <span class="s1">&#39;continuous&#39;</span><span class="p">:</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Continuous</span><span class="p">,</span>
</span><span data-line="9">        <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Priority</span><span class="p">,</span>
</span><span data-line="10">        <span class="s1">&#39;absolute&#39;</span><span class="p">:</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Absolute</span><span class="p">,</span>
</span><span data-line="11">        <span class="s1">&#39;relative&#39;</span><span class="p">:</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Relative</span><span class="p">,</span>
</span><span data-line="12">    <span class="p">}</span>
</span><span data-line="13">    
</span><span data-line="14">    <span class="k">if</span> <span class="n">mode_lower</span> <span class="ow">in</span> <span class="n">mode_map</span><span class="p">:</span>
</span><span data-line="15">        <span class="k">return</span> <span class="n">mode_map</span><span class="p">[</span><span class="n">mode_lower</span><span class="p">]</span>
</span><span data-line="16">    
</span><span data-line="17">    <span class="c1"># Default to manual if unknown</span>
</span><span data-line="18">    <span class="k">return</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span>
</span></pre></div>
</div>
<p>Mode strings accepted:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>String</p></th>
<th class="head text-left"><p>CamMode</p></th>
<th class="head text-left"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>‘manual’</p></td>
<td class="text-left"><p>Manual</p></td>
<td class="text-left"><p>User controls value directly</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>‘auto’</p></td>
<td class="text-left"><p>Auto</p></td>
<td class="text-left"><p>Camera decides (one-time)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>‘continuous’</p></td>
<td class="text-left"><p>Continuous</p></td>
<td class="text-left"><p>Camera continuously adjusts</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>‘absolute’</p></td>
<td class="text-left"><p>Absolute</p></td>
<td class="text-left"><p>Absolute positioning</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>‘relative’</p></td>
<td class="text-left"><p>Relative</p></td>
<td class="text-left"><p>Relative movement</p></td>
</tr>
</tbody>
</table>
</div>
<p>Usage with mode parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>        <span class="c1"># Manual mode</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>          <span class="c1"># Manual exposure</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;absolute&#39;</span><span class="p">)</span>           <span class="c1"># Absolute focus position</span>
</span></pre></div>
</div>
</section>
<section id="property-alias-resolution-logic">
<h3>Property alias resolution logic<a class="headerlink" href="#property-alias-resolution-logic" title="Link to this heading">¶</a></h3>
<p>Alias resolution allows flexible property naming:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_is_alias_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">canonical</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if alias resolves to canonical property.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="c1"># Video properties</span>
</span><span data-line="4">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">canonical</span><span class="p">):</span>
</span><span data-line="5">        <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="c1"># Camera properties</span>
</span><span data-line="8">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">canonical</span><span class="p">):</span>
</span><span data-line="9">        <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="10">    
</span><span data-line="11">    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>
</div>
<p><strong>Alias resolution flow:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">User: cam.set(&#39;bright&#39;, 80)
</span><span data-line="2">  ↓
</span><span data-line="3">Lookup &#39;bright&#39; in _VIDEO_PROPERTIES
</span><span data-line="4">  ↓
</span><span data-line="5">Found: VidProp.Brightness (same as &#39;brightness&#39;)
</span><span data-line="6">  ↓
</span><span data-line="7">Resolve to: brightness (canonical name)
</span><span data-line="8">  ↓
</span><span data-line="9">Apply operation
</span></pre></div>
</div>
<p><strong>Complete alias list:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Canonical</p></th>
<th class="head text-left"><p>Aliases</p></th>
<th class="head text-left"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>brightness</p></td>
<td class="text-left"><p>bright</p></td>
<td class="text-left"><p>video</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>white_balance</p></td>
<td class="text-left"><p>wb, whitebalance</p></td>
<td class="text-left"><p>video</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>color_enable</p></td>
<td class="text-left"><p>color, colorenable</p></td>
<td class="text-left"><p>video</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>saturation</p></td>
<td class="text-left"><p>sat</p></td>
<td class="text-left"><p>video</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>zoom</p></td>
<td class="text-left"><p>z</p></td>
<td class="text-left"><p>camera</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>focus</p></td>
<td class="text-left"><p>f</p></td>
<td class="text-left"><p>camera</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>exposure</p></td>
<td class="text-left"><p>exp</p></td>
<td class="text-left"><p>camera</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>pan</p></td>
<td class="text-left"><p>horizontal</p></td>
<td class="text-left"><p>camera</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>tilt</p></td>
<td class="text-left"><p>vertical</p></td>
<td class="text-left"><p>camera</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="comprehensive-set-get-flow-example">
<h3>Comprehensive set/get flow example<a class="headerlink" href="#comprehensive-set-get-flow-example" title="Link to this heading">¶</a></h3>
<p><strong>Complete write flow</strong> (<code class="docutils literal notranslate"><span class="pre">cam.set('wb',</span> <span class="pre">5500,</span> <span class="pre">mode='manual')</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">1. User calls: cam.set(&#39;wb&#39;, 5500, mode=&#39;manual&#39;)
</span><span data-line="2">2. Normalize: prop_name = &#39;wb&#39;
</span><span data-line="3">3. Type check: value (5500) is int, not &#39;auto&#39; string
</span><span data-line="4">4. Lookup: &#39;wb&#39; in _VIDEO_PROPERTIES? Yes
</span><span data-line="5">5. Resolve: &#39;wb&#39; → VidProp.WhiteBalance (canonical: white_balance)
</span><span data-line="6">6. Parse mode: &#39;manual&#39; → CamMode.Manual
</span><span data-line="7">7. Validate: 5500 in device range [2700–6500]? Yes
</span><span data-line="8">8. Create: PropSetting(5500, CamMode.Manual)
</span><span data-line="9">9. Execute: self._core_camera.set(VidProp.WhiteBalance, PropSetting)
</span><span data-line="10">10. Result: Camera white balance set to 5500K
</span></pre></div>
</div>
<p><strong>Complete read flow</strong> (<code class="docutils literal notranslate"><span class="pre">is_color</span> <span class="pre">=</span> <span class="pre">cam.get('color')</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">1. User calls: is_color = cam.get(&#39;color&#39;)
</span><span data-line="2">2. Normalize: prop_name = &#39;color&#39;
</span><span data-line="3">3. Lookup: &#39;color&#39; in _VIDEO_PROPERTIES? Yes
</span><span data-line="4">4. Resolve: &#39;color&#39; → VidProp.ColorEnable (canonical: color_enable)
</span><span data-line="5">5. Fetch: device_value = self._core_camera.get(VidProp.ColorEnable)
</span><span data-line="6">6. Extract: value = device_value.value() = 1 (int)
</span><span data-line="7">7. Type convert: &#39;color_enable&#39; in _BOOLEAN_PROPERTIES? Yes
</span><span data-line="8">8. Convert: bool(1) = True
</span><span data-line="9">9. Return: is_color = True
</span></pre></div>
</div>
</section>
<section id="example-usage-patterns">
<h3>Example usage patterns<a class="headerlink" href="#example-usage-patterns" title="Link to this heading">¶</a></h3>
<p><strong>Scripting-friendly approach</strong> (all string-based):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>
</span><span data-line="3">    <span class="n">c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</span><span data-line="4">    <span class="n">c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="mi">5500</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>
</span><span data-line="5">    <span class="n">c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="n">brightness</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="8">    <span class="n">focus_mode</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">)</span>
</span><span data-line="9">    <span class="n">is_color</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Dynamic property management</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
</span><span data-line="3">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="4">    <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span data-line="5">    <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span><span data-line="6">    <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span>
</span><span data-line="7">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span data-line="8">    <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
</span><span data-line="9"><span class="p">}</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Apply all properties</span>
</span><span data-line="12"><span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="13">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="14">        <span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="15">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="16">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2"> not supported&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Conditional auto mode</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">enable_autofocus_if_supported</span><span class="p">(</span><span class="n">cam</span><span class="p">):</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Try to enable autofocus; fallback if unsupported.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</span><span data-line="5">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Autofocus enabled&quot;</span><span class="p">)</span>
</span><span data-line="6">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="7">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Autofocus not supported; using manual&quot;</span><span class="p">)</span>
</span><span data-line="8">        <span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  <span class="c1"># Set to midpoint</span>
</span></pre></div>
</div>
</section>
</section>
<section id="property-aliases-discovery">
<h2>3.10 Property Aliases &amp; Discovery<a class="headerlink" href="#property-aliases-discovery" title="Link to this heading">¶</a></h2>
<p>Property aliases provide user-friendly shortcuts for commonly-used properties. Discovery methods enable runtime inspection of supported properties, available ranges, and device capabilities.</p>
<section id="complete-property-alias-mapping">
<h3>Complete property alias mapping<a class="headerlink" href="#complete-property-alias-mapping" title="Link to this heading">¶</a></h3>
<p>All supported property aliases with their canonical names:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Video properties with aliases</span>
</span><span data-line="2"><span class="n">brightness</span>              <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">bright</span><span class="p">)</span>
</span><span data-line="3"><span class="n">white_balance</span>           <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">aliases</span><span class="p">:</span> <span class="n">wb</span><span class="p">,</span> <span class="n">whitebalance</span><span class="p">)</span>
</span><span data-line="4"><span class="n">color_enable</span>            <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">aliases</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="n">colorenable</span><span class="p">)</span>
</span><span data-line="5"><span class="n">saturation</span>              <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">sat</span><span class="p">)</span>
</span><span data-line="6"><span class="n">contrast</span>                <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="7"><span class="n">hue</span>                     <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="8"><span class="n">sharpness</span>               <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="9"><span class="n">gamma</span>                   <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="10"><span class="n">video_backlight_compensation</span>  <span class="err">→</span> <span class="n">canonical</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="11"><span class="n">gain</span>                    <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Camera properties with aliases</span>
</span><span data-line="14"><span class="n">pan</span>                     <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">horizontal</span><span class="p">)</span>
</span><span data-line="15"><span class="n">tilt</span>                    <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">vertical</span><span class="p">)</span>
</span><span data-line="16"><span class="n">zoom</span>                    <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">z</span><span class="p">)</span>
</span><span data-line="17"><span class="n">focus</span>                   <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">f</span><span class="p">)</span>
</span><span data-line="18"><span class="n">exposure</span>                <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">alias</span><span class="p">:</span> <span class="n">exp</span><span class="p">)</span>
</span><span data-line="19"><span class="n">roll</span>                    <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="20"><span class="n">iris</span>                    <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="21"><span class="n">scan_mode</span>               <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="22"><span class="n">privacy</span>                 <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="23"><span class="n">digital_zoom</span>            <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="24"><span class="n">backlight_compensation</span>  <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span><span data-line="25"><span class="n">lamp</span>                    <span class="err">→</span> <span class="n">canonical</span> <span class="n">name</span> <span class="p">(</span><span class="n">no</span> <span class="n">aliases</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-property-aliases-discovery-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_property_aliases()</span></code> discovery method<a class="headerlink" href="#get-property-aliases-discovery-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_property_aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get mapping of canonical property names to all aliases.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">aliases_map</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Video properties</span>
</span><span data-line="6">    <span class="k">for</span> <span class="n">alias</span><span class="p">,</span> <span class="n">enum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="7">        <span class="c1"># Find canonical name (one with longest name/most specific)</span>
</span><span data-line="8">        <span class="n">canonical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_canonical_for_enum</span><span class="p">(</span><span class="n">enum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">)</span>
</span><span data-line="9">        <span class="k">if</span> <span class="n">canonical</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">aliases_map</span><span class="p">:</span>
</span><span data-line="10">            <span class="n">aliases_map</span><span class="p">[</span><span class="n">canonical</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="11">        <span class="k">if</span> <span class="n">alias</span> <span class="o">!=</span> <span class="n">canonical</span><span class="p">:</span>
</span><span data-line="12">            <span class="n">aliases_map</span><span class="p">[</span><span class="n">canonical</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
</span><span data-line="13">    
</span><span data-line="14">    <span class="c1"># Camera properties</span>
</span><span data-line="15">    <span class="k">for</span> <span class="n">alias</span><span class="p">,</span> <span class="n">enum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="16">        <span class="n">canonical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_canonical_for_enum</span><span class="p">(</span><span class="n">enum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">)</span>
</span><span data-line="17">        <span class="k">if</span> <span class="n">canonical</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">aliases_map</span><span class="p">:</span>
</span><span data-line="18">            <span class="n">aliases_map</span><span class="p">[</span><span class="n">canonical</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="19">        <span class="k">if</span> <span class="n">alias</span> <span class="o">!=</span> <span class="n">canonical</span><span class="p">:</span>
</span><span data-line="20">            <span class="n">aliases_map</span><span class="p">[</span><span class="n">canonical</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
</span><span data-line="21">    
</span><span data-line="22">    <span class="k">return</span> <span class="n">aliases_map</span>
</span></pre></div>
</div>
<p>Returns mapping of canonical names to all aliases:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">aliases</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_aliases</span><span class="p">()</span>
</span><span data-line="2"><span class="c1"># Returns:</span>
</span><span data-line="3"><span class="c1"># {</span>
</span><span data-line="4"><span class="c1">#     &#39;brightness&#39;: [&#39;bright&#39;],</span>
</span><span data-line="5"><span class="c1">#     &#39;white_balance&#39;: [&#39;wb&#39;, &#39;whitebalance&#39;],</span>
</span><span data-line="6"><span class="c1">#     &#39;color_enable&#39;: [&#39;color&#39;, &#39;colorenable&#39;],</span>
</span><span data-line="7"><span class="c1">#     &#39;saturation&#39;: [&#39;sat&#39;],</span>
</span><span data-line="8"><span class="c1">#     &#39;zoom&#39;: [&#39;z&#39;],</span>
</span><span data-line="9"><span class="c1">#     &#39;focus&#39;: [&#39;f&#39;],</span>
</span><span data-line="10"><span class="c1">#     &#39;exposure&#39;: [&#39;exp&#39;],</span>
</span><span data-line="11"><span class="c1">#     &#39;pan&#39;: [&#39;horizontal&#39;],</span>
</span><span data-line="12"><span class="c1">#     &#39;tilt&#39;: [&#39;vertical&#39;],</span>
</span><span data-line="13"><span class="c1">#     ...</span>
</span><span data-line="14"><span class="c1"># }</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Access aliases for specific property</span>
</span><span data-line="17"><span class="n">bright_aliases</span> <span class="o">=</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;brightness&#39;</span><span class="p">]</span>  <span class="c1"># [&#39;bright&#39;]</span>
</span><span data-line="18"><span class="n">zoom_aliases</span> <span class="o">=</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">]</span>          <span class="c1"># [&#39;z&#39;]</span>
</span></pre></div>
</div>
</section>
<section id="list-properties-property-enumeration-method">
<h3><code class="docutils literal notranslate"><span class="pre">list_properties()</span></code> property enumeration method<a class="headerlink" href="#list-properties-property-enumeration-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">list_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;List all supported properties with types and descriptions.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">properties_info</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Video properties</span>
</span><span data-line="6">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span><span data-line="7">        <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">:</span>
</span><span data-line="8">            <span class="n">is_bool</span> <span class="o">=</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span>
</span><span data-line="9">            <span class="n">properties_info</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="10">                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;video&#39;</span><span class="p">,</span>
</span><span data-line="11">                <span class="s1">&#39;value_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="k">if</span> <span class="n">is_bool</span> <span class="k">else</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span>
</span><span data-line="12">                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property_description</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="13">            <span class="p">}</span>
</span><span data-line="14">    
</span><span data-line="15">    <span class="c1"># Camera properties</span>
</span><span data-line="16">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span><span data-line="17">        <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">:</span>
</span><span data-line="18">            <span class="n">is_bool</span> <span class="o">=</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span>
</span><span data-line="19">            <span class="n">properties_info</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="20">                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;camera&#39;</span><span class="p">,</span>
</span><span data-line="21">                <span class="s1">&#39;value_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="k">if</span> <span class="n">is_bool</span> <span class="k">else</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span>
</span><span data-line="22">                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property_description</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="23">            <span class="p">}</span>
</span><span data-line="24">    
</span><span data-line="25">    <span class="k">return</span> <span class="n">properties_info</span>
</span></pre></div>
</div>
<p>Returns sorted list of all supported properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">properties</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span>
</span><span data-line="2"><span class="c1"># Returns:</span>
</span><span data-line="3"><span class="c1"># {</span>
</span><span data-line="4"><span class="c1">#     &#39;brightness&#39;: {&#39;type&#39;: &#39;video&#39;, &#39;value_type&#39;: &#39;int&#39;, &#39;description&#39;: &#39;Image luminance...&#39;},</span>
</span><span data-line="5"><span class="c1">#     &#39;color_enable&#39;: {&#39;type&#39;: &#39;video&#39;, &#39;value_type&#39;: &#39;bool&#39;, &#39;description&#39;: &#39;Color vs monochrome...&#39;},</span>
</span><span data-line="6"><span class="c1">#     &#39;contrast&#39;: {&#39;type&#39;: &#39;video&#39;, &#39;value_type&#39;: &#39;int&#39;, &#39;description&#39;: &#39;Tonal range...&#39;},</span>
</span><span data-line="7"><span class="c1">#     ...</span>
</span><span data-line="8"><span class="c1">#     &#39;exposure&#39;: {&#39;type&#39;: &#39;camera&#39;, &#39;value_type&#39;: &#39;int&#39;, &#39;description&#39;: &#39;Exposure value...&#39;},</span>
</span><span data-line="9"><span class="c1">#     &#39;focus&#39;: {&#39;type&#39;: &#39;camera&#39;, &#39;value_type&#39;: &#39;int&#39;, &#39;description&#39;: &#39;Focus distance...&#39;},</span>
</span><span data-line="10"><span class="c1">#     &#39;pan&#39;: {&#39;type&#39;: &#39;camera&#39;, &#39;value_type&#39;: &#39;int&#39;, &#39;description&#39;: &#39;Horizontal rotation...&#39;},</span>
</span><span data-line="11"><span class="c1">#     ...</span>
</span><span data-line="12"><span class="c1"># }</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Check property type</span>
</span><span data-line="15"><span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="16">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;value_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-property-range-range-discovery-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_property_range()</span></code> range discovery method<a class="headerlink" href="#get-property-range-range-discovery-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_property_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get device-reported range for a property (min, max, step, default).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Resolve property name</span>
</span><span data-line="6">    <span class="n">prop_name</span> <span class="o">=</span> <span class="n">property_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="9">        <span class="c1"># Query device</span>
</span><span data-line="10">        <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span data-line="11">            <span class="n">enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_property_enum</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span><span class="p">)</span>
</span><span data-line="12">            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">get_range</span><span class="p">(</span><span class="n">enum</span><span class="p">)</span>
</span><span data-line="13">        <span class="k">elif</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span data-line="14">            <span class="n">enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_property_enum</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">)</span>
</span><span data-line="15">            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">get_range</span><span class="p">(</span><span class="n">enum</span><span class="p">)</span>
</span><span data-line="16">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="17">            <span class="k">return</span> <span class="kc">None</span>
</span><span data-line="18">        
</span><span data-line="19">        <span class="c1"># Extract range data</span>
</span><span data-line="20">        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span><span data-line="21">            <span class="k">return</span> <span class="p">{</span>
</span><span data-line="22">                <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">min</span><span class="p">,</span>
</span><span data-line="23">                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
</span><span data-line="24">                <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">step</span><span class="p">,</span>
</span><span data-line="25">                <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">default</span>
</span><span data-line="26">            <span class="p">}</span>
</span><span data-line="27">        <span class="k">return</span> <span class="kc">None</span>
</span><span data-line="28">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="29">        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>
</div>
<p>Returns device-reported range or None if unsupported:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Query brightness range</span>
</span><span data-line="2"><span class="n">bright_range</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="3"><span class="k">if</span> <span class="n">bright_range</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">bright_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">bright_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step: </span><span class="si">{</span><span class="n">bright_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Default: </span><span class="si">{</span><span class="n">bright_range</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="6">    <span class="c1"># Brightness: 0-255</span>
</span><span data-line="7">    <span class="c1"># Step: 1, Default: 128</span>
</span><span data-line="8"><span class="k">else</span><span class="p">:</span>
</span><span data-line="9">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Brightness unsupported on this device&quot;</span><span class="p">)</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Check multiple properties</span>
</span><span data-line="12"><span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="s1">&#39;tilt&#39;</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="s1">&#39;roll&#39;</span><span class="p">]:</span>
</span><span data-line="13">    <span class="n">prop_range</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
</span><span data-line="14">    <span class="k">if</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="15">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="16">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="17">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">: Not supported&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="property-capability-matrix-reference">
<h3>Property capability matrix reference<a class="headerlink" href="#property-capability-matrix-reference" title="Link to this heading">¶</a></h3>
<p>Complete reference of all properties, their aliases, types, and typical ranges:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Property</p></th>
<th class="head text-left"><p>Canonical</p></th>
<th class="head text-left"><p>Aliases</p></th>
<th class="head text-left"><p>Type</p></th>
<th class="head text-left"><p>Value Type</p></th>
<th class="head text-left"><p>Typical Range</p></th>
<th class="head text-left"><p>Supported On</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>brightness</p></td>
<td class="text-left"><p>brightness</p></td>
<td class="text-left"><p>bright</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–255 (device-specific)</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>contrast</p></td>
<td class="text-left"><p>contrast</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>saturation</p></td>
<td class="text-left"><p>saturation</p></td>
<td class="text-left"><p>sat</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>hue</p></td>
<td class="text-left"><p>hue</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>-180 to +180</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>sharpness</p></td>
<td class="text-left"><p>sharpness</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>gamma</p></td>
<td class="text-left"><p>gamma</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>100–300</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>color_enable</p></td>
<td class="text-left"><p>color_enable</p></td>
<td class="text-left"><p>color, colorenable</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>white_balance</p></td>
<td class="text-left"><p>white_balance</p></td>
<td class="text-left"><p>wb, whitebalance</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int/str</p></td>
<td class="text-left"><p>2700–6500K or ‘auto’</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>video_backlight_compensation</p></td>
<td class="text-left"><p>video_backlight_compensation</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>gain</p></td>
<td class="text-left"><p>gain</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>video</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>pan</p></td>
<td class="text-left"><p>pan</p></td>
<td class="text-left"><p>horizontal</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>-180 to +180°</p></td>
<td class="text-left"><p>PTZ/Pro cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>tilt</p></td>
<td class="text-left"><p>tilt</p></td>
<td class="text-left"><p>vertical</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>-90 to +90°</p></td>
<td class="text-left"><p>PTZ/Pro cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>roll</p></td>
<td class="text-left"><p>roll</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>-180 to +180°</p></td>
<td class="text-left"><p>Rare</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>zoom</p></td>
<td class="text-left"><p>zoom</p></td>
<td class="text-left"><p>z</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>100–1000</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>exposure</p></td>
<td class="text-left"><p>exposure</p></td>
<td class="text-left"><p>exp</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int/str</p></td>
<td class="text-left"><p>-13 to +1 EV or ‘auto’</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>iris</p></td>
<td class="text-left"><p>iris</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>focus</p></td>
<td class="text-left"><p>focus</p></td>
<td class="text-left"><p>f</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int/str</p></td>
<td class="text-left"><p>0–100 or ‘auto’</p></td>
<td class="text-left"><p>Most cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>scan_mode</p></td>
<td class="text-left"><p>scan_mode</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0 or 1</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>privacy</p></td>
<td class="text-left"><p>privacy</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>digital_zoom</p></td>
<td class="text-left"><p>digital_zoom</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>100–400</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>backlight_compensation</p></td>
<td class="text-left"><p>backlight_compensation</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>bool</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>Some cameras</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>lamp</p></td>
<td class="text-left"><p>lamp</p></td>
<td class="text-left"><p>—</p></td>
<td class="text-left"><p>camera</p></td>
<td class="text-left"><p>int</p></td>
<td class="text-left"><p>0–100</p></td>
<td class="text-left"><p>Rare</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="alias-discovery-and-usage-example">
<h3>Alias discovery and usage example<a class="headerlink" href="#alias-discovery-and-usage-example" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Discover all aliases at runtime</span>
</span><span data-line="2"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="3">    <span class="n">aliases</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_property_aliases</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Print all brightness aliases</span>
</span><span data-line="6">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Brightness aliases:&quot;</span><span class="p">,</span> <span class="n">aliases</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="p">[]))</span>
</span><span data-line="7">    <span class="c1"># Output: Brightness aliases: [&#39;bright&#39;]</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="c1"># Print all zoom aliases</span>
</span><span data-line="10">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Zoom aliases:&quot;</span><span class="p">,</span> <span class="n">aliases</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="p">[]))</span>
</span><span data-line="11">    <span class="c1"># Output: Zoom aliases: [&#39;z&#39;]</span>
</span><span data-line="12">    
</span><span data-line="13">    <span class="c1"># Use discovered aliases</span>
</span><span data-line="14">    <span class="k">for</span> <span class="n">canonical</span><span class="p">,</span> <span class="n">alias_list</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="15">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">canonical</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">alias_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="property-support-checking">
<h3>Property support checking<a class="headerlink" href="#property-support-checking" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">is_property_supported</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if camera supports a property.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="n">prop_range</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="5">        <span class="k">return</span> <span class="n">prop_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span data-line="6">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="7">        <span class="k">return</span> <span class="kc">False</span>
</span><span data-line="8">
</span><span data-line="9"><span class="k">def</span><span class="w"> </span><span class="nf">get_supported_properties</span><span class="p">(</span><span class="n">cam</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span data-line="10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get list of properties supported by this camera.&quot;&quot;&quot;</span>
</span><span data-line="11">    <span class="n">supported</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="12">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="n">cam</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span data-line="13">        <span class="k">if</span> <span class="n">is_property_supported</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">):</span>
</span><span data-line="14">            <span class="n">supported</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="15">    <span class="k">return</span> <span class="n">supported</span>
</span><span data-line="16">
</span><span data-line="17"><span class="c1"># Usage</span>
</span><span data-line="18"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="19">    <span class="k">if</span> <span class="n">is_property_supported</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">):</span>
</span><span data-line="20">        <span class="n">c</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="mi">150</span>
</span><span data-line="21">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="22">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera does not support zoom&quot;</span><span class="p">)</span>
</span><span data-line="23">    
</span><span data-line="24">    <span class="n">supported</span> <span class="o">=</span> <span class="n">get_supported_properties</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span data-line="25">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Supported properties:&quot;</span><span class="p">,</span> <span class="n">supported</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="discovery-driven-configuration">
<h3>Discovery-driven configuration<a class="headerlink" href="#discovery-driven-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">auto_configure_camera</span><span class="p">(</span><span class="n">cam</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Configure camera based on discovered capabilities.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="n">properties</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="c1"># Apply sensible defaults for supported properties</span>
</span><span data-line="8">    <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="9">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="10">            <span class="n">prop_range</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="11">            <span class="k">if</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="12">                <span class="c1"># Set to mid-range for numeric properties</span>
</span><span data-line="13">                <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;value_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
</span><span data-line="14">                    <span class="n">mid_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span>
</span><span data-line="15">                    <span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">mid_value</span><span class="p">)</span>
</span><span data-line="16">                    <span class="n">config</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mid_value</span>
</span><span data-line="17">                
</span><span data-line="18">                <span class="c1"># Set to False for boolean properties</span>
</span><span data-line="19">                <span class="k">elif</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;value_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bool&#39;</span><span class="p">:</span>
</span><span data-line="20">                    <span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span data-line="21">                    <span class="n">config</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="22">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="23">            <span class="k">pass</span>  <span class="c1"># Skip unsupported properties</span>
</span><span data-line="24">    
</span><span data-line="25">    <span class="k">return</span> <span class="n">config</span>
</span><span data-line="26">
</span><span data-line="27"><span class="c1"># Usage</span>
</span><span data-line="28"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="29">    <span class="n">config</span> <span class="o">=</span> <span class="n">auto_configure_camera</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span data-line="30">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Auto-configured properties:&quot;</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="alias-convenience-examples">
<h3>Alias convenience examples<a class="headerlink" href="#alias-convenience-examples" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Using full names</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;white_balance&#39;</span><span class="p">,</span> <span class="mi">5500</span><span class="p">)</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Using short aliases (equivalent)</span>
</span><span data-line="7"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>               <span class="c1"># Same as brightness</span>
</span><span data-line="8"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="mi">5500</span><span class="p">)</span>                 <span class="c1"># Same as white_balance</span>
</span><span data-line="9"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>           <span class="c1"># Same as pan</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Getting with aliases</span>
</span><span data-line="12"><span class="n">brightness</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bright&#39;</span><span class="p">)</span>      <span class="c1"># Resolves to &#39;brightness&#39;</span>
</span><span data-line="13"><span class="n">zoom</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>                 <span class="c1"># Resolves to &#39;zoom&#39;</span>
</span><span data-line="14"><span class="n">focus</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>                <span class="c1"># Resolves to &#39;focus&#39;</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Mixed usage</span>
</span><span data-line="17"><span class="n">cam</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="mi">0</span>                          <span class="c1"># Direct property</span>
</span><span data-line="18"><span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>           <span class="c1"># String API with alias</span>
</span><span data-line="19"><span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pan&#39;</span><span class="p">)</span>                      <span class="c1"># String API, canonical name</span>
</span><span data-line="20"><span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>               <span class="c1"># String API, alias (equivalent)</span>
</span></pre></div>
</div>
</section>
</section>
<section id="convenience-setter-methods">
<h2>3.11 Convenience Setter Methods<a class="headerlink" href="#convenience-setter-methods" title="Link to this heading">¶</a></h2>
<p>Convenience setter methods provide direct, IDE-friendly property assignment. All 32 setter methods accept optional mode parameter, perform automatic range validation, and raise descriptive exceptions with recovery suggestions.</p>
<section id="video-property-setters-10-methods">
<h3>Video property setters (10 methods)<a class="headerlink" href="#video-property-setters-10-methods" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set_brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set brightness with automatic range validation.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="4">
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">set_contrast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set contrast with automatic range validation.&quot;&quot;&quot;</span>
</span><span data-line="7">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="k">def</span><span class="w"> </span><span class="nf">set_saturation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set saturation with automatic range validation.&quot;&quot;&quot;</span>
</span><span data-line="11">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="k">def</span><span class="w"> </span><span class="nf">set_hue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="14"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set hue (color rotation) with automatic range validation.&quot;&quot;&quot;</span>
</span><span data-line="15">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;hue&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="16">
</span><span data-line="17"><span class="k">def</span><span class="w"> </span><span class="nf">set_sharpness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="18"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set sharpness with automatic range validation.&quot;&quot;&quot;</span>
</span><span data-line="19">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sharpness&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="k">def</span><span class="w"> </span><span class="nf">set_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="22"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set gamma (tone curve) with automatic range validation.&quot;&quot;&quot;</span>
</span><span data-line="23">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">set_color_enable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="26"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set color mode (True=color, False=monochrome).&quot;&quot;&quot;</span>
</span><span data-line="27">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="k">def</span><span class="w"> </span><span class="nf">set_white_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="30"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set white balance (Kelvin or &#39;auto&#39;).&quot;&quot;&quot;</span>
</span><span data-line="31">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;white_balance&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="k">def</span><span class="w"> </span><span class="nf">set_video_backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="34"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set video-level backlight compensation with validation.&quot;&quot;&quot;</span>
</span><span data-line="35">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;video_backlight_compensation&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="k">def</span><span class="w"> </span><span class="nf">set_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="38"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set sensor gain/amplification with validation.&quot;&quot;&quot;</span>
</span><span data-line="39">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;gain&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Usage examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>                          <span class="c1"># Set to 80 (manual mode)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_white_balance</span><span class="p">(</span><span class="mi">5500</span><span class="p">)</span>                     <span class="c1"># 5500K daylight</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set_white_balance</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>                   <span class="c1"># Auto white balance</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set_color_enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>                      <span class="c1"># Enable color</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">set_saturation</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;manual&#39;</span><span class="p">)</span>           <span class="c1"># Explicit mode parameter</span>
</span></pre></div>
</div>
</section>
<section id="camera-property-setters-11-methods">
<h3>Camera property setters (11 methods)<a class="headerlink" href="#camera-property-setters-11-methods" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set_pan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set pan (horizontal rotation) with range validation.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="4">
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">set_tilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set tilt (vertical rotation) with range validation.&quot;&quot;&quot;</span>
</span><span data-line="7">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;tilt&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="k">def</span><span class="w"> </span><span class="nf">set_roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set roll (optical axis rotation) with range validation.&quot;&quot;&quot;</span>
</span><span data-line="11">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;roll&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="k">def</span><span class="w"> </span><span class="nf">set_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="14"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set optical zoom (100=1x) with range validation.&quot;&quot;&quot;</span>
</span><span data-line="15">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="16">
</span><span data-line="17"><span class="k">def</span><span class="w"> </span><span class="nf">set_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="18"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set exposure (EV units or &#39;auto&#39;) with validation.&quot;&quot;&quot;</span>
</span><span data-line="19">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="k">def</span><span class="w"> </span><span class="nf">set_iris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="22"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set iris/aperture with range validation.&quot;&quot;&quot;</span>
</span><span data-line="23">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">set_focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="26"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set focus distance (0-100 or &#39;auto&#39;) with validation.&quot;&quot;&quot;</span>
</span><span data-line="27">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="k">def</span><span class="w"> </span><span class="nf">set_scan_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="30"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set scan mode (0=interlaced, 1=progressive).&quot;&quot;&quot;</span>
</span><span data-line="31">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;scan_mode&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="k">def</span><span class="w"> </span><span class="nf">set_privacy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="34"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set privacy shutter (True=closed, False=open).&quot;&quot;&quot;</span>
</span><span data-line="35">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="k">def</span><span class="w"> </span><span class="nf">set_digital_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="38"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set digital zoom (100=1x) with range validation.&quot;&quot;&quot;</span>
</span><span data-line="39">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;digital_zoom&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41"><span class="k">def</span><span class="w"> </span><span class="nf">set_backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="42"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set camera-level backlight compensation.&quot;&quot;&quot;</span>
</span><span data-line="43">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;backlight_compensation&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Usage examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cam</span><span class="o">.</span><span class="n">set_pan</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>                                 <span class="c1"># Pan 45° right</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_tilt</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>                              <span class="c1"># Tilt 30° down</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>                              <span class="c1"># 2x zoom</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set_focus</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>                          <span class="c1"># Autofocus</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">set_exposure</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>                           <span class="c1"># Darken by 2 EV</span>
</span><span data-line="6"><span class="n">cam</span><span class="o">.</span><span class="n">set_privacy</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                         <span class="c1"># Open privacy shutter</span>
</span></pre></div>
</div>
</section>
<section id="automatic-range-validation-and-error-handling">
<h3>Automatic range validation and error handling<a class="headerlink" href="#automatic-range-validation-and-error-handling" title="Link to this heading">¶</a></h3>
<p>All setter methods automatically validate values against device-reported ranges:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Universal setter with automatic validation and error context.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="c1"># Resolve property</span>
</span><span data-line="5">        <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="6">        
</span><span data-line="7">        <span class="c1"># Validate range</span>
</span><span data-line="8">        <span class="k">if</span> <span class="n">prop_range</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="9">            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
</span><span data-line="10">                <span class="k">raise</span> <span class="n">InvalidValueError</span><span class="p">(</span>
</span><span data-line="11">                    <span class="sa">f</span><span class="s2">&quot;Value </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> out of range for &#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span data-line="12">                    <span class="sa">f</span><span class="s2">&quot;Valid range: </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span data-line="13">                    <span class="sa">f</span><span class="s2">&quot;(step: </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">). &quot;</span>
</span><span data-line="14">                    <span class="sa">f</span><span class="s2">&quot;Clamp value to valid range or query device capabilities.&quot;</span>
</span><span data-line="15">                <span class="p">)</span>
</span><span data-line="16">        
</span><span data-line="17">        <span class="c1"># Apply setting</span>
</span><span data-line="18">        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_property_setting</span><span class="p">(</span><span class="n">property_name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</span><span data-line="19">        
</span><span data-line="20">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="21">        <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span>
</span><span data-line="22">            <span class="sa">f</span><span class="s2">&quot;Property &#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39; not supported on this camera. &quot;</span>
</span><span data-line="23">            <span class="sa">f</span><span class="s2">&quot;Supported properties: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span data-line="24">            <span class="sa">f</span><span class="s2">&quot;Query device capabilities with: cam.get_property_range(&#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
</span><span data-line="25">        <span class="p">)</span>
</span><span data-line="26">    <span class="k">except</span> <span class="n">InvalidValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="27">        <span class="k">raise</span> <span class="n">InvalidValueError</span><span class="p">(</span>
</span><span data-line="28">            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span data-line="29">            <span class="sa">f</span><span class="s2">&quot;Current value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span data-line="30">            <span class="sa">f</span><span class="s2">&quot;Try: cam.set_brightness(</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) or higher.&quot;</span>
</span><span data-line="31">        <span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Error messages with context and recovery suggestions:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Example: Out-of-range value</span>
</span><span data-line="2"><span class="k">try</span><span class="p">:</span>
</span><span data-line="3">    <span class="n">cam</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</span><span data-line="4"><span class="k">except</span> <span class="n">InvalidValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span data-line="6">    <span class="c1"># Output: &quot;Value 500 out of range for &#39;brightness&#39;. Valid range: 0–255 </span>
</span><span data-line="7">    <span class="c1"># (step: 1). Clamp value to valid range or query device capabilities.&quot;</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Example: Unsupported property</span>
</span><span data-line="10"><span class="k">try</span><span class="p">:</span>
</span><span data-line="11">    <span class="n">cam</span><span class="o">.</span><span class="n">set_roll</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># Unsupported on most cameras</span>
</span><span data-line="12"><span class="k">except</span> <span class="n">PropertyNotSupportedError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="13">    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span data-line="14">    <span class="c1"># Output: &quot;Property &#39;roll&#39; not supported on this camera. </span>
</span><span data-line="15">    <span class="c1"># Supported properties: [&#39;brightness&#39;, &#39;pan&#39;, &#39;zoom&#39;, ...]. </span>
</span><span data-line="16">    <span class="c1"># Query device capabilities with: cam.get_property_range(&#39;roll&#39;)&quot;</span>
</span></pre></div>
</div>
</section>
<section id="exception-recovery-suggestion-algorithms">
<h3>Exception recovery suggestion algorithms<a class="headerlink" href="#exception-recovery-suggestion-algorithms" title="Link to this heading">¶</a></h3>
<p>Smart error recovery:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_suggest_recovery_for_invalid_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate recovery suggestion for out-of-range value.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="4">    <span class="k">if</span> <span class="ow">not</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="5">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Property &#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39; may be unsupported. Query: cam.get_property_range(&#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="c1"># Suggest clamping</span>
</span><span data-line="8">    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]:</span>
</span><span data-line="9">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Value too low. Use </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (minimum).&quot;</span>
</span><span data-line="10">    <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
</span><span data-line="11">        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Value too high. Use </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (maximum).&quot;</span>
</span><span data-line="12">    
</span><span data-line="13">    <span class="c1"># Suggest midpoint</span>
</span><span data-line="14">    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span>
</span><span data-line="15">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Use </span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2"> (midpoint) or value within </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span data-line="16">
</span><span data-line="17"><span class="c1"># Example usage</span>
</span><span data-line="18"><span class="k">try</span><span class="p">:</span>
</span><span data-line="19">    <span class="n">cam</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</span><span data-line="20"><span class="k">except</span> <span class="n">InvalidValueError</span><span class="p">:</span>
</span><span data-line="21">    <span class="n">recovery</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">_suggest_recovery_for_invalid_value</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span data-line="22">    <span class="nb">print</span><span class="p">(</span><span class="n">recovery</span><span class="p">)</span>  <span class="c1"># &quot;Value too high. Use 255 (maximum).&quot;</span>
</span></pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="convenience-getter-methods">
<h2>3.12 Convenience Getter Methods<a class="headerlink" href="#convenience-getter-methods" title="Link to this heading">¶</a></h2>
<p>Convenience getter methods provide direct property access with automatic type conversion. All 32 getter methods return validated values within device-reported ranges.</p>
<section id="video-property-getters-10-methods">
<h3>Video property getters (10 methods)<a class="headerlink" href="#video-property-getters-10-methods" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get brightness value (device-specific range).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="4">
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">get_contrast</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get contrast value.&quot;&quot;&quot;</span>
</span><span data-line="7">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contrast&#39;</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="k">def</span><span class="w"> </span><span class="nf">get_saturation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get saturation value.&quot;&quot;&quot;</span>
</span><span data-line="11">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;saturation&#39;</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="k">def</span><span class="w"> </span><span class="nf">get_hue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="14"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get hue value (color rotation in degrees).&quot;&quot;&quot;</span>
</span><span data-line="15">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hue&#39;</span><span class="p">)</span>
</span><span data-line="16">
</span><span data-line="17"><span class="k">def</span><span class="w"> </span><span class="nf">get_sharpness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="18"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get sharpness value.&quot;&quot;&quot;</span>
</span><span data-line="19">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sharpness&#39;</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="k">def</span><span class="w"> </span><span class="nf">get_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="22"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get gamma value (value ÷ 100 = gamma).&quot;&quot;&quot;</span>
</span><span data-line="23">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">get_color_enable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="26"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get color mode (True=color, False=monochrome).&quot;&quot;&quot;</span>
</span><span data-line="27">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="k">def</span><span class="w"> </span><span class="nf">get_white_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="30"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get white balance (Kelvin value).&quot;&quot;&quot;</span>
</span><span data-line="31">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;white_balance&#39;</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="k">def</span><span class="w"> </span><span class="nf">get_video_backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="34"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get video backlight compensation level.&quot;&quot;&quot;</span>
</span><span data-line="35">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;video_backlight_compensation&#39;</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="k">def</span><span class="w"> </span><span class="nf">get_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="38"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get sensor gain/amplification level.&quot;&quot;&quot;</span>
</span><span data-line="39">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gain&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Usage examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">brightness</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_brightness</span><span class="p">()</span>              <span class="c1"># Returns int (device-specific)</span>
</span><span data-line="2"><span class="n">is_color</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_color_enable</span><span class="p">()</span>              <span class="c1"># Returns bool</span>
</span><span data-line="3"><span class="n">wb</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_white_balance</span><span class="p">()</span>                   <span class="c1"># Returns int (Kelvin)</span>
</span></pre></div>
</div>
</section>
<section id="camera-property-getters-11-methods">
<h3>Camera property getters (11 methods)<a class="headerlink" href="#camera-property-getters-11-methods" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_pan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get pan angle (degrees, device-specific range).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pan&#39;</span><span class="p">)</span>
</span><span data-line="4">
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">get_tilt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get tilt angle (degrees, device-specific range).&quot;&quot;&quot;</span>
</span><span data-line="7">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tilt&#39;</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="k">def</span><span class="w"> </span><span class="nf">get_roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get roll angle (degrees).&quot;&quot;&quot;</span>
</span><span data-line="11">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;roll&#39;</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="k">def</span><span class="w"> </span><span class="nf">get_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="14"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get optical zoom (100=1x, device-specific range).&quot;&quot;&quot;</span>
</span><span data-line="15">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zoom&#39;</span><span class="p">)</span>
</span><span data-line="16">
</span><span data-line="17"><span class="k">def</span><span class="w"> </span><span class="nf">get_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="18"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get exposure value (EV units, device-specific).&quot;&quot;&quot;</span>
</span><span data-line="19">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exposure&#39;</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="k">def</span><span class="w"> </span><span class="nf">get_iris</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="22"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get iris/aperture value.&quot;&quot;&quot;</span>
</span><span data-line="23">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">get_focus</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="26"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get focus distance (0-100, or 0 if autofocus active).&quot;&quot;&quot;</span>
</span><span data-line="27">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="k">def</span><span class="w"> </span><span class="nf">get_scan_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="30"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get scan mode (0=interlaced, 1=progressive).&quot;&quot;&quot;</span>
</span><span data-line="31">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scan_mode&#39;</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="k">def</span><span class="w"> </span><span class="nf">get_privacy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="34"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get privacy shutter state (True=closed, False=open).&quot;&quot;&quot;</span>
</span><span data-line="35">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="k">def</span><span class="w"> </span><span class="nf">get_digital_zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="38"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get digital zoom (100=1x, device-specific range).&quot;&quot;&quot;</span>
</span><span data-line="39">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;digital_zoom&#39;</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41"><span class="k">def</span><span class="w"> </span><span class="nf">get_backlight_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="42"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get camera-level backlight compensation state.&quot;&quot;&quot;</span>
</span><span data-line="43">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;backlight_compensation&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Usage examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">pan</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_pan</span><span class="p">()</span>                            <span class="c1"># Returns int</span>
</span><span data-line="2"><span class="n">zoom</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_zoom</span><span class="p">()</span>                          <span class="c1"># Returns int (100–1000+)</span>
</span><span data-line="3"><span class="n">privacy_on</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_privacy</span><span class="p">()</span>                 <span class="c1"># Returns bool</span>
</span><span data-line="4"><span class="n">is_progressive</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_scan_mode</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>     <span class="c1"># Returns bool</span>
</span></pre></div>
</div>
</section>
<section id="range-checked-values-and-device-specific-returns">
<h3>Range-checked values and device-specific returns<a class="headerlink" href="#range-checked-values-and-device-specific-returns" title="Link to this heading">¶</a></h3>
<p>All getters return values <strong>guaranteed to be within device range</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get property with automatic validation.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="6">        <span class="c1"># Fetch raw value</span>
</span><span data-line="7">        <span class="n">raw_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_property_from_device</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="8">        
</span><span data-line="9">        <span class="c1"># Validate against device range</span>
</span><span data-line="10">        <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="11">        <span class="k">if</span> <span class="n">prop_range</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="12">            <span class="k">if</span> <span class="n">raw_value</span> <span class="o">&lt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">raw_value</span> <span class="o">&gt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
</span><span data-line="13">                <span class="c1"># Log warning but still return (device may report stale value)</span>
</span><span data-line="14">                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span data-line="15">                    <span class="sa">f</span><span class="s2">&quot;Device reported </span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">raw_value</span><span class="si">}</span><span class="s2"> outside range &quot;</span>
</span><span data-line="16">                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
</span><span data-line="17">                    <span class="sa">f</span><span class="s2">&quot;Clamping to valid range.&quot;</span>
</span><span data-line="18">                <span class="p">)</span>
</span><span data-line="19">                <span class="n">raw_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span> <span class="n">raw_value</span><span class="p">))</span>
</span><span data-line="20">        
</span><span data-line="21">        <span class="c1"># Auto type conversion for bool properties</span>
</span><span data-line="22">        <span class="k">if</span> <span class="n">property_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span><span class="p">:</span>
</span><span data-line="23">            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">raw_value</span><span class="p">)</span>
</span><span data-line="24">        
</span><span data-line="25">        <span class="k">return</span> <span class="n">raw_value</span>
</span><span data-line="26">        
</span><span data-line="27">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="28">        <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span>
</span><span data-line="29">            <span class="sa">f</span><span class="s2">&quot;Cannot read property &#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span data-line="30">            <span class="sa">f</span><span class="s2">&quot;Property may be unsupported on this device.&quot;</span>
</span><span data-line="31">        <span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="device-specific-return-values-actual-values-returned">
<h3>Device-specific return values (actual values returned)<a class="headerlink" href="#device-specific-return-values-actual-values-returned" title="Link to this heading">¶</a></h3>
<p>Different devices return different value ranges for same property:</p>
<p><strong>Brightness example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Logitech C920 camera</span>
</span><span data-line="2"><span class="n">brightness</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_brightness</span><span class="p">()</span>  <span class="c1"># Returns 0–255 (device-specific)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Generic UVC camera</span>
</span><span data-line="5"><span class="n">brightness</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_brightness</span><span class="p">()</span>  <span class="c1"># Returns 0–100 (device-specific)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Both calls work; values are device-normalized</span>
</span></pre></div>
</div>
<p><strong>Pan example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># PTZ camera supports full rotation</span>
</span><span data-line="2"><span class="n">pan</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_pan</span><span class="p">()</span>  <span class="c1"># Returns -180 to +180 (device range)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Fixed USB camera with limited pan</span>
</span><span data-line="5"><span class="n">pan</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_pan</span><span class="p">()</span>  <span class="c1"># Returns 0 (center, or unsupported)</span>
</span></pre></div>
</div>
</section>
<section id="comparison-and-usage-patterns">
<h3>Comparison and usage patterns<a class="headerlink" href="#comparison-and-usage-patterns" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Check current state</span>
</span><span data-line="2"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="3">    <span class="c1"># Read all video properties</span>
</span><span data-line="4">    <span class="n">brightness</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_brightness</span><span class="p">()</span>
</span><span data-line="5">    <span class="n">contrast</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_contrast</span><span class="p">()</span>
</span><span data-line="6">    <span class="n">saturation</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_saturation</span><span class="p">()</span>
</span><span data-line="7">    <span class="n">is_color</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_color_enable</span><span class="p">()</span>
</span><span data-line="8">    <span class="n">wb_kelvin</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_white_balance</span><span class="p">()</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="c1"># Read all camera position/zoom</span>
</span><span data-line="11">    <span class="n">pan_angle</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_pan</span><span class="p">()</span>
</span><span data-line="12">    <span class="n">tilt_angle</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_tilt</span><span class="p">()</span>
</span><span data-line="13">    <span class="n">zoom_level</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_zoom</span><span class="p">()</span>  <span class="c1"># 100=1x</span>
</span><span data-line="14">    
</span><span data-line="15">    <span class="c1"># Conditional logic based on returned values</span>
</span><span data-line="16">    <span class="k">if</span> <span class="n">zoom_level</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
</span><span data-line="17">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zoomed in </span><span class="si">{</span><span class="n">zoom_level</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">100</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
</span><span data-line="18">    
</span><span data-line="19">    <span class="k">if</span> <span class="n">is_color</span><span class="p">:</span>
</span><span data-line="20">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Color mode enabled&quot;</span><span class="p">)</span>
</span><span data-line="21">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="22">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Monochrome mode&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="batch-getter-pattern">
<h3>Batch getter pattern<a class="headerlink" href="#batch-getter-pattern" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_all_properties</span><span class="p">(</span><span class="n">cam</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all supported properties at once.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">all_props</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="c1"># Video properties</span>
</span><span data-line="6">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="s1">&#39;saturation&#39;</span><span class="p">,</span> <span class="s1">&#39;hue&#39;</span><span class="p">,</span> 
</span><span data-line="7">                      <span class="s1">&#39;sharpness&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;white_balance&#39;</span><span class="p">,</span> <span class="s1">&#39;gain&#39;</span><span class="p">]:</span>
</span><span data-line="8">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="9">            <span class="n">all_props</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="10">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="11">            <span class="n">all_props</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Unsupported</span>
</span><span data-line="12">    
</span><span data-line="13">    <span class="c1"># Camera properties</span>
</span><span data-line="14">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="s1">&#39;tilt&#39;</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="s1">&#39;exposure&#39;</span><span class="p">,</span> <span class="s1">&#39;focus&#39;</span><span class="p">,</span>
</span><span data-line="15">                      <span class="s1">&#39;iris&#39;</span><span class="p">,</span> <span class="s1">&#39;scan_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;privacy&#39;</span><span class="p">,</span> <span class="s1">&#39;digital_zoom&#39;</span><span class="p">]:</span>
</span><span data-line="16">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="17">            <span class="n">all_props</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="18">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="19">            <span class="n">all_props</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="20">    
</span><span data-line="21">    <span class="k">return</span> <span class="n">all_props</span>
</span><span data-line="22">
</span><span data-line="23"><span class="c1"># Usage</span>
</span><span data-line="24"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="25">    <span class="n">state</span> <span class="o">=</span> <span class="n">get_all_properties</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span data-line="26">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current camera state:&quot;</span><span class="p">)</span>
</span><span data-line="27">    <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="28">        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="29">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="error-handling-on-get-operations">
<h3>Error handling on get operations<a class="headerlink" href="#error-handling-on-get-operations" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">safe_get</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get property value with graceful fallback.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="k">return</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="5">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="6">        <span class="k">return</span> <span class="n">default</span>
</span><span data-line="7">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="8">        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to read </span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="9">        <span class="k">return</span> <span class="n">default</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Usage</span>
</span><span data-line="12"><span class="n">brightness</span> <span class="o">=</span> <span class="n">safe_get</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</span><span data-line="13"><span class="n">pan</span> <span class="o">=</span> <span class="n">safe_get</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
</section>
<section id="validation-safe-operations">
<h2>3.13 Validation &amp; Safe Operations<a class="headerlink" href="#validation-safe-operations" title="Link to this heading">¶</a></h2>
<p>Explicit validation methods protect against invalid values before device operations. Validation reports rich context via <code class="docutils literal notranslate"><span class="pre">PropertyValueOutOfRangeError</span></code> exception with structured attributes. Recovery suggestions enable safe error handling and device-specific range queries.</p>
<section id="set-with-validation-explicit-validation-method">
<h3><code class="docutils literal notranslate"><span class="pre">set_with_validation()</span></code> explicit validation method<a class="headerlink" href="#set-with-validation-explicit-validation-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set_with_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> 
</span><span data-line="2">                       <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set property with explicit validation and detailed error reporting.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="5">    
</span><span data-line="6">    <span class="c1"># Resolve property</span>
</span><span data-line="7">    <span class="n">prop_name</span> <span class="o">=</span> <span class="n">property_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="c1"># Check type compatibility</span>
</span><span data-line="10">    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_value_type</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span data-line="11">        <span class="k">raise</span> <span class="n">PropertyTypeError</span><span class="p">(</span>
</span><span data-line="12">            <span class="sa">f</span><span class="s2">&quot;Value type mismatch for &#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span data-line="13">            <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_expected_type</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span data-line="14">            <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span data-line="15">        <span class="p">)</span>
</span><span data-line="16">    
</span><span data-line="17">    <span class="c1"># Get device-reported range</span>
</span><span data-line="18">    <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="19">    <span class="k">if</span> <span class="ow">not</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="20">        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span data-line="21">            <span class="sa">f</span><span class="s2">&quot;Property &#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39; range unavailable; &quot;</span>
</span><span data-line="22">            <span class="sa">f</span><span class="s2">&quot;device may not support this property.&quot;</span>
</span><span data-line="23">        <span class="p">)</span>
</span><span data-line="24">    
</span><span data-line="25">    <span class="c1"># Validate range for numeric values</span>
</span><span data-line="26">    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="27">        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
</span><span data-line="28">            <span class="n">current_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="29">            <span class="k">raise</span> <span class="n">PropertyValueOutOfRangeError</span><span class="p">(</span>
</span><span data-line="30">                <span class="n">property_name</span><span class="o">=</span><span class="n">prop_name</span><span class="p">,</span>
</span><span data-line="31">                <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
</span><span data-line="32">                <span class="n">min_val</span><span class="o">=</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
</span><span data-line="33">                <span class="n">max_val</span><span class="o">=</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
</span><span data-line="34">                <span class="n">step</span><span class="o">=</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">],</span>
</span><span data-line="35">                <span class="n">current_val</span><span class="o">=</span><span class="n">current_val</span><span class="p">,</span>
</span><span data-line="36">                <span class="n">message</span><span class="o">=</span><span class="p">(</span>
</span><span data-line="37">                    <span class="sa">f</span><span class="s2">&quot;Value </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> out of range for &#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span data-line="38">                    <span class="sa">f</span><span class="s2">&quot;Valid range: </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span data-line="39">                    <span class="sa">f</span><span class="s2">&quot;(step: </span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span data-line="40">                <span class="p">)</span>
</span><span data-line="41">            <span class="p">)</span>
</span><span data-line="42">    
</span><span data-line="43">    <span class="c1"># Apply setting</span>
</span><span data-line="44">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span data-line="45">    
</span><span data-line="46">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="47">        <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="n">prop_name</span><span class="p">,</span>
</span><span data-line="48">        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
</span><span data-line="49">        <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
</span><span data-line="50">        <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span>
</span><span data-line="51">    <span class="p">}</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
</span><span data-line="3">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Brightness set successfully&quot;</span><span class="p">)</span>
</span><span data-line="4"><span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="6">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Property: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="7">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Attempted: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">, Valid: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">min_val</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">max_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="8">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">current_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="propertyvalueoutofrangeerror-exception-with-rich-attributes">
<h3><code class="docutils literal notranslate"><span class="pre">PropertyValueOutOfRangeError</span></code> exception with rich attributes<a class="headerlink" href="#propertyvalueoutofrangeerror-exception-with-rich-attributes" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">class</span><span class="w"> </span><span class="nc">PropertyValueOutOfRangeError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when property value is outside device-reported range.&quot;&quot;&quot;</span>
</span><span data-line="3">    
</span><span data-line="4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">min_val</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">max_val</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span data-line="5">                 <span class="n">step</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_val</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span data-line="6">        <span class="bp">self</span><span class="o">.</span><span class="n">property_name</span> <span class="o">=</span> <span class="n">property_name</span>
</span><span data-line="7">        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span data-line="8">        <span class="bp">self</span><span class="o">.</span><span class="n">min_val</span> <span class="o">=</span> <span class="n">min_val</span>
</span><span data-line="9">        <span class="bp">self</span><span class="o">.</span><span class="n">max_val</span> <span class="o">=</span> <span class="n">max_val</span>
</span><span data-line="10">        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
</span><span data-line="11">        <span class="bp">self</span><span class="o">.</span><span class="n">current_val</span> <span class="o">=</span> <span class="n">current_val</span>
</span><span data-line="12">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Exception attributes for programmatic error handling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">try</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</span><span data-line="3"><span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="4">    <span class="c1"># Access structured error data</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Property: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>      <span class="c1"># &#39;brightness&#39;</span>
</span><span data-line="6">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempted value: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>       <span class="c1"># 500</span>
</span><span data-line="7">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valid range: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">min_val</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">max_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 0–255</span>
</span><span data-line="8">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step size: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">step</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>              <span class="c1"># 1</span>
</span><span data-line="9">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current value: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">current_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>   <span class="c1"># 128</span>
</span></pre></div>
</div>
</section>
<section id="automatic-range-checking-via-get-dynamic-range">
<h3>Automatic range checking via <code class="docutils literal notranslate"><span class="pre">_get_dynamic_range()</span></code><a class="headerlink" href="#automatic-range-checking-via-get-dynamic-range" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_get_dynamic_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fallback_min</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
</span><span data-line="2">                      <span class="n">fallback_max</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query device range with automatic fallback to constants.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="5">        <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="6">        <span class="k">if</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="7">            <span class="k">return</span> <span class="p">(</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
</span><span data-line="8">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="9">        <span class="k">pass</span>
</span><span data-line="10">    
</span><span data-line="11">    <span class="c1"># Fallback to class constants</span>
</span><span data-line="12">    <span class="k">return</span> <span class="p">(</span><span class="n">fallback_min</span><span class="p">,</span> <span class="n">fallback_max</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Automatic behavior in setters</span>
</span><span data-line="15"><span class="k">def</span><span class="w"> </span><span class="nf">set_brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="16">    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_range</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span data-line="17">    
</span><span data-line="18">    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">min_val</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
</span><span data-line="19">        <span class="k">raise</span> <span class="n">PropertyValueOutOfRangeError</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span data-line="20">    
</span><span data-line="21">    <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="type-validation-for-int-vs-bool">
<h3>Type validation for int vs bool<a class="headerlink" href="#type-validation-for-int-vs-bool" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_validate_value_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate value matches property type (int or bool).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">is_bool_prop</span> <span class="o">=</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">if</span> <span class="n">is_bool_prop</span><span class="p">:</span>
</span><span data-line="6">        <span class="c1"># Bool properties accept bool or int (0/1)</span>
</span><span data-line="7">        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span data-line="8">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="9">        <span class="c1"># Numeric properties accept int or str (for auto mode)</span>
</span><span data-line="10">        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
</span><span data-line="11">
</span><span data-line="12"><span class="k">def</span><span class="w"> </span><span class="nf">_get_expected_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
</span><span data-line="13"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return expected Python type for property.&quot;&quot;&quot;</span>
</span><span data-line="14">    <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span><span class="p">:</span>
</span><span data-line="15">        <span class="k">return</span> <span class="nb">bool</span>
</span><span data-line="16">    <span class="k">elif</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VIDEO_PROPERTIES</span> <span class="ow">or</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAMERA_PROPERTIES</span><span class="p">:</span>
</span><span data-line="17">        <span class="k">return</span> <span class="nb">int</span>
</span><span data-line="18">    <span class="k">return</span> <span class="nb">object</span>
</span></pre></div>
</div>
<p>Type validation examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Valid: bool property with bool value</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># OK</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Valid: bool property with int value (0 or 1)</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;privacy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># OK</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Invalid: bool property with invalid int</span>
</span><span data-line="8"><span class="k">try</span><span class="p">:</span>
</span><span data-line="9">    <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;color_enable&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span data-line="10"><span class="k">except</span> <span class="n">PropertyTypeError</span><span class="p">:</span>
</span><span data-line="11">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bool property only accepts 0/1 or True/False&quot;</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Valid: numeric property with int</span>
</span><span data-line="14"><span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>  <span class="c1"># OK</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Valid: auto mode with string</span>
</span><span data-line="17"><span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>  <span class="c1"># OK</span>
</span><span data-line="18">
</span><span data-line="19"><span class="c1"># Invalid: numeric property with float</span>
</span><span data-line="20"><span class="k">try</span><span class="p">:</span>
</span><span data-line="21">    <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mf">80.5</span><span class="p">)</span>
</span><span data-line="22"><span class="k">except</span> <span class="n">PropertyTypeError</span><span class="p">:</span>
</span><span data-line="23">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Property only accepts int&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="device-specific-range-queries">
<h3>Device-specific range queries<a class="headerlink" href="#device-specific-range-queries" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">query_device_ranges</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">properties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query device for supported ranges on multiple properties.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">ranges</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
</span><span data-line="6">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="7">            <span class="n">prop_range</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="8">            <span class="k">if</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="9">                <span class="n">ranges</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="10">                    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
</span><span data-line="11">                    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
</span><span data-line="12">                    <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">],</span>
</span><span data-line="13">                    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span>
</span><span data-line="14">                    <span class="s1">&#39;supported&#39;</span><span class="p">:</span> <span class="kc">True</span>
</span><span data-line="15">                <span class="p">}</span>
</span><span data-line="16">            <span class="k">else</span><span class="p">:</span>
</span><span data-line="17">                <span class="n">ranges</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;supported&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span data-line="18">        <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="19">            <span class="n">ranges</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;supported&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span data-line="20">    
</span><span data-line="21">    <span class="k">return</span> <span class="n">ranges</span>
</span><span data-line="22">
</span><span data-line="23"><span class="c1"># Usage</span>
</span><span data-line="24"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="25">    <span class="n">video_props</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="s1">&#39;saturation&#39;</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">]</span>
</span><span data-line="26">    <span class="n">ranges</span> <span class="o">=</span> <span class="n">query_device_ranges</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">video_props</span><span class="p">)</span>
</span><span data-line="27">    
</span><span data-line="28">    <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">ranges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="29">        <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;supported&#39;</span><span class="p">]:</span>
</span><span data-line="30">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span data-line="31">                  <span class="sa">f</span><span class="s2">&quot;(step: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, default: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="32">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="33">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">: Not supported&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-setting-info-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_setting_info()</span></code> method<a class="headerlink" href="#get-setting-info-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_setting_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current value, mode, and range for a property.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="n">prop_name</span> <span class="o">=</span> <span class="n">property_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="8">        <span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="9">        <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="10">        
</span><span data-line="11">        <span class="c1"># Determine current mode (device-specific)</span>
</span><span data-line="12">        <span class="n">current_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property_mode</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="13">        
</span><span data-line="14">        <span class="k">return</span> <span class="p">{</span>
</span><span data-line="15">            <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="n">prop_name</span><span class="p">,</span>
</span><span data-line="16">            <span class="s1">&#39;current_value&#39;</span><span class="p">:</span> <span class="n">current_value</span><span class="p">,</span>
</span><span data-line="17">            <span class="s1">&#39;current_mode&#39;</span><span class="p">:</span> <span class="n">current_mode</span><span class="p">,</span>
</span><span data-line="18">            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="19">                <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">prop_range</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="20">                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">prop_range</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="21">                <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">prop_range</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="22">                <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">prop_range</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="23">            <span class="p">},</span>
</span><span data-line="24">            <span class="s1">&#39;supported&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="25">            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="k">if</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_BOOLEAN_PROPERTIES</span> <span class="k">else</span> <span class="s1">&#39;int&#39;</span>
</span><span data-line="26">        <span class="p">}</span>
</span><span data-line="27">    <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="28">        <span class="k">return</span> <span class="p">{</span>
</span><span data-line="29">            <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="n">prop_name</span><span class="p">,</span>
</span><span data-line="30">            <span class="s1">&#39;supported&#39;</span><span class="p">:</span> <span class="kc">False</span>
</span><span data-line="31">        <span class="p">}</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">with</span> <span class="n">cam</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
</span><span data-line="2">    <span class="c1"># Inspect brightness</span>
</span><span data-line="3">    <span class="n">info</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_setting_info</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;current_value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mode: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;current_mode&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="6">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Range: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="7">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">][</span><span class="s1">&#39;step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="8">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Default: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="c1"># Output:</span>
</span><span data-line="11">    <span class="c1"># Brightness: 128</span>
</span><span data-line="12">    <span class="c1"># Mode: manual</span>
</span><span data-line="13">    <span class="c1"># Range: 0–255</span>
</span><span data-line="14">    <span class="c1"># Step: 1</span>
</span><span data-line="15">    <span class="c1"># Default: 128</span>
</span></pre></div>
</div>
</section>
<section id="id2">
<h3>Exception recovery suggestion algorithms<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Smart recovery suggestions based on error context:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_suggest_recovery_for_range_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">PropertyValueOutOfRangeError</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate recovery suggestion for out-of-range value.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">prop</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">property_name</span>
</span><span data-line="4">    <span class="n">value</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="5">    <span class="n">min_val</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">min_val</span>
</span><span data-line="6">    <span class="n">max_val</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">max_val</span>
</span><span data-line="7">    <span class="n">step</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">step</span>
</span><span data-line="8">    <span class="n">current</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">current_val</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="n">suggestions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="c1"># Suggest clamping to boundaries</span>
</span><span data-line="13">    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">min_val</span><span class="p">:</span>
</span><span data-line="14">        <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clamp to minimum: cam.set(&#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">min_val</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="15">    <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
</span><span data-line="16">        <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clamp to maximum: cam.set(&#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">max_val</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="17">    
</span><span data-line="18">    <span class="c1"># Suggest midpoint</span>
</span><span data-line="19">    <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_val</span> <span class="o">+</span> <span class="n">max_val</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span data-line="20">    <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Try midpoint: cam.set(&#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="21">    
</span><span data-line="22">    <span class="c1"># Suggest keeping current if valid</span>
</span><span data-line="23">    <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keep current: cam.set(&#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="24">    
</span><span data-line="25">    <span class="c1"># Suggest step-aligned values</span>
</span><span data-line="26">    <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span data-line="27">        <span class="n">suggestions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ensure value is multiple of step (</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="28">    
</span><span data-line="29">    <span class="k">return</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">suggestions</span><span class="p">)</span>
</span><span data-line="30">
</span><span data-line="31"><span class="c1"># Usage</span>
</span><span data-line="32"><span class="k">try</span><span class="p">:</span>
</span><span data-line="33">    <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</span><span data-line="34"><span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="35">    <span class="n">recovery</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">_suggest_recovery_for_range_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="36">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to set brightness to </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="37">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recovery options: </span><span class="si">{</span><span class="n">recovery</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="38">    
</span><span data-line="39">    <span class="c1"># Output:</span>
</span><span data-line="40">    <span class="c1"># Failed to set brightness to 500</span>
</span><span data-line="41">    <span class="c1"># Recovery options: Clamp to maximum: cam.set(&#39;brightness&#39;, 255) OR </span>
</span><span data-line="42">    <span class="c1"># Try midpoint: cam.set(&#39;brightness&#39;, 128) OR Keep current: cam.set(&#39;brightness&#39;, 128)</span>
</span></pre></div>
</div>
</section>
<section id="validation-aware-safe-setting-pattern">
<h3>Validation-aware safe setting pattern<a class="headerlink" href="#validation-aware-safe-setting-pattern" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">safe_set</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> 
</span><span data-line="2">            <span class="n">auto_clamp</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fallback_to_current</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set property with automatic recovery options.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="5">        <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="n">property_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="6">        <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="7">    <span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="8">        <span class="k">if</span> <span class="n">auto_clamp</span><span class="p">:</span>
</span><span data-line="9">            <span class="c1"># Clamp to valid range</span>
</span><span data-line="10">            <span class="n">clamped</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">min_val</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">max_val</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span><span data-line="11">            <span class="n">cam</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">property_name</span><span class="p">,</span> <span class="n">clamped</span><span class="p">)</span>
</span><span data-line="12">            <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="13">        <span class="k">elif</span> <span class="n">fallback_to_current</span><span class="p">:</span>
</span><span data-line="14">            <span class="c1"># Keep current value (no-op)</span>
</span><span data-line="15">            <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="16">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="17">            <span class="c1"># Re-raise</span>
</span><span data-line="18">            <span class="k">raise</span>
</span><span data-line="19">
</span><span data-line="20"><span class="c1"># Usage</span>
</span><span data-line="21"><span class="n">safe_set</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">auto_clamp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Clamps to 255</span>
</span><span data-line="22"><span class="n">safe_set</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="n">fallback_to_current</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Keeps current if out of range</span>
</span></pre></div>
</div>
</section>
<section id="batch-validation">
<h3>Batch validation<a class="headerlink" href="#batch-validation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">validate_and_apply_settings</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply multiple settings with individual error handling.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="6">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="7">            <span class="n">cam</span><span class="o">.</span><span class="n">set_with_validation</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="8">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="9">        <span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="10">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="11">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="12">        <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="13">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Not supported&quot;</span><span class="p">)</span>
</span><span data-line="14">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="15">    
</span><span data-line="16">    <span class="k">return</span> <span class="n">results</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Usage</span>
</span><span data-line="19"><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="20">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
</span><span data-line="21">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="22">    <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span><span data-line="23">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span data-line="24">    <span class="s1">&#39;roll&#39;</span><span class="p">:</span> <span class="mi">10</span>  <span class="c1"># May fail on unsupported camera</span>
</span><span data-line="25"><span class="p">}</span>
</span><span data-line="26">
</span><span data-line="27"><span class="n">results</span> <span class="o">=</span> <span class="n">validate_and_apply_settings</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</span><span data-line="28"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applied: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="si">}</span><span class="s2"> settings&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="pre-flight-validation">
<h3>Pre-flight validation<a class="headerlink" href="#pre-flight-validation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">can_apply_settings</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if settings would be valid without applying them.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="6">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="7">            <span class="n">prop_range</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="8">            <span class="k">if</span> <span class="ow">not</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="9">                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Not supported&quot;</span><span class="p">)</span>
</span><span data-line="10">            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="11">                <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
</span><span data-line="12">                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="13">                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> out of range &quot;</span>
</span><span data-line="14">                        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span data-line="15">                    <span class="p">)</span>
</span><span data-line="16">        <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="17">            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Not supported&quot;</span><span class="p">)</span>
</span><span data-line="18">    
</span><span data-line="19">    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">errors</span>
</span><span data-line="20">
</span><span data-line="21"><span class="c1"># Usage</span>
</span><span data-line="22"><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</span><span data-line="23"><span class="n">valid</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">can_apply_settings</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">if</span> <span class="n">valid</span><span class="p">:</span>
</span><span data-line="26">    <span class="n">validate_and_apply_settings</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</span><span data-line="27"><span class="k">else</span><span class="p">:</span>
</span><span data-line="28">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Validation failed:&quot;</span><span class="p">)</span>
</span><span data-line="29">    <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">:</span>
</span><span data-line="30">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
</section>
<section id="preset-configuration-management">
<h2>3.14 Preset Configuration Management<a class="headerlink" href="#preset-configuration-management" title="Link to this heading">¶</a></h2>
<p>Presets enable rapid camera configuration by storing named property snapshots. Built-in presets provide optimized defaults for common scenarios; custom presets enable user-defined configurations with optional persistence across sessions.</p>
<section id="built-in-presets-dictionary-with-actual-values">
<h3>BUILT_IN_PRESETS dictionary with actual values<a class="headerlink" href="#built-in-presets-dictionary-with-actual-values" title="Link to this heading">¶</a></h3>
<p>Four professionally-tuned presets included in <code class="docutils literal notranslate"><span class="pre">BUILT_IN_PRESETS</span></code> dict:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">BUILT_IN_PRESETS</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="s1">&#39;daylight&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="3">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="4">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
</span><span data-line="5">        <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
</span><span data-line="6">        <span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="7">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="8">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="9">        <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="10">        <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="11">        <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="12">        <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span>
</span><span data-line="13">    <span class="p">},</span>
</span><span data-line="14">    <span class="s1">&#39;indoor&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="15">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
</span><span data-line="16">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="17">        <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span data-line="18">        <span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="19">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="mi">3200</span><span class="p">,</span>
</span><span data-line="20">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="21">        <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="22">        <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="23">        <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="24">        <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="25">        <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mi">20</span>
</span><span data-line="26">    <span class="p">},</span>
</span><span data-line="27">    <span class="s1">&#39;night&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="28">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span>
</span><span data-line="29">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
</span><span data-line="30">        <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
</span><span data-line="31">        <span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="32">        <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
</span><span data-line="33">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="mi">4000</span><span class="p">,</span>
</span><span data-line="34">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="35">        <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="36">        <span class="s1">&#39;video_backlight_compensation&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
</span><span data-line="37">        <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="38">        <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="39">        <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span>
</span><span data-line="40">    <span class="p">},</span>
</span><span data-line="41">    <span class="s1">&#39;conference&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span data-line="42">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
</span><span data-line="43">        <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span data-line="44">        <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
</span><span data-line="45">        <span class="s1">&#39;hue&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="46">        <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="47">        <span class="s1">&#39;exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="48">        <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="49">        <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="50">        <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="51">        <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="52">        <span class="s1">&#39;video_backlight_compensation&#39;</span><span class="p">:</span> <span class="mi">30</span>
</span><span data-line="53">    <span class="p">}</span>
</span><span data-line="54"><span class="p">}</span>
</span></pre></div>
</div>
<p>Daylight optimizes for outdoor brightness/saturation. Indoor adds warm color temp (3200K). Night increases gain and backlight compensation. Conference centers camera and defaults to neutral settings.</p>
</section>
<section id="apply-preset-method">
<h3><code class="docutils literal notranslate"><span class="pre">apply_preset()</span></code> method<a class="headerlink" href="#apply-preset-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">apply_preset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">partial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply preset configuration to camera. Returns result dict per property.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="n">preset_name_lower</span> <span class="o">=</span> <span class="n">preset_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="6">    
</span><span data-line="7">    <span class="c1"># Check built-in presets first</span>
</span><span data-line="8">    <span class="k">if</span> <span class="n">preset_name_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUILT_IN_PRESETS</span><span class="p">:</span>
</span><span data-line="9">        <span class="n">preset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUILT_IN_PRESETS</span><span class="p">[</span><span class="n">preset_name_lower</span><span class="p">]</span>
</span><span data-line="10">    <span class="c1"># Then check custom presets</span>
</span><span data-line="11">    <span class="k">elif</span> <span class="n">preset_name_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">:</span>
</span><span data-line="12">        <span class="n">preset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">[</span><span class="n">preset_name_lower</span><span class="p">]</span>
</span><span data-line="13">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="14">        <span class="k">raise</span> <span class="n">PresetNotFoundError</span><span class="p">(</span>
</span><span data-line="15">            <span class="sa">f</span><span class="s2">&quot;Preset &#39;</span><span class="si">{</span><span class="n">preset_name</span><span class="si">}</span><span class="s2">&#39; not found. &quot;</span>
</span><span data-line="16">            <span class="sa">f</span><span class="s2">&quot;Available: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BUILT_IN_PRESETS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="17">        <span class="p">)</span>
</span><span data-line="18">    
</span><span data-line="19">    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="20">    
</span><span data-line="21">    <span class="c1"># Apply each property</span>
</span><span data-line="22">    <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">preset</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="23">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="24">            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="25">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
</span><span data-line="26">        <span class="k">except</span> <span class="n">PropertyNotSupportedError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="27">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;unsupported&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span data-line="28">            <span class="k">if</span> <span class="ow">not</span> <span class="n">partial</span><span class="p">:</span>
</span><span data-line="29">                <span class="k">raise</span>  <span class="c1"># All-or-nothing mode</span>
</span><span data-line="30">        <span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="31">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="32">                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="33">                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;out_of_range&#39;</span><span class="p">,</span>
</span><span data-line="34">                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
</span><span data-line="35">                <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">min_val</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">max_val</span><span class="p">),</span>
</span><span data-line="36">                <span class="s1">&#39;current&#39;</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">current_val</span>
</span><span data-line="37">            <span class="p">}</span>
</span><span data-line="38">            <span class="k">if</span> <span class="ow">not</span> <span class="n">partial</span><span class="p">:</span>
</span><span data-line="39">                <span class="k">raise</span>
</span><span data-line="40">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="41">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span data-line="42">            <span class="k">if</span> <span class="ow">not</span> <span class="n">partial</span><span class="p">:</span>
</span><span data-line="43">                <span class="k">raise</span>
</span><span data-line="44">    
</span><span data-line="45">    <span class="k">return</span> <span class="n">results</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Apply built-in preset (all-or-nothing)</span>
</span><span data-line="2"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;daylight&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Apply with partial failure (skip unsupported properties)</span>
</span><span data-line="5"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;conference&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="6"><span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span data-line="7">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Partial preset applied: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Check specific property result</span>
</span><span data-line="10"><span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">][</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
</span><span data-line="11">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zoom failed: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;zoom&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-preset-names-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_preset_names()</span></code> method<a class="headerlink" href="#get-preset-names-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_preset_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get available preset names separated by type.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="4">        <span class="s1">&#39;built_in&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BUILT_IN_PRESETS</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span>
</span><span data-line="5">        <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span data-line="6">    <span class="p">}</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">presets</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_preset_names</span><span class="p">()</span>
</span><span data-line="2"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Built-in presets:&quot;</span><span class="p">,</span> <span class="n">presets</span><span class="p">[</span><span class="s1">&#39;built_in&#39;</span><span class="p">])</span>      <span class="c1"># [&#39;conference&#39;, &#39;daylight&#39;, &#39;indoor&#39;, &#39;night&#39;]</span>
</span><span data-line="3"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom presets:&quot;</span><span class="p">,</span> <span class="n">presets</span><span class="p">[</span><span class="s1">&#39;custom&#39;</span><span class="p">])</span>          <span class="c1"># [&#39;setup1&#39;, &#39;setup2&#39;]</span>
</span><span data-line="4"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total available:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">presets</span><span class="p">[</span><span class="s1">&#39;built_in&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">presets</span><span class="p">[</span><span class="s1">&#39;custom&#39;</span><span class="p">]))</span>
</span></pre></div>
</div>
</section>
<section id="create-custom-preset-method">
<h3><code class="docutils literal notranslate"><span class="pre">create_custom_preset()</span></code> method<a class="headerlink" href="#create-custom-preset-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">create_custom_preset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">properties</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create custom preset from properties dict or current device state.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">BUILT_IN_PRESETS</span><span class="p">:</span>
</span><span data-line="4">        <span class="k">raise</span> <span class="n">PresetError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot override built-in preset &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span data-line="5">    
</span><span data-line="6">    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">:</span>
</span><span data-line="7">        <span class="k">raise</span> <span class="n">PresetError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom preset &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists. Delete first.&quot;</span><span class="p">)</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="k">if</span> <span class="n">properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="10">        <span class="c1"># Capture current device state</span>
</span><span data-line="11">        <span class="n">properties</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="12">        <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span data-line="13">            <span class="k">try</span><span class="p">:</span>
</span><span data-line="14">                <span class="n">properties</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="15">            <span class="k">except</span><span class="p">:</span>
</span><span data-line="16">                <span class="k">pass</span>  <span class="c1"># Skip read failures</span>
</span><span data-line="17">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="18">        <span class="c1"># Validate all properties exist</span>
</span><span data-line="19">        <span class="n">valid_props</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span data-line="20">        <span class="n">invalid</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">properties</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="n">valid_props</span>
</span><span data-line="21">        <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
</span><span data-line="22">            <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown properties: </span><span class="si">{</span><span class="n">invalid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="23">    
</span><span data-line="24">    <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">properties</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Create from current camera state (snapshot)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">create_custom_preset</span><span class="p">(</span><span class="s1">&#39;my_meeting_setup&#39;</span><span class="p">)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Create with explicit properties</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">create_custom_preset</span><span class="p">(</span><span class="s1">&#39;office&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span data-line="6">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
</span><span data-line="7">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="8">    <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="9">    <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="10">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
</span><span data-line="11">    <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
</span><span data-line="12"><span class="p">})</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Later: apply it</span>
</span><span data-line="15"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;office&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-custom-presets-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_custom_presets()</span></code> method<a class="headerlink" href="#get-custom-presets-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_custom_presets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all custom preset definitions (read-only copy).&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">all_custom</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_custom_presets</span><span class="p">()</span>
</span><span data-line="2"><span class="k">for</span> <span class="n">preset_name</span><span class="p">,</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">all_custom</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="3">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">preset_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">properties</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="delete-custom-preset-method">
<h3><code class="docutils literal notranslate"><span class="pre">delete_custom_preset()</span></code> method<a class="headerlink" href="#delete-custom-preset-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">delete_custom_preset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete custom preset by name. Returns True if deleted, False if not found.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">name_lower</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span data-line="4">    <span class="k">if</span> <span class="n">name_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">:</span>
</span><span data-line="5">        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">[</span><span class="n">name_lower</span><span class="p">]</span>
</span><span data-line="6">        <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="7">    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">if</span> <span class="n">cam</span><span class="o">.</span><span class="n">delete_custom_preset</span><span class="p">(</span><span class="s1">&#39;old_setup&#39;</span><span class="p">):</span>
</span><span data-line="2">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preset deleted&quot;</span><span class="p">)</span>
</span><span data-line="3"><span class="k">else</span><span class="p">:</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preset not found&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="clear-custom-presets-method">
<h3><code class="docutils literal notranslate"><span class="pre">clear_custom_presets()</span></code> method<a class="headerlink" href="#clear-custom-presets-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">clear_custom_presets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear all custom presets. Returns count of presets cleared.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="p">)</span>
</span><span data-line="4">    <span class="bp">self</span><span class="o">.</span><span class="n">_custom_presets</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span data-line="5">    <span class="k">return</span> <span class="n">count</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">cleared</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">clear_custom_presets</span><span class="p">()</span>
</span><span data-line="2"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cleared </span><span class="si">{</span><span class="n">cleared</span><span class="si">}</span><span class="s2"> custom presets&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="smart-preset-selection">
<h3>Smart preset selection<a class="headerlink" href="#smart-preset-selection" title="Link to this heading">¶</a></h3>
<p>Automatic preset selection based on environment/time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">select_preset_for_environment</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Recommend preset based on environment description.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">env_lower</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="k">if</span> <span class="s1">&#39;outdoor&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="ow">or</span> <span class="s1">&#39;sunny&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="ow">or</span> <span class="s1">&#39;bright&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span><span class="p">:</span>
</span><span data-line="6">        <span class="k">return</span> <span class="s1">&#39;daylight&#39;</span>
</span><span data-line="7">    <span class="k">elif</span> <span class="s1">&#39;office&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="ow">or</span> <span class="s1">&#39;indoor&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="ow">or</span> <span class="s1">&#39;meeting&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span><span class="p">:</span>
</span><span data-line="8">        <span class="k">return</span> <span class="s1">&#39;conference&#39;</span> <span class="k">if</span> <span class="s1">&#39;meeting&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="k">else</span> <span class="s1">&#39;indoor&#39;</span>
</span><span data-line="9">    <span class="k">elif</span> <span class="s1">&#39;night&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="ow">or</span> <span class="s1">&#39;dark&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span> <span class="ow">or</span> <span class="s1">&#39;low&#39;</span> <span class="ow">in</span> <span class="n">env_lower</span><span class="p">:</span>
</span><span data-line="10">        <span class="k">return</span> <span class="s1">&#39;night&#39;</span>
</span><span data-line="11">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="12">        <span class="k">return</span> <span class="s1">&#39;daylight&#39;</span>  <span class="c1"># Safe default</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Usage</span>
</span><span data-line="15"><span class="n">preset</span> <span class="o">=</span> <span class="n">select_preset_for_environment</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;indoor meeting room&#39;</span><span class="p">)</span>
</span><span data-line="16"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="saving-loading-presets-with-persistence-patterns">
<h3>Saving &amp; loading presets with persistence patterns<a class="headerlink" href="#saving-loading-presets-with-persistence-patterns" title="Link to this heading">¶</a></h3>
<p>Save custom presets to JSON:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">def</span><span class="w"> </span><span class="nf">save_presets</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="4"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save all custom presets to JSON file.&quot;&quot;&quot;</span>
</span><span data-line="5">    <span class="n">presets</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_custom_presets</span><span class="p">()</span>
</span><span data-line="6">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="7">        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">presets</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="8">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">presets</span><span class="p">)</span><span class="si">}</span><span class="s2"> presets to </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="9">
</span><span data-line="10"><span class="k">def</span><span class="w"> </span><span class="nf">load_presets</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="11"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load custom presets from JSON file. Returns count loaded.&quot;&quot;&quot;</span>
</span><span data-line="12">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="13">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="14">            <span class="n">presets</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span data-line="15">        
</span><span data-line="16">        <span class="n">loaded</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="17">        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">presets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="18">            <span class="k">try</span><span class="p">:</span>
</span><span data-line="19">                <span class="n">cam</span><span class="o">.</span><span class="n">create_custom_preset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span data-line="20">                <span class="n">loaded</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="21">            <span class="k">except</span> <span class="n">PresetError</span><span class="p">:</span>
</span><span data-line="22">                <span class="k">pass</span>  <span class="c1"># Preset already exists</span>
</span><span data-line="23">        
</span><span data-line="24">        <span class="k">return</span> <span class="n">loaded</span>
</span><span data-line="25">    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span data-line="26">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preset file not found: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="27">        <span class="k">return</span> <span class="mi">0</span>
</span><span data-line="28">
</span><span data-line="29"><span class="c1"># Usage: Save during session</span>
</span><span data-line="30"><span class="n">cam</span><span class="o">.</span><span class="n">create_custom_preset</span><span class="p">(</span><span class="s1">&#39;setup1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">})</span>
</span><span data-line="31"><span class="n">cam</span><span class="o">.</span><span class="n">create_custom_preset</span><span class="p">(</span><span class="s1">&#39;setup2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</span><span data-line="32"><span class="n">save_presets</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;my_presets.json&#39;</span><span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34"><span class="c1"># Load in next session</span>
</span><span data-line="35"><span class="n">loaded</span> <span class="o">=</span> <span class="n">load_presets</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s1">&#39;my_presets.json&#39;</span><span class="p">)</span>
</span><span data-line="36"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="n">loaded</span><span class="si">}</span><span class="s2"> presets from file&quot;</span><span class="p">)</span>
</span><span data-line="37"><span class="n">cam</span><span class="o">.</span><span class="n">apply_preset</span><span class="p">(</span><span class="s1">&#39;setup1&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="preset-system-design-rationale">
<h3>Preset system design rationale<a class="headerlink" href="#preset-system-design-rationale" title="Link to this heading">¶</a></h3>
<p><strong>Built-in vs. custom separation</strong>: Built-in presets are immutable, device-independent, and provide professional defaults. Custom presets are user-mutable and device-specific, enabling personalization without bloating built-in set.</p>
<p><strong>Flexible property subsets</strong>: Presets specify any property subset; unapplied properties retain current device values. Enables “delta” configuration (only specify changed properties).</p>
<p><strong>Partial application mode</strong>: <code class="docutils literal notranslate"><span class="pre">partial=False</span></code> (default) enforces all-or-nothing (fail if any property unsupported). <code class="docutils literal notranslate"><span class="pre">partial=True</span></code> gracefully skips unsupported properties, ensuring presets work across camera models with varying capabilities.</p>
<p><strong>State capture workflow</strong>: <code class="docutils literal notranslate"><span class="pre">create_custom_preset()</span></code> without properties argument captures entire current device state, enabling “freeze current configuration” use cases.</p>
<p><strong>Persistence patterns</strong>: Presets stored in-memory; JSON save/load provides optional cross-session persistence. Users can distribute preset JSON files for team standardization or camera profiles.</p>
</section>
</section>
<hr class="docutils" />
<section id="bulk-operations-batch-control">
<h2>3.15 Bulk Operations &amp; Batch Control<a class="headerlink" href="#bulk-operations-batch-control" title="Link to this heading">¶</a></h2>
<p>Batch methods apply or read multiple properties efficiently with partial failure handling, optional verbose logging, and rich result reporting. Amortize overhead across multiple operations for significant performance gains.</p>
<section id="set-multiple-method">
<h3><code class="docutils literal notranslate"><span class="pre">set_multiple()</span></code> method<a class="headerlink" href="#set-multiple-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">properties</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="2">                <span class="n">stop_on_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set multiple properties with partial failure handling.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="5">    
</span><span data-line="6">    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="7">    <span class="n">applied</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="8">    <span class="n">skipped</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="11">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="12">            <span class="c1"># Validate before applying</span>
</span><span data-line="13">            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="14">                <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="15">                <span class="k">if</span> <span class="n">prop_range</span> <span class="ow">and</span> <span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]):</span>
</span><span data-line="16">                    <span class="k">raise</span> <span class="n">PropertyValueOutOfRangeError</span><span class="p">(</span>
</span><span data-line="17">                        <span class="n">property_name</span><span class="o">=</span><span class="n">prop_name</span><span class="p">,</span>
</span><span data-line="18">                        <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
</span><span data-line="19">                        <span class="n">min_val</span><span class="o">=</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
</span><span data-line="20">                        <span class="n">max_val</span><span class="o">=</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
</span><span data-line="21">                        <span class="n">step</span><span class="o">=</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">],</span>
</span><span data-line="22">                        <span class="n">current_val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">),</span>
</span><span data-line="23">                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Value out of range&quot;</span>
</span><span data-line="24">                    <span class="p">)</span>
</span><span data-line="25">            
</span><span data-line="26">            <span class="c1"># Apply property</span>
</span><span data-line="27">            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span data-line="28">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="29">                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="30">                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
</span><span data-line="31">                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span><span data-line="32">            <span class="p">}</span>
</span><span data-line="33">            <span class="n">applied</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="34">            
</span><span data-line="35">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="36">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="37">        
</span><span data-line="38">        <span class="k">except</span> <span class="n">PropertyNotSupportedError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="39">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="40">                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="41">                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
</span><span data-line="42">                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;unsupported&#39;</span><span class="p">,</span>
</span><span data-line="43">                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="44">            <span class="p">}</span>
</span><span data-line="45">            <span class="n">skipped</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="46">            
</span><span data-line="47">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="48">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✗ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Unsupported&quot;</span><span class="p">)</span>
</span><span data-line="49">            
</span><span data-line="50">            <span class="k">if</span> <span class="n">stop_on_error</span><span class="p">:</span>
</span><span data-line="51">                <span class="k">raise</span>
</span><span data-line="52">        
</span><span data-line="53">        <span class="k">except</span> <span class="n">PropertyValueOutOfRangeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="54">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="55">                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="56">                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
</span><span data-line="57">                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;out_of_range&#39;</span><span class="p">,</span>
</span><span data-line="58">                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
</span><span data-line="59">                <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">min_val</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">max_val</span><span class="p">),</span>
</span><span data-line="60">                <span class="s1">&#39;current&#39;</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">current_val</span>
</span><span data-line="61">            <span class="p">}</span>
</span><span data-line="62">            <span class="n">skipped</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="63">            
</span><span data-line="64">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="65">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✗ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">: Out of range (</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">min_val</span><span class="si">}</span><span class="s2">–</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">max_val</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="66">            
</span><span data-line="67">            <span class="k">if</span> <span class="n">stop_on_error</span><span class="p">:</span>
</span><span data-line="68">                <span class="k">raise</span>
</span><span data-line="69">        
</span><span data-line="70">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="71">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="72">                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="73">                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
</span><span data-line="74">                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span data-line="75">                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="76">            <span class="p">}</span>
</span><span data-line="77">            <span class="n">skipped</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="78">            
</span><span data-line="79">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="80">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✗ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="81">            
</span><span data-line="82">            <span class="k">if</span> <span class="n">stop_on_error</span><span class="p">:</span>
</span><span data-line="83">                <span class="k">raise</span>
</span><span data-line="84">    
</span><span data-line="85">    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="86">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applied </span><span class="si">{</span><span class="n">applied</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span><span class="si">}</span><span class="s2"> properties (</span><span class="si">{</span><span class="n">skipped</span><span class="si">}</span><span class="s2"> skipped)&quot;</span><span class="p">)</span>
</span><span data-line="87">    
</span><span data-line="88">    <span class="k">return</span> <span class="n">results</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="2">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
</span><span data-line="3">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="4">    <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span data-line="5">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span data-line="6">    <span class="s1">&#39;roll&#39;</span><span class="p">:</span> <span class="mi">45</span>  <span class="c1"># May fail on unsupported camera</span>
</span><span data-line="7"><span class="p">}</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Apply with verbose logging and partial failure</span>
</span><span data-line="10"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stop_on_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="11"><span class="c1"># Output:</span>
</span><span data-line="12"><span class="c1"># ✓ brightness = 70</span>
</span><span data-line="13"><span class="c1"># ✓ contrast = 60</span>
</span><span data-line="14"><span class="c1"># ✓ saturation = 55</span>
</span><span data-line="15"><span class="c1"># ✓ zoom = 200</span>
</span><span data-line="16"><span class="c1"># ✗ roll: Unsupported</span>
</span><span data-line="17"><span class="c1"># Applied 4/5 properties (1 skipped)</span>
</span><span data-line="18">
</span><span data-line="19"><span class="c1"># Check programmatically</span>
</span><span data-line="20"><span class="n">successful</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">])</span>
</span><span data-line="21"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Success rate: </span><span class="si">{</span><span class="n">successful</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-multiple-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_multiple()</span></code> method<a class="headerlink" href="#get-multiple-method" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">properties</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get multiple properties, gracefully skipping unsupported ones.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="4">    
</span><span data-line="5">    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="6">    <span class="n">success_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="k">for</span> <span class="n">prop_name</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
</span><span data-line="9">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="10">            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
</span><span data-line="11">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span data-line="12">            <span class="n">success_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="13">            
</span><span data-line="14">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="15">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="16">        
</span><span data-line="17">        <span class="k">except</span> <span class="n">PropertyNotSupportedError</span><span class="p">:</span>
</span><span data-line="18">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="19">            
</span><span data-line="20">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="21">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✗ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Not supported&quot;</span><span class="p">)</span>
</span><span data-line="22">        
</span><span data-line="23">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="24">            <span class="n">results</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="25">            
</span><span data-line="26">            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="27">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✗ </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="28">    
</span><span data-line="29">    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span data-line="30">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="n">success_count</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span><span class="si">}</span><span class="s2"> properties&quot;</span><span class="p">)</span>
</span><span data-line="31">    
</span><span data-line="32">    <span class="k">return</span> <span class="n">results</span>
</span></pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">props_to_read</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="s1">&#39;tilt&#39;</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="s1">&#39;roll&#39;</span><span class="p">,</span> <span class="s1">&#39;iris&#39;</span><span class="p">]</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># Read all, verbose logging</span>
</span><span data-line="4"><span class="n">state</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_multiple</span><span class="p">(</span><span class="n">props_to_read</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="5"><span class="c1"># Output:</span>
</span><span data-line="6"><span class="c1"># ✓ brightness = 128</span>
</span><span data-line="7"><span class="c1"># ✓ contrast = 100</span>
</span><span data-line="8"><span class="c1"># ✓ pan = 0</span>
</span><span data-line="9"><span class="c1"># ✓ tilt = 0</span>
</span><span data-line="10"><span class="c1"># ✓ zoom = 150</span>
</span><span data-line="11"><span class="c1"># ✗ roll: Not supported</span>
</span><span data-line="12"><span class="c1"># ✗ iris: Not supported</span>
</span><span data-line="13"><span class="c1"># Read 5/7 properties</span>
</span><span data-line="14">
</span><span data-line="15"><span class="c1"># Filter to supported properties</span>
</span><span data-line="16"><span class="n">supported</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</span><span data-line="17"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Device state: </span><span class="si">{</span><span class="n">supported</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="optional-verbose-logging">
<h3>Optional verbose logging<a class="headerlink" href="#optional-verbose-logging" title="Link to this heading">¶</a></h3>
<p>Verbose mode prints progress for each property and summary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Verbose=True: Per-property feedback + summary</span>
</span><span data-line="2"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Verbose=False: Silent operation (default)</span>
</span><span data-line="5"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Use verbose for interactive debugging, silent for batch scripts</span>
</span></pre></div>
</div>
</section>
<section id="partial-failure-handling-with-result-dicts">
<h3>Partial failure handling with result dicts<a class="headerlink" href="#partial-failure-handling-with-result-dicts" title="Link to this heading">¶</a></h3>
<p>Result dicts provide structured error info per property:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">({</span><span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">})</span>  <span class="c1"># brightness out-of-range</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="4">    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
</span><span data-line="5">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Applied value </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="6">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="7">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">: Failed (</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="8">        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;out_of_range&#39;</span><span class="p">:</span>
</span><span data-line="9">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Valid range: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;range&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Current: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="10">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="11">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Message: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Output:</span>
</span><span data-line="14"><span class="c1"># brightness: Failed (out_of_range)</span>
</span><span data-line="15"><span class="c1">#   Valid range: (0, 255), Current: 128</span>
</span><span data-line="16"><span class="c1"># zoom: Applied value 200</span>
</span></pre></div>
</div>
</section>
<section id="batch-operation-efficiency-patterns">
<h3>Batch operation efficiency patterns<a class="headerlink" href="#batch-operation-efficiency-patterns" title="Link to this heading">¶</a></h3>
<p><strong>Efficient patterns</strong> (batch approach):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># ✓ Single batch call for multiple properties</span>
</span><span data-line="2"><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="3">    <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
</span><span data-line="4">    <span class="s1">&#39;contrast&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span><span data-line="5">    <span class="s1">&#39;saturation&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span data-line="6">    <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span data-line="7">    <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
</span><span data-line="8">    <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
</span><span data-line="9"><span class="p">}</span>
</span><span data-line="10"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span data-line="11">
</span><span data-line="12"><span class="c1"># ✓ Batch read then conditional updates</span>
</span><span data-line="13"><span class="n">state</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_multiple</span><span class="p">([</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">,</span> <span class="s1">&#39;focus&#39;</span><span class="p">])</span>
</span><span data-line="14"><span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;brightness&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span data-line="15">    <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">({</span><span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">})</span>
</span><span data-line="16">
</span><span data-line="17"><span class="c1"># ✓ Transactional pattern: save state, apply config, rollback if needed</span>
</span><span data-line="18"><span class="n">original</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_multiple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span data-line="19"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">stop_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="20"><span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span><span data-line="21">    <span class="n">cam</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>  <span class="c1"># Rollback</span>
</span></pre></div>
</div>
<p><strong>Inefficient patterns</strong> (individual calls):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># ✗ Multiple individual calls (high latency overhead)</span>
</span><span data-line="2"><span class="n">cam</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set_contrast</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</span><span data-line="4"><span class="n">cam</span><span class="o">.</span><span class="n">set_saturation</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span>
</span><span data-line="5"><span class="n">cam</span><span class="o">.</span><span class="n">set_pan</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="6"><span class="n">cam</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</span><span data-line="7"><span class="n">cam</span><span class="o">.</span><span class="n">set_focus</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="performance-comparison-with-individual-operations">
<h3>Performance comparison with individual operations<a class="headerlink" href="#performance-comparison-with-individual-operations" title="Link to this heading">¶</a></h3>
<p><strong>Benchmark results</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1">Scenario: Configure 50 properties on typical USB camera
</span><span data-line="2">
</span><span data-line="3">Individual method calls (50× set_*):
</span><span data-line="4">  - Per-call overhead: ~50ms
</span><span data-line="5">  - Total: 50 calls × 50ms = 2,500ms (2.5 seconds)
</span><span data-line="6">  
</span><span data-line="7">Batch operation (1× set_multiple):
</span><span data-line="8">  - Amortized overhead: ~10ms
</span><span data-line="9">  - Total: 1 call × 500ms = 500ms (0.5 seconds)
</span><span data-line="10">  
</span><span data-line="11">Efficiency gain: 5x faster (~80% reduction)
</span></pre></div>
</div>
<p><strong>Why batch is faster</strong>:</p>
<ol class="arabic simple">
<li><p>Single context acquisition (vs. 50× connection checks)</p></li>
<li><p>Reduced device communication overhead (batched operations)</p></li>
<li><p>Amortized validation cost (all properties validated once)</p></li>
<li><p>Pipeline efficiency (device can process multiple commands sequentially)</p></li>
</ol>
<p><strong>Recommendation</strong>: Use <code class="docutils literal notranslate"><span class="pre">set_multiple()</span></code> for 3+ properties; use individual setters for single properties or latency-sensitive code that cannot tolerate batch delays.</p>
</section>
</section>
<section id="camera-reset-defaults">
<h2>3.16 Camera Reset &amp; Defaults<a class="headerlink" href="#camera-reset-defaults" title="Link to this heading">¶</a></h2>
<p>Reset operations restore properties to factory or intelligent defaults with tracking and device-specific behavior handling.</p>
<section id="reset-to-defaults-method">
<h3><code class="docutils literal notranslate"><span class="pre">reset_to_defaults()</span></code> method<a class="headerlink" href="#reset-to-defaults-method" title="Link to this heading">¶</a></h3>
<p>Resets all properties to device factory defaults. Requires explicit confirmation to prevent accidents.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">reset_to_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span data-line="2">    <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span data-line="3">        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Pass confirm=True to reset all properties&quot;</span><span class="p">)</span>
</span><span data-line="4">        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span data-line="5">    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_connected</span><span class="p">()</span>
</span><span data-line="6">    <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">reset_to_defaults</span><span class="p">()</span>
</span><span data-line="7">    <span class="k">return</span> <span class="p">{</span><span class="n">prop</span><span class="p">:</span> <span class="kc">True</span> <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
</span></pre></div>
</div>
<p>Usage: <code class="docutils literal notranslate"><span class="pre">cam.reset_to_defaults(confirm=True)</span></code></p>
</section>
<section id="set-smart-default-intelligent-default-method">
<h3><code class="docutils literal notranslate"><span class="pre">set_smart_default()</span></code> intelligent default method<a class="headerlink" href="#set-smart-default-intelligent-default-method" title="Link to this heading">¶</a></h3>
<p>Sets property to device-specific intelligent default: <code class="docutils literal notranslate"><span class="pre">brightness=128</span></code>, <code class="docutils literal notranslate"><span class="pre">white_balance='auto'</span></code>, <code class="docutils literal notranslate"><span class="pre">focus='auto'</span></code>, <code class="docutils literal notranslate"><span class="pre">pan=0</span></code>, <code class="docutils literal notranslate"><span class="pre">tilt=0</span></code>, <code class="docutils literal notranslate"><span class="pre">zoom=100</span></code>, etc.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">set_smart_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">smart_defaults</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="3">        <span class="s1">&#39;brightness&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="s1">&#39;white_balance&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;focus&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
</span><span data-line="4">        <span class="s1">&#39;pan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;tilt&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;privacy&#39;</span><span class="p">:</span> <span class="kc">False</span>
</span><span data-line="5">    <span class="p">}</span>
</span><span data-line="6">    <span class="k">if</span> <span class="n">property_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">smart_defaults</span><span class="p">:</span>
</span><span data-line="7">        <span class="k">raise</span> <span class="n">PropertyNotSupportedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No smart default for &#39;</span><span class="si">{</span><span class="n">property_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span data-line="8">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="9">        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">property_name</span><span class="p">,</span> <span class="n">smart_defaults</span><span class="p">[</span><span class="n">property_name</span><span class="p">])</span>
</span><span data-line="10">        <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="11">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="12">        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>
</div>
</section>
<section id="center-camera-method">
<h3><code class="docutils literal notranslate"><span class="pre">center_camera()</span></code> method<a class="headerlink" href="#center-camera-method" title="Link to this heading">¶</a></h3>
<p>Centers pan/tilt using device-reported ranges. If 0 is supported, uses 0; otherwise uses mid-range.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">center_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span data-line="2">    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="3">    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="s1">&#39;tilt&#39;</span><span class="p">]:</span>
</span><span data-line="4">        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span><span data-line="5">        <span class="n">center</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span>
</span><span data-line="6">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="7">            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</span><span data-line="8">            <span class="n">results</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="9">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="10">            <span class="n">results</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="11">    <span class="k">return</span> <span class="n">results</span>
</span></pre></div>
</div>
</section>
<section id="partial-success-handling">
<h3>Partial success handling<a class="headerlink" href="#partial-success-handling" title="Link to this heading">¶</a></h3>
<p>Reset operations may partially succeed. Check result dict to identify which properties reset vs. failed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">results</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">reset_to_defaults</span><span class="p">(</span><span class="n">confirm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="2"><span class="n">succeeded</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="p">)</span>
</span><span data-line="3"><span class="n">failed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">-</span> <span class="n">succeeded</span>
</span></pre></div>
</div>
</section>
<section id="smart-default-algorithm">
<h3>Smart default algorithm<a class="headerlink" href="#smart-default-algorithm" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Detects property type (video/camera, int/bool, auto-capable)</p></li>
<li><p>Selects defaults within device range constraints</p></li>
<li><p>Prefers ‘auto’ modes (white_balance, focus, exposure)</p></li>
<li><p>Centers pan/tilt to 0 with mid-range fallback</p></li>
<li><p>Uses conservative mid-range values (brightness, saturation)</p></li>
<li><p>Gracefully handles unsupported properties</p></li>
</ol>
</section>
<section id="reset-operation-tracking">
<h3>Reset operation tracking<a class="headerlink" href="#reset-operation-tracking" title="Link to this heading">¶</a></h3>
<p>Track reset history for audit trails:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">track_reset</span><span class="p">(</span><span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span data-line="2">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="3">        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span data-line="4">        <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="n">property_name</span><span class="p">,</span>
</span><span data-line="5">        <span class="s1">&#39;previous_value&#39;</span><span class="p">:</span> <span class="n">cam</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="6">    <span class="p">}</span>
</span></pre></div>
</div>
</section>
<section id="device-specific-reset-behavior">
<h3>Device-specific reset behavior<a class="headerlink" href="#device-specific-reset-behavior" title="Link to this heading">¶</a></h3>
<p>UVC webcams reset via device control with persistence across reconnect. IP/PTZ cameras reset via API only; pan/tilt/zoom reset to mechanical center/limits. High-end cameras may require confirmation and run slower.</p>
</section>
</section>
<hr class="docutils" />
<section id="device-information-status">
<h2>3.17 Device Information &amp; Status<a class="headerlink" href="#device-information-status" title="Link to this heading">¶</a></h2>
<p>Provides read-only access to device metadata and connection health.</p>
<section id="device-name-property">
<h3><code class="docutils literal notranslate"><span class="pre">device_name</span></code> property<a class="headerlink" href="#device-name-property" title="Link to this heading">¶</a></h3>
<p>Read-only device name from USB descriptor (e.g., “HD Webcam C920”).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="3">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">device_name</span> <span class="ow">or</span> <span class="s2">&quot;Unknown&quot;</span>
</span></pre></div>
</div>
</section>
<section id="device-path-property">
<h3><code class="docutils literal notranslate"><span class="pre">device_path</span></code> property<a class="headerlink" href="#device-path-property" title="Link to this heading">¶</a></h3>
<p>Read-only unique device identifier for reconnection. Platform-specific: <code class="docutils literal notranslate"><span class="pre">/dev/videoX</span></code> (Linux), <code class="docutils literal notranslate"><span class="pre">\\?\USB#...</span></code> (Windows), camera index (macOS).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">device_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="3">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_path</span>
</span></pre></div>
</div>
</section>
<section id="is-connected-property">
<h3><code class="docutils literal notranslate"><span class="pre">is_connected</span></code> property<a class="headerlink" href="#is-connected-property" title="Link to this heading">¶</a></h3>
<p>Returns True if device responsive; False if disconnected or unresponsive. Uses lightweight property read test.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="3">    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span><span class="p">:</span>
</span><span data-line="4">        <span class="k">return</span> <span class="kc">False</span>
</span><span data-line="5">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="6">        <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">test_property_read</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="7">        <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="8">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="9">        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>
</div>
</section>
<section id="get-connection-info-method">
<h3><code class="docutils literal notranslate"><span class="pre">get_connection_info()</span></code> method<a class="headerlink" href="#get-connection-info-method" title="Link to this heading">¶</a></h3>
<p>Returns connection metadata dict: device_name, device_path, is_connected, connection_type, connection_time, uptime_seconds, property_count, supported_video_props, supported_camera_props.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_connection_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span data-line="2">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="3">        <span class="s1">&#39;device_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span>
</span><span data-line="4">        <span class="s1">&#39;device_path&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_path</span><span class="p">,</span>
</span><span data-line="5">        <span class="s1">&#39;is_connected&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">,</span>
</span><span data-line="6">        <span class="s1">&#39;uptime_seconds&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connection_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span>
</span><span data-line="7">        <span class="s1">&#39;property_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_properties</span><span class="p">())</span>
</span><span data-line="8">    <span class="p">}</span>
</span></pre></div>
</div>
</section>
<section id="test-connection-health-multi-operation-health-check">
<h3><code class="docutils literal notranslate"><span class="pre">test_connection_health()</span></code> multi-operation health check<a class="headerlink" href="#test-connection-health-multi-operation-health-check" title="Link to this heading">¶</a></h3>
<p>Performs read, write, and range-query tests. Returns per-test latency and overall health status (‘healthy’, ‘degraded’, ‘offline’).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">test_connection_health</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span data-line="2">    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tests&#39;</span><span class="p">:</span> <span class="p">{}}</span>
</span><span data-line="3">    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="s1">&#39;range_query&#39;</span><span class="p">]:</span>
</span><span data-line="4">        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span data-line="5">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="6">            <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;read&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">)</span>
</span><span data-line="7">            <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s1">&#39;write&#39;</span><span class="p">:</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span data-line="8">            <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="s1">&#39;zoom&#39;</span><span class="p">)</span>
</span><span data-line="9">            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;tests&#39;</span><span class="p">][</span><span class="n">op</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;latency_ms&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">}</span>
</span><span data-line="10">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="11">            <span class="n">results</span><span class="p">[</span><span class="s1">&#39;tests&#39;</span><span class="p">][</span><span class="n">op</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span data-line="12">    <span class="n">successes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;tests&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">))</span>
</span><span data-line="13">    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;overall_health&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;healthy&#39;</span> <span class="k">if</span> <span class="n">successes</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;degraded&#39;</span> <span class="k">if</span> <span class="n">successes</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;offline&#39;</span><span class="p">)</span>
</span><span data-line="14">    <span class="k">return</span> <span class="n">results</span>
</span></pre></div>
</div>
</section>
<section id="connection-state-tracking">
<h3>Connection state tracking<a class="headerlink" href="#connection-state-tracking" title="Link to this heading">¶</a></h3>
<p>Internal tracking: <code class="docutils literal notranslate"><span class="pre">_connected</span></code>, <code class="docutils literal notranslate"><span class="pre">_connection_time</span></code>, <code class="docutils literal notranslate"><span class="pre">_last_activity</span></code>, <code class="docutils literal notranslate"><span class="pre">_disconnection_count</span></code>, <code class="docutils literal notranslate"><span class="pre">_error_log</span></code>. Used for diagnostics and recovery strategies.</p>
</section>
<section id="device-metadata-access">
<h3>Device metadata access<a class="headerlink" href="#device-metadata-access" title="Link to this heading">¶</a></h3>
<p>Query device capabilities: <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">connected</span></code>, <code class="docutils literal notranslate"><span class="pre">uptime</span></code>, <code class="docutils literal notranslate"><span class="pre">total_properties</span></code>, <code class="docutils literal notranslate"><span class="pre">video_properties</span></code>, <code class="docutils literal notranslate"><span class="pre">camera_properties</span></code>, <code class="docutils literal notranslate"><span class="pre">supports_pan_tilt</span></code>, <code class="docutils literal notranslate"><span class="pre">supports_zoom</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_device_capabilities</span><span class="p">(</span><span class="n">cam</span><span class="p">):</span>
</span><span data-line="2">    <span class="n">info</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_connection_info</span><span class="p">()</span>
</span><span data-line="3">    <span class="n">props</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">list_properties</span><span class="p">()</span>
</span><span data-line="4">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="5">        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;device_name&#39;</span><span class="p">],</span>
</span><span data-line="6">        <span class="s1">&#39;supports_pan_tilt&#39;</span><span class="p">:</span> <span class="s1">&#39;pan&#39;</span> <span class="ow">in</span> <span class="n">props</span> <span class="ow">and</span> <span class="s1">&#39;tilt&#39;</span> <span class="ow">in</span> <span class="n">props</span><span class="p">,</span>
</span><span data-line="7">        <span class="s1">&#39;supports_zoom&#39;</span><span class="p">:</span> <span class="s1">&#39;zoom&#39;</span> <span class="ow">in</span> <span class="n">props</span>
</span><span data-line="8">    <span class="p">}</span>
</span></pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="connection-management-recovery">
<h2>3.18 Connection Management &amp; Recovery<a class="headerlink" href="#connection-management-recovery" title="Link to this heading">¶</a></h2>
<p>Manage device connections with reconnection logic, validation, health monitoring, and error recovery.</p>
<section id="reconnect-method">
<h3><code class="docutils literal notranslate"><span class="pre">reconnect()</span></code> method<a class="headerlink" href="#reconnect-method" title="Link to this heading">¶</a></h3>
<p>Re-establishes connection to same device using stored device_path. Implements exponential backoff retry with configurable timeout.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">reconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span data-line="3">    <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">timeout_seconds</span><span class="p">:</span>
</span><span data-line="4">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="5">            <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span> <span class="o">=</span> <span class="n">DuvCoreAPI</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device_path</span><span class="p">)</span>
</span><span data-line="6">            <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="7">            <span class="bp">self</span><span class="o">.</span><span class="n">_disconnection_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="8">            <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="9">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="10">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span data-line="11">    <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reconnection timeout after </span><span class="si">{</span><span class="n">timeout_seconds</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="close-basic-cleanup">
<h3><code class="docutils literal notranslate"><span class="pre">close()</span></code> basic cleanup<a class="headerlink" href="#close-basic-cleanup" title="Link to this heading">¶</a></h3>
<p>Releases device handle and marks disconnected. No validation; simple cleanup for context manager exit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="2">    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="p">:</span>
</span><span data-line="3">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">            <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="5">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="6">            <span class="k">pass</span>
</span><span data-line="7">    <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">False</span>
</span></pre></div>
</div>
</section>
<section id="close-with-validation-cleanup-with-validation">
<h3><code class="docutils literal notranslate"><span class="pre">close_with_validation()</span></code> cleanup with validation<a class="headerlink" href="#close-with-validation-cleanup-with-validation" title="Link to this heading">¶</a></h3>
<p>Cleanup that validates device state before closing: checks responsiveness, centers camera, disables privacy, handles errors gracefully.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">close_with_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span data-line="2">    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;responsive&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span>
</span><span data-line="5">        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;centered&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_camera</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pan&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span data-line="6">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">privacy</span><span class="p">:</span>
</span><span data-line="7">            <span class="bp">self</span><span class="o">.</span><span class="n">privacy</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="8">        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;privacy_disabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="9">    <span class="k">except</span><span class="p">:</span>
</span><span data-line="10">        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;privacy_disabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="11">    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="12">    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;closed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="13">    <span class="k">return</span> <span class="n">results</span>
</span></pre></div>
</div>
</section>
<section id="health-monitoring-diagnostics">
<h3>Health monitoring &amp; diagnostics<a class="headerlink" href="#health-monitoring-diagnostics" title="Link to this heading">¶</a></h3>
<p>Diagnose connection issues: check device path exists, run health check, inspect last activity, track disconnection count, review error log.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">diagnose_connection</span><span class="p">(</span><span class="n">cam</span><span class="p">):</span>
</span><span data-line="2">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="3">        <span class="s1">&#39;device_exists&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">device_path</span><span class="p">),</span>
</span><span data-line="4">        <span class="s1">&#39;is_connected&#39;</span><span class="p">:</span> <span class="n">cam</span><span class="o">.</span><span class="n">is_connected</span><span class="p">,</span>
</span><span data-line="5">        <span class="s1">&#39;health&#39;</span><span class="p">:</span> <span class="n">cam</span><span class="o">.</span><span class="n">test_connection_health</span><span class="p">(),</span>
</span><span data-line="6">        <span class="s1">&#39;disconnections&#39;</span><span class="p">:</span> <span class="n">cam</span><span class="o">.</span><span class="n">_disconnection_count</span><span class="p">,</span>
</span><span data-line="7">        <span class="s1">&#39;recent_errors&#39;</span><span class="p">:</span> <span class="n">cam</span><span class="o">.</span><span class="n">_error_log</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
</span><span data-line="8">    <span class="p">}</span>
</span></pre></div>
</div>
</section>
<section id="connection-error-tracking-recovery">
<h3>Connection error tracking &amp; recovery<a class="headerlink" href="#connection-error-tracking-recovery" title="Link to this heading">¶</a></h3>
<p>Track error patterns and suggest recovery actions: timeout → reconnect/unplug; not found → check USB; permission → check access rights.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">class</span><span class="w"> </span><span class="nc">ErrorTracker</span><span class="p">:</span>
</span><span data-line="2">    <span class="k">def</span><span class="w"> </span><span class="nf">suggest_recovery</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="3">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;No errors&quot;</span>
</span><span data-line="4">        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span data-line="5">        <span class="k">if</span> <span class="s1">&#39;timeout&#39;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;Device unresponsive. Reconnect or unplug/replug.&quot;</span>
</span><span data-line="6">        <span class="k">elif</span> <span class="s1">&#39;not found&#39;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;Device disconnected. Check USB.&quot;</span>
</span><span data-line="7">        <span class="k">elif</span> <span class="s1">&#39;permission&#39;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;Permission denied. Check access rights.&quot;</span>
</span><span data-line="8">        <span class="k">return</span> <span class="s2">&quot;Unknown error. See error log.&quot;</span>
</span></pre></div>
</div>
</section>
<section id="core-property-for-result-api-access">
<h3><code class="docutils literal notranslate"><span class="pre">.core</span></code> property for Result API access<a class="headerlink" href="#core-property-for-result-api-access" title="Link to this heading">¶</a></h3>
<p>Direct access to underlying C++ API for advanced Result/Status operations and low-level error handling.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@property</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">core</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="3">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span>
</span><span data-line="4">
</span><span data-line="5"><span class="c1"># Usage:</span>
</span><span data-line="6"><span class="n">result</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">get_raw_property</span><span class="p">(</span><span class="n">prop_enum</span><span class="p">)</span>
</span><span data-line="7"><span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">():</span>
</span><span data-line="8">    <span class="n">value</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span></pre></div>
</div>
</section>
<section id="advanced-connection-management-with-state-machine">
<h3>Advanced connection management with state machine<a class="headerlink" href="#advanced-connection-management-with-state-machine" title="Link to this heading">¶</a></h3>
<p>Manage state transitions: disconnected ↔ connected ↔ degraded ↔ reconnecting → closed. Validates transitions and prevents invalid state changes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">class</span><span class="w"> </span><span class="nc">StateMachine</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">STATES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;disconnected&#39;</span><span class="p">,</span> <span class="s1">&#39;connected&#39;</span><span class="p">,</span> <span class="s1">&#39;reconnecting&#39;</span><span class="p">,</span> <span class="s1">&#39;degraded&#39;</span><span class="p">,</span> <span class="s1">&#39;closed&#39;</span><span class="p">]</span>
</span><span data-line="3">    <span class="k">def</span><span class="w"> </span><span class="nf">transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">):</span>
</span><span data-line="4">        <span class="n">valid</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="5">            <span class="s1">&#39;disconnected&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;connected&#39;</span><span class="p">,</span> <span class="s1">&#39;closed&#39;</span><span class="p">],</span>
</span><span data-line="6">            <span class="s1">&#39;connected&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;disconnected&#39;</span><span class="p">,</span> <span class="s1">&#39;degraded&#39;</span><span class="p">,</span> <span class="s1">&#39;closed&#39;</span><span class="p">],</span>
</span><span data-line="7">            <span class="s1">&#39;degraded&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;connected&#39;</span><span class="p">,</span> <span class="s1">&#39;disconnected&#39;</span><span class="p">,</span> <span class="s1">&#39;reconnecting&#39;</span><span class="p">],</span>
</span><span data-line="8">            <span class="s1">&#39;reconnecting&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;connected&#39;</span><span class="p">,</span> <span class="s1">&#39;disconnected&#39;</span><span class="p">],</span>
</span><span data-line="9">            <span class="s1">&#39;closed&#39;</span><span class="p">:</span> <span class="p">[]</span>
</span><span data-line="10">        <span class="p">}</span>
</span><span data-line="11">        <span class="k">if</span> <span class="n">new_state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="p">[]):</span>
</span><span data-line="12">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="13">        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
</span></pre></div>
</div>
</section>
<section id="reconnection-logic-patterns">
<h3>Reconnection logic patterns<a class="headerlink" href="#reconnection-logic-patterns" title="Link to this heading">¶</a></h3>
<p>Exponential backoff: retry with increasing delays (1s, 2s, 4s, 8s, 16s, capped at 30s). All-or-nothing transaction: save state, apply config, rollback on failure.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">reconnect_with_backoff</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span data-line="2">    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_retries</span><span class="p">):</span>
</span><span data-line="3">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">            <span class="n">cam</span><span class="o">.</span><span class="n">reconnect</span><span class="p">(</span><span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="5">            <span class="k">return</span> <span class="kc">True</span>
</span><span data-line="6">        <span class="k">except</span><span class="p">:</span>
</span><span data-line="7">            <span class="n">wait</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</span><span data-line="8">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span>
</span><span data-line="9">    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>
</div>
</section>
<section id="device-path-tracking-for-reconnection">
<h3>Device path tracking for reconnection<a class="headerlink" href="#device-path-tracking-for-reconnection" title="Link to this heading">¶</a></h3>
<p>Save/load device path across sessions for persistent reconnection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">save_device_path</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
</span><span data-line="2">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="3">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">device_path</span><span class="p">)</span>
</span><span data-line="4">
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">load_and_reconnect</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
</span><span data-line="6">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="7">        <span class="n">device_path</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span data-line="8">    <span class="n">cam</span> <span class="o">=</span> <span class="n">CameraController</span><span class="p">()</span>
</span><span data-line="9">    <span class="n">cam</span><span class="o">.</span><span class="n">_device_path</span> <span class="o">=</span> <span class="n">device_path</span>
</span><span data-line="10">    <span class="n">cam</span><span class="o">.</span><span class="n">reconnect</span><span class="p">()</span>
</span><span data-line="11">    <span class="k">return</span> <span class="n">cam</span>
</span></pre></div>
</div>
</section>
</section>
<section id="internal-helper-methods-string-conversion">
<h2>3.19 Internal Helper Methods &amp; String Conversion<a class="headerlink" href="#internal-helper-methods-string-conversion" title="Link to this heading">¶</a></h2>
<p>These internal helper methods handle common tasks that the public API relies on behind the scenes. Understanding them helps developers grasp how the controller manages device communication, mode conversion, and Result API integration.</p>
<section id="ensure-connected-connection-validation">
<h3><code class="docutils literal notranslate"><span class="pre">_ensure_connected()</span></code> connection validation<a class="headerlink" href="#ensure-connected-connection-validation" title="Link to this heading">¶</a></h3>
<p>This private method is called at the start of almost every operation that needs device access. It validates that the camera is still connected and responsive before attempting any property access. If the connection is broken or the device has been disconnected, it immediately raises <code class="docutils literal notranslate"><span class="pre">DeviceNotConnectedError</span></code> with a clear message, preventing cryptic failures deeper in the call stack.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_ensure_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if camera is connected; raise exception if not.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">:</span>
</span><span data-line="4">        <span class="k">raise</span> <span class="n">DeviceNotConnectedError</span><span class="p">(</span><span class="s2">&quot;Camera is not connected&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Why this matters: This prevents operations from failing silently or with unclear error messages. It’s a defensive programming pattern that catches problems early. Any public method that needs the device should call this first.</p>
</section>
<section id="parse-mode-string-mode-string-parsing">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_mode_string()</span></code> mode string parsing<a class="headerlink" href="#parse-mode-string-mode-string-parsing" title="Link to this heading">¶</a></h3>
<p>Properties can be set to different modes: <code class="docutils literal notranslate"><span class="pre">'manual'</span></code> (user-specified value), <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> (device auto-adjusts), or <code class="docutils literal notranslate"><span class="pre">'continuous'</span></code> (ongoing automatic adjustment). The parser converts user input to canonical lowercase form, handling common mistakes like extra whitespace or mixed case.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_parse_mode_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert mode string to canonical lowercase form.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">normalized</span> <span class="o">=</span> <span class="n">mode_str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># Remove whitespace, convert to lowercase</span>
</span><span data-line="4">    <span class="n">valid_modes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;manual&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;continuous&#39;</span><span class="p">}</span>
</span><span data-line="5">    <span class="k">if</span> <span class="n">normalized</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_modes</span><span class="p">:</span>
</span><span data-line="6">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid mode: &#39;</span><span class="si">{</span><span class="n">mode_str</span><span class="si">}</span><span class="s2">&#39;. Expected one of: </span><span class="si">{</span><span class="n">valid_modes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="7">    <span class="k">return</span> <span class="n">normalized</span>
</span></pre></div>
</div>
<p><strong>Case-insensitive handling</strong>: Input <code class="docutils literal notranslate"><span class="pre">'MANUAL'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Manual'</span></code>, <code class="docutils literal notranslate"><span class="pre">'manual'</span></code> all become <code class="docutils literal notranslate"><span class="pre">'manual'</span></code>.</p>
<p><strong>Whitespace tolerance</strong>: Input <code class="docutils literal notranslate"><span class="pre">'</span>&#160; <span class="pre">auto</span>&#160; <span class="pre">'</span></code> becomes <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>. This prevents frustrating errors where users accidentally include spaces from copy-pasting.</p>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">_parse_mode_string('Auto')</span></code> → <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, <code class="docutils literal notranslate"><span class="pre">_parse_mode_string('</span> <span class="pre">CONTINUOUS</span> <span class="pre">')</span></code> → <code class="docutils literal notranslate"><span class="pre">'continuous'</span></code>.</p>
</section>
<section id="set-property-auto-auto-mode-setter">
<h3><code class="docutils literal notranslate"><span class="pre">_set_property_auto()</span></code> auto mode setter<a class="headerlink" href="#set-property-auto-auto-mode-setter" title="Link to this heading">¶</a></h3>
<p>Sets a property to automatic mode when the device supports it. This is called internally by auto-adjustment methods. It gracefully handles devices that don’t support auto mode for a particular property (returns False rather than crashing).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_set_property_auto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set property to auto mode if supported by device.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="4">        <span class="c1"># Get current setting via Result API</span>
</span><span data-line="5">        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_video_property</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="6">        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">():</span>
</span><span data-line="7">            <span class="n">setting</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span data-line="8">            <span class="n">setting</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">CamMode</span><span class="o">.</span><span class="n">Auto</span>  <span class="c1"># Change mode to auto</span>
</span><span data-line="9">            <span class="c1"># Apply the change</span>
</span><span data-line="10">            <span class="n">set_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_video_property</span><span class="p">(</span><span class="n">property_name</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="11">            <span class="k">return</span> <span class="n">set_result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">()</span>
</span><span data-line="12">    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span data-line="13">        <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Device doesn&#39;t support auto for this property</span>
</span><span data-line="14">    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>
</div>
<p>This is useful for properties like white balance (<code class="docutils literal notranslate"><span class="pre">'auto'</span></code> mode lets device detect color temperature) or focus (<code class="docutils literal notranslate"><span class="pre">'auto'</span></code> enables continuous autofocus). If auto is not supported, the method returns False silently, allowing callers to fall back to manual adjustment.</p>
</section>
<section id="get-dynamic-range-dynamic-range-querying-with-fallbacks">
<h3><code class="docutils literal notranslate"><span class="pre">_get_dynamic_range()</span></code> dynamic range querying with fallbacks<a class="headerlink" href="#get-dynamic-range-dynamic-range-querying-with-fallbacks" title="Link to this heading">¶</a></h3>
<p>Camera properties have min/max ranges (e.g., brightness 0-255, pan -180 to +180). This method queries the device for actual supported ranges. If the device doesn’t report ranges (older cameras), it falls back to predefined class constants.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_get_dynamic_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fallback_min</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
</span><span data-line="2">                       <span class="n">fallback_max</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get property range from device, or use fallback constants.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="5">        <span class="n">prop_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property_range</span><span class="p">(</span><span class="n">property_name</span><span class="p">)</span>
</span><span data-line="6">        <span class="k">if</span> <span class="n">prop_range</span><span class="p">:</span>
</span><span data-line="7">            <span class="k">return</span> <span class="p">(</span><span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="n">prop_range</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
</span><span data-line="8">    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span data-line="9">        <span class="k">pass</span>  <span class="c1"># Device query failed; use fallback</span>
</span><span data-line="10">    
</span><span data-line="11">    <span class="c1"># Return predefined fallback values</span>
</span><span data-line="12">    <span class="k">return</span> <span class="p">(</span><span class="n">fallback_min</span><span class="p">,</span> <span class="n">fallback_max</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Fallback mechanism</strong>:</p>
<ol class="arabic simple">
<li><p>First attempt: Query the device directly via <code class="docutils literal notranslate"><span class="pre">get_property_range()</span></code>. Modern cameras respond with actual supported ranges.</p></li>
<li><p>Query fails or returns None: Use predefined fallback ranges (brightness 0-255, pan -180/+180, etc.). These are safe conservative defaults based on typical camera specs.</p></li>
<li><p>Why fallbacks matter: Older or simple cameras may not support range queries. Without fallbacks, the code would crash when trying to set properties. With fallbacks, it succeeds using sensible defaults.</p></li>
</ol>
<p>Example: <code class="docutils literal notranslate"><span class="pre">_get_dynamic_range('brightness',</span> <span class="pre">0,</span> <span class="pre">255)</span></code> first asks the device “what’s your brightness range?” If the device doesn’t answer, it returns (0, 255).</p>
</section>
<section id="get-video-property-result-api-delegation">
<h3><code class="docutils literal notranslate"><span class="pre">_get_video_property()</span></code> Result API delegation<a class="headerlink" href="#get-video-property-result-api-delegation" title="Link to this heading">¶</a></h3>
<p>Wrapper around the low-level C++ Result API for reading video properties. Converts property name (string) to the C++ enum, then calls the Result API.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_get_video_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read video property via Result API. Returns Result&lt;PropSetting&gt;.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">prop_enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property_name_to_enum</span><span class="p">(</span><span class="s1">&#39;video&#39;</span><span class="p">,</span> <span class="n">property_name</span><span class="p">)</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_enum</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Returns a <code class="docutils literal notranslate"><span class="pre">Result</span></code> object (either ok with a <code class="docutils literal notranslate"><span class="pre">PropSetting</span></code> value, or error with error details). Allows fine-grained error handling without exceptions.</p>
</section>
<section id="set-video-property-result-api-delegation">
<h3><code class="docutils literal notranslate"><span class="pre">_set_video_property()</span></code> Result API delegation<a class="headerlink" href="#set-video-property-result-api-delegation" title="Link to this heading">¶</a></h3>
<p>Wrapper for setting video properties via the Result API. Takes a property name and a <code class="docutils literal notranslate"><span class="pre">PropSetting</span></code> object (which includes value and mode).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_set_video_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">setting</span><span class="p">:</span> <span class="n">PropSetting</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write video property via Result API. Returns Result&lt;None&gt;.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">prop_enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property_name_to_enum</span><span class="p">(</span><span class="s1">&#39;video&#39;</span><span class="p">,</span> <span class="n">property_name</span><span class="p">)</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_enum</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="get-camera-property-result-api-delegation">
<h3><code class="docutils literal notranslate"><span class="pre">_get_camera_property()</span></code> Result API delegation<a class="headerlink" href="#get-camera-property-result-api-delegation" title="Link to this heading">¶</a></h3>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">_get_video_property()</span></code>, but for camera properties (pan, tilt, zoom, etc.). Returns <code class="docutils literal notranslate"><span class="pre">Result&lt;PropSetting&gt;</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_get_camera_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read camera property via Result API.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">prop_enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property_name_to_enum</span><span class="p">(</span><span class="s1">&#39;camera&#39;</span><span class="p">,</span> <span class="n">property_name</span><span class="p">)</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_enum</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="set-camera-property-result-api-delegation">
<h3><code class="docutils literal notranslate"><span class="pre">_set_camera_property()</span></code> Result API delegation<a class="headerlink" href="#set-camera-property-result-api-delegation" title="Link to this heading">¶</a></h3>
<p>Wrapper for setting camera properties. Takes property name and <code class="docutils literal notranslate"><span class="pre">PropSetting</span></code>, returns <code class="docutils literal notranslate"><span class="pre">Result&lt;None&gt;</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">_set_camera_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">setting</span><span class="p">:</span> <span class="n">PropSetting</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write camera property via Result API.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">prop_enum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property_name_to_enum</span><span class="p">(</span><span class="s1">&#39;camera&#39;</span><span class="p">,</span> <span class="n">property_name</span><span class="p">)</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_camera</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop_enum</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Why these wrappers exist</strong>: The underlying C++ API works with enums and Result types. The Pythonic layer translates user-friendly strings into these low-level types. These methods bridge that gap, converting names and routing calls appropriately while keeping the core clean.</p>
</section>
<section id="to-string-enum-conversion-utility">
<h3><code class="docutils literal notranslate"><span class="pre">to_string()</span></code> enum conversion utility<a class="headerlink" href="#to-string-enum-conversion-utility" title="Link to this heading">¶</a></h3>
<p>Module-level function converting C++ enums to human-readable strings. Useful for debugging, logging, or displaying enum values to users.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">to_string</span><span class="p">(</span><span class="n">enum_val</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert enum to lowercase string representation.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="n">enum_val</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">enum_val</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">enum_val</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">to_string(duvc.VidProp.Brightness)</span></code> → <code class="docutils literal notranslate"><span class="pre">'brightness'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_string(duvc.CamProp.Pan)</span></code> → <code class="docutils literal notranslate"><span class="pre">'pan'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_string(duvc.CamMode.Auto)</span></code> → <code class="docutils literal notranslate"><span class="pre">'auto'</span></code></p></li>
</ul>
<p>Useful when building error messages or logging which property failed.</p>
</section>
</section>
<hr class="docutils" />
<section id="special-methods-pythonic-features">
<h2>3.20 Special Methods &amp; Pythonic Features<a class="headerlink" href="#special-methods-pythonic-features" title="Link to this heading">¶</a></h2>
<p>Python special methods (magic methods starting with <code class="docutils literal notranslate"><span class="pre">__</span></code>) enable intuitive, idiomatic usage of the <code class="docutils literal notranslate"><span class="pre">CameraController</span></code> class. These make the library feel like a native Python library rather than a thin C++ wrapper.</p>
<section id="enter-exit-context-manager-protocol">
<h3><code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> context manager protocol<a class="headerlink" href="#enter-exit-context-manager-protocol" title="Link to this heading">¶</a></h3>
<p>These methods enable the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement, providing automatic resource management. When you enter a <code class="docutils literal notranslate"><span class="pre">with</span></code> block, <code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> is called (acquiring the camera connection). When you exit (whether normally or via exception), <code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> is called (releasing resources). This ensures cleanup happens even if errors occur.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called when entering &#39;with&#39; block.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>  <span class="c1"># Open device connection</span>
</span><span data-line="4">    <span class="k">return</span> <span class="bp">self</span>     <span class="c1"># Return the controller instance</span>
</span><span data-line="5">
</span><span data-line="6"><span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
</span><span data-line="7"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called when exiting &#39;with&#39; block (always, even on exception).&quot;&quot;&quot;</span>
</span><span data-line="8">    <span class="bp">self</span><span class="o">.</span><span class="n">close_with_validation</span><span class="p">()</span>  <span class="c1"># Clean shutdown</span>
</span><span data-line="9">    <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Propagate exceptions (don&#39;t suppress them)</span>
</span></pre></div>
</div>
<p><strong>Usage pattern</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">with</span> <span class="n">CameraController</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">75</span>
</span><span data-line="3">    <span class="n">cam</span><span class="o">.</span><span class="n">pan</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="4"><span class="c1"># Connection automatically closed here, even if exception occurred above</span>
</span></pre></div>
</div>
<p>This is Python best practice. Instead of manually calling <code class="docutils literal notranslate"><span class="pre">cam.connect()</span></code> and <code class="docutils literal notranslate"><span class="pre">cam.close()</span></code>, the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement handles it. If an exception occurs inside the block, the connection is still properly cleaned up.</p>
</section>
<section id="str-user-friendly-representation">
<h3><code class="docutils literal notranslate"><span class="pre">__str__()</span></code> user-friendly representation<a class="headerlink" href="#str-user-friendly-representation" title="Link to this heading">¶</a></h3>
<p>Returns a human-readable summary of the camera state. Called when you print the controller or convert it to a string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return user-friendly string representation.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;connected&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span> <span class="k">else</span> <span class="s2">&quot;disconnected&quot;</span>
</span><span data-line="4">    <span class="n">prop_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_properties</span><span class="p">())</span>
</span><span data-line="5">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;CameraController: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">prop_count</span><span class="si">}</span><span class="s2"> properties)&gt;&quot;</span>
</span></pre></div>
</div>
<p>Example output: <code class="docutils literal notranslate"><span class="pre">&lt;CameraController:</span> <span class="pre">Logitech</span> <span class="pre">C920</span> <span class="pre">(connected,</span> <span class="pre">42</span> <span class="pre">properties)&gt;</span></code></p>
<p><strong>Usage</strong>: <code class="docutils literal notranslate"><span class="pre">print(cam)</span></code> or <code class="docutils literal notranslate"><span class="pre">str(cam)</span></code> displays this summary, making it easy to inspect camera state at a glance.</p>
</section>
<section id="repr-detailed-representation">
<h3><code class="docutils literal notranslate"><span class="pre">__repr__()</span></code> detailed representation<a class="headerlink" href="#repr-detailed-representation" title="Link to this heading">¶</a></h3>
<p>Returns a technical representation useful for debugging. More detailed than <code class="docutils literal notranslate"><span class="pre">__str__()</span></code>, includes the device path and internal state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return detailed string for debugging.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CameraController(path=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_path</span><span class="si">!r}</span><span class="s2">, &quot;</span>
</span><span data-line="4">            <span class="sa">f</span><span class="s2">&quot;connected=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="si">}</span><span class="s2">, name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device_name</span><span class="si">!r}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Example output: <code class="docutils literal notranslate"><span class="pre">CameraController(path='/dev/video0',</span> <span class="pre">connected=True,</span> <span class="pre">name='Logitech</span> <span class="pre">C920')</span></code></p>
<p><strong>Usage</strong>: <code class="docutils literal notranslate"><span class="pre">repr(cam)</span></code> or in interactive Python shells where you want detailed debug info.</p>
</section>
<section id="bool-truthiness-evaluation">
<h3><code class="docutils literal notranslate"><span class="pre">__bool__()</span></code> truthiness evaluation<a class="headerlink" href="#bool-truthiness-evaluation" title="Link to this heading">¶</a></h3>
<p>Makes the camera object evaluate to True if connected, False if disconnected. Enables intuitive conditional checks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span data-line="2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Camera is &#39;truthy&#39; if connected and responsive.&quot;&quot;&quot;</span>
</span><span data-line="3">    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span>
</span></pre></div>
</div>
<p><strong>Usage examples</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">if</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="2">    <span class="n">cam</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># Only runs if camera is connected</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">if</span> <span class="ow">not</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera disconnected&quot;</span><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Safe pattern: check connection before using</span>
</span><span data-line="8"><span class="k">try</span><span class="p">:</span>
</span><span data-line="9">    <span class="k">with</span> <span class="n">CameraController</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="10">        <span class="k">if</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="11">            <span class="c1"># Do camera operations</span>
</span><span data-line="12">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="13">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera failed to connect&quot;</span><span class="p">)</span>
</span><span data-line="14"><span class="k">except</span> <span class="n">DeviceNotFoundError</span><span class="p">:</span>
</span><span data-line="15">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No cameras found&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><strong>Why this matters</strong>: This makes code more Pythonic and readable. Instead of <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">cam.is_connected:</span></code>, you can write <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">cam:</span></code>. It feels natural because Python developers expect objects to evaluate to True/False based on meaningful state.</p>
</section>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="02_architecture-design-overview.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">2. Architecture &amp; Design Overview</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="04_result-based-api-explicit-error-handling.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">4. Result-Based API - Explicit Error Handling</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2025, allanhanan</p>
  
  <p>
    Made with
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/allanhanan/duvc-ctl" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../../../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=5375a926"></script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../../../_static/shibuya.js?v=c1cf1a6b"></script></body>
</html>