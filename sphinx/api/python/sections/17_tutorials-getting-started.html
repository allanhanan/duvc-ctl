<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../../../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>17. Tutorials &amp; Getting Started - duvc-ctl v2.0.0 Documentation</title><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="C++ Examples" href="../../../examples/cpp-examples.html" /><link rel="prev" title="16. Architecture Decision Records" href="16_architecture-decision-records.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=43bd62f4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/shibuya.css?v=14737038" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../../../_static/print.css?v=20ff2c19" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="17. Tutorials &amp; Getting Started"/>
    <meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../../../index.html">
      
      
      <strong>duvc-ctl</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials">
  <a href="https://github.com/allanhanan/duvc-ctl" aria-label="GitHub">
    <iconify-icon icon="simple-icons:github"></iconify-icon>
  </a></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user-guide/quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user-guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user-guide/migration.html">Migration</a></li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../c/index.html">duvc-ctl C API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/index.html">duvc-ctl C++ API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/01_overview-getting-started.html">1. Overview &amp; Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/02_core-api-public-headers.html">2. Core API - Public Headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/03_utility-functions-helpers.html">3. Utility Functions &amp; Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/04_platform-abstraction-layer.html">4. Platform Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/05_vendor-specific-extensions.html">5. Vendor-Specific Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/06_internal-implementation-details.html">6. Internal Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/07_property-reference-details.html">7. Property Reference &amp; Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/08_usage-patterns-best-practices.html">8. Usage Patterns &amp; Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/09_build-system-integration.html">9. Build System &amp; Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/10_platform-specific-information.html">10. Platform-Specific Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/11_device-support-compatibility.html">11. Device Support &amp; Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/12_troubleshooting-debugging.html">12. Troubleshooting &amp; Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/13_examples-tutorials.html">13. Examples &amp; Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/14_contributing-extending.html">14. Contributing &amp; Extending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/15_faq.html">15. FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/sections/16_appendices.html">16. Appendices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">duvc-ctl CLI Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">duvc-ctl Python Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_quick-start-installation.html">1. Quick Start &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_architecture-design-overview.html">2. Architecture &amp; Design Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_pythonic-api-cameracontroller-class.html">3. Pythonic API - CameraController Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_result-based-api-explicit-error-handling.html">4. Result-Based API - Explicit Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_comprehensive-type-reference.html">5. Comprehensive Type Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_enumeration-constant-reference.html">6. Enumeration &amp; Constant Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_exception-hierarchy-handling.html">7. Exception Hierarchy &amp; Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_convenience-functions-helpers.html">8. Convenience Functions &amp; Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_logging-diagnostics-callbacks.html">9. Logging, Diagnostics &amp; Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_vendor-specific-extensions.html">10. Vendor-Specific Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_building-contributing-pybind11-integration.html">11. Building, Contributing &amp; pybind11 Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_complete-property-reference-details.html">12. Complete Property Reference &amp; Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_common-patterns-recipes.html">13. Common Patterns &amp; Recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_troubleshooting-faqs.html">14. Troubleshooting &amp; FAQs</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_advanced-architecture-special-methods.html">15. Advanced Architecture &amp; Special Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_architecture-decision-records.html">16. Architecture Decision Records</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">17. Tutorials &amp; Getting Started</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/cpp-examples.html">C++ Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/python-examples.html">Python Examples</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3></div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../../index.html"><span itemprop="name">duvc-ctl</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">duvc-ctl Python Documentation</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">17. Tutorials &amp; Getting Started</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <section id="tutorials-getting-started">
<h1>17. Tutorials &amp; Getting Started<a class="headerlink" href="#tutorials-getting-started" title="Link to this heading">¶</a></h1>
<section id="beginner-tutorial">
<h2>17.1 Beginner Tutorial<a class="headerlink" href="#beginner-tutorial" title="Link to this heading">¶</a></h2>
<section id="beginners-guide-to-duvc-ctl-control-your-usb-camera-from-python">
<h3>Beginner’s Guide to duvc-ctl: Control Your USB Camera from Python<a class="headerlink" href="#beginners-guide-to-duvc-ctl-control-your-usb-camera-from-python" title="Link to this heading">¶</a></h3>
<p>duvc-ctl is a Windows library that lets you control USB cameras (like webcams or PTZ cameras) directly from Python code. Instead of fiddling with Windows settings or clunky GUI tools, you can write simple scripts to adjust brightness, zoom, focus, and more.</p>
</section>
<section id="installation-2-minutes">
<h3>Installation (2 minutes)<a class="headerlink" href="#installation-2-minutes" title="Link to this heading">¶</a></h3>
<p>duvc-ctl works on Windows 10/11 with Python 3.8+. That’s it—no extra drivers needed since your camera already works in Windows.</p>
<p>Open your terminal and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">pip</span> <span class="n">install</span> <span class="n">duvc</span><span class="o">-</span><span class="n">ctl</span>
</span></pre></div>
</div>
<p>Verify it worked:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;import duvc_ctl; print(duvc_ctl.__version__)&quot;</span>
</span></pre></div>
</div>
<p>If you see a version number like “2.0.0”, you’re good. If you get an import error, make sure you’re on Windows and Python 3.8+.</p>
</section>
<section id="your-first-program">
<h3>Your First Program<a class="headerlink" href="#your-first-program" title="Link to this heading">¶</a></h3>
<p>Here’s the simplest working example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="c1"># Get list of cameras connected</span>
</span><span data-line="4"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="5"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span><span class="si">}</span><span class="s2"> camera(s)&quot;</span><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Show each camera&#39;s name</span>
</span><span data-line="8"><span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="9">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">device</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Run this. It should print your camera name. If nothing appears, plug in a USB camera and try again.</p>
</section>
<section id="reading-camera-settings">
<h3>Reading Camera Settings<a class="headerlink" href="#reading-camera-settings" title="Link to this heading">¶</a></h3>
<p>Once you have a camera, you can read its current brightness:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="4"><span class="k">if</span> <span class="ow">not</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No cameras found&quot;</span><span class="p">)</span>
</span><span data-line="6">    <span class="n">exit</span><span class="p">()</span>
</span><span data-line="7">
</span><span data-line="8"><span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="o">^</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Open first camera</span>
</span><span data-line="9">
</span><span data-line="10"><span class="c1"># Read brightness</span>
</span><span data-line="11"><span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="14">    <span class="c1"># Success—we got the brightness value</span>
</span><span data-line="15">    <span class="n">brightness</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="16">    <span class="n">mode</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">mode</span>  <span class="c1"># &quot;Manual&quot; or &quot;Auto&quot;</span>
</span><span data-line="17">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">brightness</span><span class="si">}</span><span class="s2"> (Mode: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="18"><span class="k">else</span><span class="p">:</span>
</span><span data-line="19">    <span class="c1"># Camera doesn&#39;t support brightness or it failed</span>
</span><span data-line="20">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">result.is_ok</span></code> check is crucial—it tells you if the operation succeeded. If it didn’t, <code class="docutils literal notranslate"><span class="pre">result.error</span></code> has the reason.</p>
</section>
<section id="changing-camera-settings">
<h3>Changing Camera Settings<a class="headerlink" href="#changing-camera-settings" title="Link to this heading">¶</a></h3>
<p>To change brightness to 150:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="4"><span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="o">^</span><span class="mi">0</span><span class="p">])</span>
</span><span data-line="5">
</span><span data-line="6"><span class="c1"># Create a new setting</span>
</span><span data-line="7"><span class="n">setting</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Apply it</span>
</span><span data-line="10"><span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="11">
</span><span data-line="12"><span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="13">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Brightness set to 150&quot;</span><span class="p">)</span>
</span><span data-line="14"><span class="k">else</span><span class="p">:</span>
</span><span data-line="15">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">PropSetting</span></code> takes two things: the value (0–255 typically) and the mode (Manual for user control, Auto for the camera to decide).</p>
</section>
<section id="common-properties-you-can-control">
<h3>Common Properties You Can Control<a class="headerlink" href="#common-properties-you-can-control" title="Link to this heading">¶</a></h3>
<p><strong>Camera properties</strong> (Pan, Tilt, Zoom, Focus, Exposure):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Zoom</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">))</span>
</span></pre></div>
</div>
<p><strong>Video/Image properties</strong> (Brightness, Contrast, Saturation, Hue):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">))</span>
</span></pre></div>
</div>
<p>Not all cameras support all properties—if you set something unsupported, you’ll get an error message.</p>
</section>
<section id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h3>
<p>Three things commonly fail:</p>
<ol class="arabic simple">
<li><p><strong>Camera disconnected</strong>: <code class="docutils literal notranslate"><span class="pre">DeviceNotFoundError</span></code> — plug camera back in.</p></li>
<li><p><strong>Camera busy</strong>: <code class="docutils literal notranslate"><span class="pre">DeviceBusyError</span></code> — close other apps using the camera (like Zoom, Teams, etc.).</p></li>
<li><p><strong>Property not supported</strong>: <code class="docutils literal notranslate"><span class="pre">PropertyNotSupportedError</span></code> — your camera model doesn’t have that feature. Check what it supports by querying ranges first.</p></li>
</ol>
<p>To find what your camera supports:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="n">caps</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">get_device_capabilities</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="2"><span class="k">if</span> <span class="n">caps</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="3">    <span class="n">capabilities</span> <span class="o">=</span> <span class="n">caps</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="4">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera properties:&quot;</span><span class="p">,</span> <span class="n">capabilities</span><span class="o">.</span><span class="n">supported_camera_properties</span><span class="p">)</span>
</span><span data-line="5">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Video properties:&quot;</span><span class="p">,</span> <span class="n">capabilities</span><span class="o">.</span><span class="n">supported_video_properties</span><span class="p">)</span>
</span></pre></div>
</div>
<p>This shows exactly which controls your camera has.</p>
</section>
<section id="two-ways-to-write-code">
<h3>Two Ways to Write Code<a class="headerlink" href="#two-ways-to-write-code" title="Link to this heading">¶</a></h3>
<p><strong>Simple (exceptions)</strong> — easier for quick scripts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="kn">import</span> <span class="n">CameraController</span>
</span><span data-line="2"><span class="n">cam</span> <span class="o">=</span> <span class="n">CameraController</span><span class="p">()</span>
</span><span data-line="3"><span class="n">cam</span><span class="o">.</span><span class="n">set_brightness</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>  <span class="c1"># Raises exception if it fails</span>
</span></pre></div>
</div>
<p><strong>Explicit (Result types)</strong> — more control for production apps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2"><span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="3"><span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="4">    <span class="c1"># succeeded</span>
</span><span data-line="5"><span class="k">else</span><span class="p">:</span>
</span><span data-line="6">    <span class="c1"># handle error with result.error.code</span>
</span></pre></div>
</div>
<p>For beginners, start with the simple version. Once comfortable, switch to Result types for better error messages. Both work identically underneath.</p>
</section>
<section id="next-steps">
<h3>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Read a property and print its range to find valid values</p></li>
<li><p>Loop through all cameras and adjust each one</p></li>
<li><p>Combine camera control with your own image capture code using OpenCV</p></li>
<li><p>Check the full documentation for vendor-specific properties like Logitech RightLight</p></li>
</ul>
<p>You now have everything needed to start controlling cameras from Python!</p>
</section>
</section>
<section id="intermediate-patterns">
<h2>17.2 Intermediate Patterns<a class="headerlink" href="#intermediate-patterns" title="Link to this heading">¶</a></h2>
<section id="intermediate-patterns-getting-smart-with-camera-control">
<h3>Intermediate Patterns: Getting Smart with Camera Control<a class="headerlink" href="#intermediate-patterns-getting-smart-with-camera-control" title="Link to this heading">¶</a></h3>
<p>Once you’re comfortable opening cameras and reading properties, the next level involves reusable patterns for real-world applications. These techniques handle multiple cameras, deal with reconnection, save camera states, and manage code complexity.</p>
</section>
<section id="context-managers-the-clean-way-to-handle-cameras">
<h3>Context Managers: The Clean Way to Handle Cameras<a class="headerlink" href="#context-managers-the-clean-way-to-handle-cameras" title="Link to this heading">¶</a></h3>
<p>Every time you open a camera, you need to close it properly—otherwise Windows keeps the device locked and your next script fails. Python’s context manager (<code class="docutils literal notranslate"><span class="pre">with</span></code> statement) handles this automatically:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="4"><span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="5">    <span class="c1"># Camera opens here</span>
</span><span data-line="6">    <span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">camera</span><span class="p">:</span>
</span><span data-line="7">        <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="8">        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="9">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="10">    <span class="c1"># Camera closes here automatically</span>
</span></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">with</span></code> block ensures the camera closes even if an error happens. You don’t need to write cleanup code. This becomes critical when you have multiple cameras or run scripts frequently—forgotten close calls lock up your camera.</p>
</section>
<section id="device-enumeration-listing-all-connected-cameras">
<h3>Device Enumeration: Listing All Connected Cameras<a class="headerlink" href="#device-enumeration-listing-all-connected-cameras" title="Link to this heading">¶</a></h3>
<p>Real cameras get plugged in and unplugged. Your script needs to handle this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">def</span><span class="w"> </span><span class="nf">list_and_describe_cameras</span><span class="p">():</span>
</span><span data-line="4">    <span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="5">    <span class="k">if</span> <span class="ow">not</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="6">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No cameras connected&quot;</span><span class="p">)</span>
</span><span data-line="7">        <span class="k">return</span>
</span><span data-line="8">    
</span><span data-line="9">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">devices</span><span class="p">):</span>
</span><span data-line="10">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">device</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="11">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Path: </span><span class="si">{</span><span class="n">device</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="12">        
</span><span data-line="13">        <span class="c1"># Try to open and check capabilities</span>
</span><span data-line="14">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="15">            <span class="n">caps</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">get_device_capabilities</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="16">            <span class="k">if</span> <span class="n">caps</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="17">                <span class="n">cap</span> <span class="o">=</span> <span class="n">caps</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="18">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Camera props: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cap</span><span class="o">.</span><span class="n">supported_camera_properties</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="19">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Video props: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cap</span><span class="o">.</span><span class="n">supported_video_properties</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="20">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="21">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    (unavailable: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="n">list_and_describe_cameras</span><span class="p">()</span>
</span></pre></div>
</div>
<p>This gives users a menu to pick which camera to use. When cameras aren’t available (plugged in elsewhere, different USB port), they simply don’t appear in the list.</p>
</section>
<section id="bulk-operations-set-multiple-properties-at-once">
<h3>Bulk Operations: Set Multiple Properties at Once<a class="headerlink" href="#bulk-operations-set-multiple-properties-at-once" title="Link to this heading">¶</a></h3>
<p>Instead of setting brightness, contrast, saturation one-by-one (slow), batch them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">def</span><span class="w"> </span><span class="nf">apply_preset_daylight</span><span class="p">(</span><span class="n">camera</span><span class="p">):</span>
</span><span data-line="4"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set camera for outdoor daylight conditions.&quot;&quot;&quot;</span>
</span><span data-line="5">    <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="6">        <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">),</span>
</span><span data-line="7">        <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">),</span>
</span><span data-line="8">        <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">),</span>
</span><span data-line="9">        <span class="n">duvc</span><span class="o">.</span><span class="n">CamProp</span><span class="o">.</span><span class="n">Exposure</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">),</span>
</span><span data-line="10">    <span class="p">}</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="n">failed</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="13">    <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="14">        <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="15">        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="16">            <span class="n">failed</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prop</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="p">))</span>
</span><span data-line="17">    
</span><span data-line="18">    <span class="k">if</span> <span class="n">failed</span><span class="p">:</span>
</span><span data-line="19">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to set:&quot;</span><span class="p">)</span>
</span><span data-line="20">        <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">failed</span><span class="p">:</span>
</span><span data-line="21">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="22">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="23">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Daylight preset applied successfully&quot;</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="26"><span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="27">    <span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="28">        <span class="n">apply_preset_daylight</span><span class="p">(</span><span class="n">cam</span><span class="p">)</span>
</span></pre></div>
</div>
<p>This pattern is reusable—create a preset function for “video conference mode,” “streaming,” etc., and call it anytime.</p>
</section>
<section id="presets-save-and-restore-camera-states">
<h3>Presets: Save and Restore Camera States<a class="headerlink" href="#presets-save-and-restore-camera-states" title="Link to this heading">¶</a></h3>
<p>Your users tweak settings to get perfect image quality. Let them save this as a preset so they can restore it later:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">def</span><span class="w"> </span><span class="nf">save_preset</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Capture all current camera settings to a JSON file.&quot;&quot;&quot;</span>
</span><span data-line="6">    <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="7">    
</span><span data-line="8">    <span class="c1"># Define which properties to save</span>
</span><span data-line="9">    <span class="n">props_to_save</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="10">        <span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="s2">&quot;brightness&quot;</span><span class="p">),</span>
</span><span data-line="11">        <span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span> <span class="s2">&quot;contrast&quot;</span><span class="p">),</span>
</span><span data-line="12">        <span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">,</span> <span class="s2">&quot;saturation&quot;</span><span class="p">),</span>
</span><span data-line="13">        <span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Gamma</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">),</span>
</span><span data-line="14">    <span class="p">]</span>
</span><span data-line="15">    
</span><span data-line="16">    <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">props_to_save</span><span class="p">:</span>
</span><span data-line="17">        <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
</span><span data-line="18">        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="19">            <span class="n">setting</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="20">            <span class="n">state</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="21">                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">setting</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span data-line="22">                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">setting</span><span class="o">.</span><span class="n">mode</span>
</span><span data-line="23">            <span class="p">}</span>
</span><span data-line="24">    
</span><span data-line="25">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="26">        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="27">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preset saved to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="k">def</span><span class="w"> </span><span class="nf">load_preset</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span data-line="30"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Restore camera settings from a JSON preset.&quot;&quot;&quot;</span>
</span><span data-line="31">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="32">        <span class="n">state</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span data-line="33">    
</span><span data-line="34">    <span class="c1"># Map names back to properties</span>
</span><span data-line="35">    <span class="n">prop_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="36">        <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span>
</span><span data-line="37">        <span class="s2">&quot;contrast&quot;</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span>
</span><span data-line="38">        <span class="s2">&quot;saturation&quot;</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Saturation</span><span class="p">,</span>
</span><span data-line="39">        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Gamma</span><span class="p">,</span>
</span><span data-line="40">    <span class="p">}</span>
</span><span data-line="41">    
</span><span data-line="42">    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="43">        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prop_map</span><span class="p">:</span>
</span><span data-line="44">            <span class="k">continue</span>
</span><span data-line="45">        <span class="n">prop</span> <span class="o">=</span> <span class="n">prop_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span data-line="46">        <span class="n">setting</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">])</span>
</span><span data-line="47">        <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="48">        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="49">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Failed to set </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="50">
</span><span data-line="51"><span class="c1"># Usage:</span>
</span><span data-line="52"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="53"><span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="54">    <span class="k">with</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
</span><span data-line="55">        <span class="c1"># User tweaks settings, then...</span>
</span><span data-line="56">        <span class="n">save_preset</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s2">&quot;my_preset.json&quot;</span><span class="p">)</span>
</span><span data-line="57">        
</span><span data-line="58">        <span class="c1"># Later session, restore:</span>
</span><span data-line="59">        <span class="n">load_preset</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="s2">&quot;my_preset.json&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Now users can share presets: “here’s my Twitch streaming config” as a single JSON file.</p>
</section>
<section id="connection-recovery-handle-cameras-that-disconnect">
<h3>Connection Recovery: Handle Cameras That Disconnect<a class="headerlink" href="#connection-recovery-handle-cameras-that-disconnect" title="Link to this heading">¶</a></h3>
<p>Real USB cameras can glitch or get unplugged. Your app should survive this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">def</span><span class="w"> </span><span class="nf">reconnect_with_retry</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Try to reconnect to a camera, retrying if it fails.&quot;&quot;&quot;</span>
</span><span data-line="6">    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_retries</span><span class="p">):</span>
</span><span data-line="7">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="8">            <span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="9">            <span class="c1"># Quick health check</span>
</span><span data-line="10">            <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="11">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="12">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reconnected on attempt </span><span class="si">{</span><span class="n">attempt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="13">                <span class="k">return</span> <span class="n">camera</span>
</span><span data-line="14">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="15">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempt </span><span class="si">{</span><span class="n">attempt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="16">            <span class="k">if</span> <span class="n">attempt</span> <span class="o">&lt;</span> <span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span data-line="17">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrying in </span><span class="si">{</span><span class="n">delay</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>
</span><span data-line="18">                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
</span><span data-line="19">    
</span><span data-line="20">    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to reconnect after </span><span class="si">{</span><span class="n">max_retries</span><span class="si">}</span><span class="s2"> attempts&quot;</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22"><span class="c1"># Usage in your monitoring loop:</span>
</span><span data-line="23"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="24"><span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="25">    <span class="n">device</span> <span class="o">=</span> <span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span data-line="26">    <span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="27">    
</span><span data-line="28">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="29">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span data-line="30">            <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="31">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="32">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="33">            <span class="k">else</span><span class="p">:</span>
</span><span data-line="34">                <span class="c1"># Camera might have disconnected</span>
</span><span data-line="35">                <span class="k">if</span> <span class="s2">&quot;not found&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
</span><span data-line="36">                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Camera disconnected, attempting reconnect...&quot;</span><span class="p">)</span>
</span><span data-line="37">                    <span class="n">camera</span> <span class="o">=</span> <span class="n">reconnect_with_retry</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="38">                    <span class="k">continue</span>
</span><span data-line="39">            
</span><span data-line="40">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="41">    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span data-line="42">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stopped&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>This prevents your script from crashing mid-stream if the camera temporarily loses USB power.</p>
</section>
<section id="real-world-example-building-a-camera-streamer">
<h3>Real-World Example: Building a Camera Streamer<a class="headerlink" href="#real-world-example-building-a-camera-streamer" title="Link to this heading">¶</a></h3>
<p>Here’s how to combine these patterns into a production-like application:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span data-line="3"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span data-line="4"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span data-line="5">
</span><span data-line="6"><span class="k">class</span><span class="w"> </span><span class="nc">CameraStreamer</span><span class="p">:</span>
</span><span data-line="7">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">preset_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span data-line="8">        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
</span><span data-line="9">        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="10">        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="11">        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span><span data-line="12">        
</span><span data-line="13">        <span class="k">if</span> <span class="n">preset_file</span><span class="p">:</span>
</span><span data-line="14">            <span class="bp">self</span><span class="o">.</span><span class="n">preset_file</span> <span class="o">=</span> <span class="n">preset_file</span>
</span><span data-line="15">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="16">            <span class="bp">self</span><span class="o">.</span><span class="n">preset_file</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="17">    
</span><span data-line="18">    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="19"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open camera and load preset if available.&quot;&quot;&quot;</span>
</span><span data-line="20">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="21">            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="22">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preset_file</span><span class="p">:</span>
</span><span data-line="23">                <span class="bp">self</span><span class="o">.</span><span class="n">_load_preset</span><span class="p">()</span>
</span><span data-line="24">            <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="25">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Streamer started: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="26">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="27">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to start: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="28">            <span class="k">raise</span>
</span><span data-line="29">    
</span><span data-line="30">    <span class="k">def</span><span class="w"> </span><span class="nf">_load_preset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="31"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load settings from preset file.&quot;&quot;&quot;</span>
</span><span data-line="32">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="33">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preset_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="34">                <span class="n">state</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span data-line="35">            
</span><span data-line="36">            <span class="n">prop_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="37">                <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span>
</span><span data-line="38">                <span class="s2">&quot;contrast&quot;</span><span class="p">:</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">,</span>
</span><span data-line="39">            <span class="p">}</span>
</span><span data-line="40">            
</span><span data-line="41">            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="42">                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prop_map</span><span class="p">:</span>
</span><span data-line="43">                    <span class="k">continue</span>
</span><span data-line="44">                <span class="n">prop</span> <span class="o">=</span> <span class="n">prop_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span data-line="45">                <span class="n">setting</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">])</span>
</span><span data-line="46">                <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="47">            
</span><span data-line="48">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preset loaded from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">preset_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="49">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="50">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not load preset: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="51">    
</span><span data-line="52">    <span class="k">def</span><span class="w"> </span><span class="nf">adjust_brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span data-line="53"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Thread-safe brightness adjustment.&quot;&quot;&quot;</span>
</span><span data-line="54">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
</span><span data-line="55">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>
</span><span data-line="56">                <span class="n">setting</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">)</span>
</span><span data-line="57">                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="58">                <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span>
</span><span data-line="59">        <span class="k">return</span> <span class="kc">False</span>
</span><span data-line="60">    
</span><span data-line="61">    <span class="k">def</span><span class="w"> </span><span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="62"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current camera state.&quot;&quot;&quot;</span>
</span><span data-line="63">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
</span><span data-line="64">            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>
</span><span data-line="65">                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;offline&quot;</span><span class="p">}</span>
</span><span data-line="66">            
</span><span data-line="67">            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="68">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="69">                <span class="k">return</span> <span class="p">{</span>
</span><span data-line="70">                    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;online&quot;</span><span class="p">,</span>
</span><span data-line="71">                    <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span data-line="72">                    <span class="s2">&quot;camera&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">name</span>
</span><span data-line="73">                <span class="p">}</span>
</span><span data-line="74">            <span class="k">else</span><span class="p">:</span>
</span><span data-line="75">                <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="p">}</span>
</span><span data-line="76">    
</span><span data-line="77">    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="78"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Close camera.&quot;&quot;&quot;</span>
</span><span data-line="79">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
</span><span data-line="80">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">:</span>
</span><span data-line="81">                <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="82">                <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="83">                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Streamer stopped&quot;</span><span class="p">)</span>
</span><span data-line="84">
</span><span data-line="85"><span class="c1"># Usage:</span>
</span><span data-line="86"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span data-line="87">    <span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="88">    <span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="89">        <span class="n">streamer</span> <span class="o">=</span> <span class="n">CameraStreamer</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">preset_file</span><span class="o">=</span><span class="s2">&quot;streaming_preset.json&quot;</span><span class="p">)</span>
</span><span data-line="90">        <span class="n">streamer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="91">        
</span><span data-line="92">        <span class="c1"># Adjust via UI or API</span>
</span><span data-line="93">        <span class="n">streamer</span><span class="o">.</span><span class="n">adjust_brightness</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
</span><span data-line="94">        
</span><span data-line="95">        <span class="c1"># Poll status</span>
</span><span data-line="96">        <span class="nb">print</span><span class="p">(</span><span class="n">streamer</span><span class="o">.</span><span class="n">get_status</span><span class="p">())</span>
</span><span data-line="97">        
</span><span data-line="98">        <span class="n">streamer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span></pre></div>
</div>
<p>This object-oriented approach handles threading safely, survives disconnections gracefully, and scales to manage multiple cameras.</p>
</section>
</section>
<section id="advanced-workflows">
<h2>17.3 Advanced Workflows<a class="headerlink" href="#advanced-workflows" title="Link to this heading">¶</a></h2>
<section id="advanced-workflows-expert-level-camera-orchestration">
<h3>Advanced Workflows: Expert-Level Camera Orchestration<a class="headerlink" href="#advanced-workflows-expert-level-camera-orchestration" title="Link to this heading">¶</a></h3>
<p>Once you’re shipping code to production, you hit new challenges: specialized hardware needs custom handling, performance matters, and reliability becomes non-negotiable. This section covers patterns that power camera systems at scale.</p>
</section>
<section id="vendor-property-access-controlling-camera-specific-features">
<h3>Vendor Property Access: Controlling Camera-Specific Features<a class="headerlink" href="#vendor-property-access-controlling-camera-specific-features" title="Link to this heading">¶</a></h3>
<p>Standard camera properties (brightness, contrast) work everywhere. But specialized cameras like Logitech PTZ, HD Pro, or custom industrial cameras expose vendor-specific extensions that aren’t in the standard set. Access these directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">def</span><span class="w"> </span><span class="nf">enable_logitech_rightlight</span><span class="p">(</span><span class="n">camera</span><span class="p">):</span>
</span><span data-line="4"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Enable Logitech RightLight auto-exposure for low-light scenarios.&quot;&quot;&quot;</span>
</span><span data-line="5">    <span class="c1"># Logitech RightLight uses a vendor GUID and property IDs</span>
</span><span data-line="6">    <span class="c1"># These values are from Logitech&#39;s DirectShow documentation</span>
</span><span data-line="7">    <span class="n">LOGITECH_GUID</span> <span class="o">=</span> <span class="s2">&quot;{04efb3d8-7dcc-4cbc-acf1-69a5f1301da0}&quot;</span>
</span><span data-line="8">    <span class="n">RIGHTLIGHT_PROP</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Property ID for RightLight control</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="11">        <span class="c1"># Set RightLight mode (value &gt; 0 enables it)</span>
</span><span data-line="12">        <span class="n">vendor_prop</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">VendorProperty</span><span class="p">(</span>
</span><span data-line="13">            <span class="n">prop_set_guid</span><span class="o">=</span><span class="n">LOGITECH_GUID</span><span class="p">,</span>
</span><span data-line="14">            <span class="n">prop_id</span><span class="o">=</span><span class="n">RIGHTLIGHT_PROP</span><span class="p">,</span>
</span><span data-line="15">            <span class="n">data</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x01</span><span class="s1">&#39;</span>  <span class="c1"># Enable RightLight</span>
</span><span data-line="16">        <span class="p">)</span>
</span><span data-line="17">        <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">set_vendor_property</span><span class="p">(</span><span class="n">vendor_prop</span><span class="p">)</span>
</span><span data-line="18">        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="19">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RightLight enabled&quot;</span><span class="p">)</span>
</span><span data-line="20">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="21">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RightLight failed: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="22">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="23">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vendor property not supported: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Access vendor properties only on cameras that support them—unsupported GUID/property combinations raise errors. Test with your exact camera model first.</p>
</section>
<section id="performance-optimization-batch-operations-and-caching">
<h3>Performance Optimization: Batch Operations and Caching<a class="headerlink" href="#performance-optimization-batch-operations-and-caching" title="Link to this heading">¶</a></h3>
<p>Calling <code class="docutils literal notranslate"><span class="pre">get_property()</span></code> for every property query hits the OS each time (slow). Cache results and batch operations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">class</span><span class="w"> </span><span class="nc">CameraSnapshot</span><span class="p">:</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fast read of multiple camera properties at once.&quot;&quot;&quot;</span>
</span><span data-line="6">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">camera</span><span class="p">):</span>
</span><span data-line="7">        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">camera</span>
</span><span data-line="8">        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="9">        <span class="bp">self</span><span class="o">.</span><span class="n">cache_time</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="10">        <span class="bp">self</span><span class="o">.</span><span class="n">TTL</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Cache for 5 seconds</span>
</span><span data-line="11">    
</span><span data-line="12">    <span class="k">def</span><span class="w"> </span><span class="nf">get_property_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span data-line="13"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get property with optional caching.&quot;&quot;&quot;</span>
</span><span data-line="14">        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span data-line="15">        
</span><span data-line="16">        <span class="k">if</span> <span class="n">use_cache</span> <span class="ow">and</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
</span><span data-line="17">            <span class="k">if</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_time</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">TTL</span><span class="p">:</span>
</span><span data-line="18">                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span>
</span><span data-line="19">        
</span><span data-line="20">        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
</span><span data-line="21">        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="22">            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="23">            <span class="bp">self</span><span class="o">.</span><span class="n">cache_time</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span data-line="24">        <span class="k">return</span> <span class="n">result</span>
</span><span data-line="25">    
</span><span data-line="26">    <span class="k">def</span><span class="w"> </span><span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="27"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Force refresh on next read.&quot;&quot;&quot;</span>
</span><span data-line="28">        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span data-line="29">        <span class="bp">self</span><span class="o">.</span><span class="n">cache_time</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span data-line="30">
</span><span data-line="31"><span class="c1"># Usage:</span>
</span><span data-line="32"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="33"><span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="34">    <span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span data-line="35">    <span class="n">snapshot</span> <span class="o">=</span> <span class="n">CameraSnapshot</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</span><span data-line="36">    
</span><span data-line="37">    <span class="c1"># First read—hits hardware</span>
</span><span data-line="38">    <span class="n">b1</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">get_property_cached</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="39">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">b1</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="40">    
</span><span data-line="41">    <span class="c1"># Second read—from cache (fast)</span>
</span><span data-line="42">    <span class="n">b2</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">get_property_cached</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="43">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness: </span><span class="si">{</span><span class="n">b2</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="44">    
</span><span data-line="45">    <span class="c1"># Force refresh</span>
</span><span data-line="46">    <span class="n">snapshot</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
</span><span data-line="47">    <span class="n">b3</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">get_property_cached</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span></pre></div>
</div>
<p>For loops reading many properties, caching cuts overhead by 5-10x. Refresh only when you need current state.</p>
</section>
<section id="event-driven-architecture-react-to-camera-changes">
<h3>Event-Driven Architecture: React to Camera Changes<a class="headerlink" href="#event-driven-architecture-react-to-camera-changes" title="Link to this heading">¶</a></h3>
<p>Instead of polling <code class="docutils literal notranslate"><span class="pre">get_property()</span></code> in a loop, set up callbacks that fire when settings change or errors occur:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">queue</span><span class="w"> </span><span class="kn">import</span> <span class="n">Queue</span>
</span><span data-line="4">
</span><span data-line="5"><span class="k">class</span><span class="w"> </span><span class="nc">CameraMonitor</span><span class="p">:</span>
</span><span data-line="6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor camera state changes with callbacks.&quot;&quot;&quot;</span>
</span><span data-line="7">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">camera</span><span class="p">):</span>
</span><span data-line="8">        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">camera</span>
</span><span data-line="9">        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">{}</span>
</span><span data-line="10">        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="11">        <span class="bp">self</span><span class="o">.</span><span class="n">event_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
</span><span data-line="12">    
</span><span data-line="13">    <span class="k">def</span><span class="w"> </span><span class="nf">register_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
</span><span data-line="14"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register callback for event type.&quot;&quot;&quot;</span>
</span><span data-line="15">        <span class="k">if</span> <span class="n">event_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span>
</span><span data-line="16">            <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="17">        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</span><span data-line="18">    
</span><span data-line="19">    <span class="k">def</span><span class="w"> </span><span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="20"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Start background monitoring thread.&quot;&quot;&quot;</span>
</span><span data-line="21">        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="22">        <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_monitor_loop</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="23">        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="24">    
</span><span data-line="25">    <span class="k">def</span><span class="w"> </span><span class="nf">_monitor_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="26"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Background thread that polls and fires events.&quot;&quot;&quot;</span>
</span><span data-line="27">        <span class="n">last_brightness</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="28">        
</span><span data-line="29">        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
</span><span data-line="30">            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="31">            
</span><span data-line="32">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span><span class="p">:</span>
</span><span data-line="33">                <span class="n">current</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="34">                <span class="k">if</span> <span class="n">current</span> <span class="o">!=</span> <span class="n">last_brightness</span><span class="p">:</span>
</span><span data-line="35">                    <span class="c1"># Brightness changed—fire callbacks</span>
</span><span data-line="36">                    <span class="n">last_brightness</span> <span class="o">=</span> <span class="n">current</span>
</span><span data-line="37">                    <span class="bp">self</span><span class="o">.</span><span class="n">_fire_event</span><span class="p">(</span><span class="s2">&quot;brightness_changed&quot;</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
</span><span data-line="38">            <span class="k">else</span><span class="p">:</span>
</span><span data-line="39">                <span class="c1"># Error occurred</span>
</span><span data-line="40">                <span class="bp">self</span><span class="o">.</span><span class="n">_fire_event</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</span><span data-line="41">            
</span><span data-line="42">            <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Poll every 500ms</span>
</span><span data-line="43">    
</span><span data-line="44">    <span class="k">def</span><span class="w"> </span><span class="nf">_fire_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span data-line="45"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fire all callbacks for an event.&quot;&quot;&quot;</span>
</span><span data-line="46">        <span class="k">if</span> <span class="n">event_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span>
</span><span data-line="47">            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
</span><span data-line="48">                <span class="k">try</span><span class="p">:</span>
</span><span data-line="49">                    <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span data-line="50">                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="51">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Callback error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="52">    
</span><span data-line="53">    <span class="k">def</span><span class="w"> </span><span class="nf">stop_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="54"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop background thread.&quot;&quot;&quot;</span>
</span><span data-line="55">        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span data-line="56">
</span><span data-line="57"><span class="c1"># Usage:</span>
</span><span data-line="58"><span class="n">devices</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">list_devices</span><span class="p">()</span>
</span><span data-line="59"><span class="k">if</span> <span class="n">devices</span><span class="p">:</span>
</span><span data-line="60">    <span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span data-line="61">    <span class="n">monitor</span> <span class="o">=</span> <span class="n">CameraMonitor</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</span><span data-line="62">    
</span><span data-line="63">    <span class="k">def</span><span class="w"> </span><span class="nf">on_brightness_changed</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span><span data-line="64">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brightness changed to </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="65">    
</span><span data-line="66">    <span class="k">def</span><span class="w"> </span><span class="nf">on_error</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
</span><span data-line="67">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Camera error: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="68">    
</span><span data-line="69">    <span class="n">monitor</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="s2">&quot;brightness_changed&quot;</span><span class="p">,</span> <span class="n">on_brightness_changed</span><span class="p">)</span>
</span><span data-line="70">    <span class="n">monitor</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">on_error</span><span class="p">)</span>
</span><span data-line="71">    
</span><span data-line="72">    <span class="n">monitor</span><span class="o">.</span><span class="n">start_monitoring</span><span class="p">()</span>
</span><span data-line="73">    <span class="c1"># ... your main code runs, callbacks fire in background ...</span>
</span><span data-line="74">    <span class="n">monitor</span><span class="o">.</span><span class="n">stop_monitoring</span><span class="p">()</span>
</span></pre></div>
</div>
<p>This reactive pattern scales well to complex apps where UI needs to update when camera state changes.</p>
</section>
<section id="production-deployment-docker-containerization">
<h3>Production Deployment: Docker Containerization<a class="headerlink" href="#production-deployment-docker-containerization" title="Link to this heading">¶</a></h3>
<p>Deploy camera apps reliably with Docker. Key gotcha: DirectShow only works on Windows, so containers must use Windows base images:</p>
<div class="highlight-dockerfile notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c"># Dockerfile (Windows-based)</span>
</span><span data-line="2"><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/windows/servercore:ltsc2022</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c"># Install Python</span>
</span><span data-line="5"><span class="k">RUN</span><span class="w"> </span>powershell<span class="w"> </span>-Command<span class="w"> </span><span class="se">\</span>
</span><span data-line="6"><span class="w">    </span><span class="nv">$ProgressPreference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SilentlyContinue&#39;</span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
</span><span data-line="7"><span class="w">    </span>Invoke-WebRequest<span class="w"> </span>-Uri<span class="w"> </span>https://www.python.org/ftp/python/3.11.8/python-3.11.8-amd64.exe<span class="w"> </span><span class="se">\</span>
</span><span data-line="8"><span class="w">    </span>-OutFile<span class="w"> </span>python-installer.exe<span class="p">;</span><span class="w"> </span><span class="se">\</span>
</span><span data-line="9"><span class="w">    </span>.<span class="se">\p</span>ython-installer.exe<span class="w"> </span>/quiet<span class="w"> </span><span class="nv">InstallAllUsers</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">PrependPath</span><span class="o">=</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
</span><span data-line="10"><span class="w">    </span>Remove-Item<span class="w"> </span>python-installer.exe
</span><span data-line="11">
</span><span data-line="12"><span class="c"># Copy app and install dependencies</span>
</span><span data-line="13"><span class="k">COPY</span><span class="w"> </span>app.py<span class="w"> </span>requirements.txt<span class="w"> </span>./
</span><span data-line="14"><span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span data-line="15">
</span><span data-line="16"><span class="c"># For USB device access from container, pass device through Docker</span>
</span><span data-line="17"><span class="c"># docker run --device &quot;\\.\COM1&quot; my_camera_app</span>
</span><span data-line="18">
</span><span data-line="19"><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.py&quot;</span><span class="p">]</span>
</span></pre></div>
</div>
<p>Then run with device passthrough:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>camera-app<span class="w"> </span>.
</span><span data-line="2">docker<span class="w"> </span>run<span class="w"> </span>--device<span class="w"> </span><span class="s2">&quot;\\.\GLOBAL??\&quot; camera-app</span>
</span></pre></div>
</div>
<p><strong>Key production requirements:</strong></p>
<ul class="simple">
<li><p>Retry logic for camera reconnections (shown in Intermediate Patterns)</p></li>
<li><p>Logging to centralized system (ELK, Splunk, etc.)</p></li>
<li><p>Health checks that verify camera is responding</p></li>
<li><p>Graceful shutdown that closes cameras before exit</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Production health check</span>
</span><span data-line="2"><span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">(</span><span class="n">camera</span><span class="p">):</span>
</span><span data-line="3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify camera is alive and responsive.&quot;&quot;&quot;</span>
</span><span data-line="4">    <span class="n">result</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">)</span>
</span><span data-line="5">    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span>
</span></pre></div>
</div>
<p>Run this periodically. If it fails consistently, restart the service or alert ops.</p>
</section>
</section>
<section id="custom-device-backends-abstraction-for-testing">
<h2>Custom Device Backends: Abstraction for Testing<a class="headerlink" href="#custom-device-backends-abstraction-for-testing" title="Link to this heading">¶</a></h2>
<p>For unit tests or multi-platform support, abstract the camera layer behind an interface:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">duvc_ctl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">duvc</span>
</span><span data-line="3">
</span><span data-line="4"><span class="k">class</span><span class="w"> </span><span class="nc">CameraBackend</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract camera interface.&quot;&quot;&quot;</span>
</span><span data-line="6">    <span class="nd">@abstractmethod</span>
</span><span data-line="7">    <span class="k">def</span><span class="w"> </span><span class="nf">get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span data-line="8">        <span class="k">pass</span>
</span><span data-line="9">    
</span><span data-line="10">    <span class="nd">@abstractmethod</span>
</span><span data-line="11">    <span class="k">def</span><span class="w"> </span><span class="nf">set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">):</span>
</span><span data-line="12">        <span class="k">pass</span>
</span><span data-line="13">
</span><span data-line="14"><span class="k">class</span><span class="w"> </span><span class="nc">RealCameraBackend</span><span class="p">(</span><span class="n">CameraBackend</span><span class="p">):</span>
</span><span data-line="15"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Real hardware camera via duvc-ctl.&quot;&quot;&quot;</span>
</span><span data-line="16">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
</span><span data-line="17">        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">Camera</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="18">    
</span><span data-line="19">    <span class="k">def</span><span class="w"> </span><span class="nf">get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span data-line="20">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
</span><span data-line="21">    
</span><span data-line="22">    <span class="k">def</span><span class="w"> </span><span class="nf">set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">):</span>
</span><span data-line="23">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">class</span><span class="w"> </span><span class="nc">MockCameraBackend</span><span class="p">(</span><span class="n">CameraBackend</span><span class="p">):</span>
</span><span data-line="26"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fake camera for testing without hardware.&quot;&quot;&quot;</span>
</span><span data-line="27">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="28">        <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="29">            <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
</span><span data-line="30">            <span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Contrast</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="31">        <span class="p">}</span>
</span><span data-line="32">    
</span><span data-line="33">    <span class="k">def</span><span class="w"> </span><span class="nf">get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
</span><span data-line="34">        <span class="c1"># Return mock result</span>
</span><span data-line="35">        <span class="k">class</span><span class="w"> </span><span class="nc">MockResult</span><span class="p">:</span>
</span><span data-line="36">            <span class="n">is_ok</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="37">            <span class="n">value</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">)</span>
</span><span data-line="38">        <span class="k">return</span> <span class="n">MockResult</span><span class="p">()</span>
</span><span data-line="39">    
</span><span data-line="40">    <span class="k">def</span><span class="w"> </span><span class="nf">set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">setting</span><span class="p">):</span>
</span><span data-line="41">        <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span><span class="o">.</span><span class="n">value</span>
</span><span data-line="42">        <span class="k">class</span><span class="w"> </span><span class="nc">MockResult</span><span class="p">:</span>
</span><span data-line="43">            <span class="n">is_ok</span> <span class="o">=</span> <span class="kc">True</span>
</span><span data-line="44">        <span class="k">return</span> <span class="n">MockResult</span><span class="p">()</span>
</span><span data-line="45">
</span><span data-line="46"><span class="c1"># Usage in production</span>
</span><span data-line="47"><span class="k">def</span><span class="w"> </span><span class="nf">get_camera_backend</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span data-line="48">    <span class="k">if</span> <span class="n">device</span><span class="p">:</span>  <span class="c1"># Real camera</span>
</span><span data-line="49">        <span class="k">return</span> <span class="n">RealCameraBackend</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="50">    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Testing</span>
</span><span data-line="51">        <span class="k">return</span> <span class="n">MockCameraBackend</span><span class="p">()</span>
</span><span data-line="52">
</span><span data-line="53"><span class="c1"># Your application code uses the abstraction</span>
</span><span data-line="54"><span class="k">def</span><span class="w"> </span><span class="nf">adjust_brightness</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span data-line="55">    <span class="n">setting</span> <span class="o">=</span> <span class="n">duvc</span><span class="o">.</span><span class="n">PropSetting</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">duvc</span><span class="o">.</span><span class="n">CamMode</span><span class="o">.</span><span class="n">Manual</span><span class="p">)</span>
</span><span data-line="56">    <span class="n">result</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="n">duvc</span><span class="o">.</span><span class="n">VidProp</span><span class="o">.</span><span class="n">Brightness</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
</span><span data-line="57">    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">is_ok</span>
</span><span data-line="58">
</span><span data-line="59"><span class="c1"># Test without hardware</span>
</span><span data-line="60"><span class="n">backend</span> <span class="o">=</span> <span class="n">get_camera_backend</span><span class="p">()</span>  <span class="c1"># Returns MockCameraBackend</span>
</span><span data-line="61"><span class="n">adjust_brightness</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
</span></pre></div>
</div>
<p>This pattern lets you test camera logic without actual cameras connected. Swap implementations as needed.</p>
<p>damn ts big af</p>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="16_architecture-decision-records.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">16. Architecture Decision Records</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="../../../examples/cpp-examples.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">C++ Examples</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2025, allanhanan</p>
  
  <p>
    Made with
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/allanhanan/duvc-ctl" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../../../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=5375a926"></script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../../../_static/shibuya.js?v=c1cf1a6b"></script></body>
</html>